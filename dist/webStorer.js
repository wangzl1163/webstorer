/*!
 * @license :webstorer - V0.1.0 - 08/04/2021
 * https://github.com/wangzl1163/webstorer
 * Copyright (c) 2021 @wangzl1163; Licensed MIT
 */!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="zUnb")}({S6P5:function(e,t,n){e.exports=n("uXZf")},jfMS:function(e,t){
/*!
 * @license :jsstore - V3.13.5 - 06/04/2021
 * https://github.com/ujjwalguptaofficial/JsStore
 * Copyright (c) 2021 @Ujjwal Gupta; Licensed MIT
 */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}({10:function(e,t,n){"use strict";var r,o,i,u,s,c,a,l,f,h;n.r(t),n.d(t,"QueryExecutor",(function(){return Ft})),n.d(t,"initialize",(function(){return Bt})),n.d(t,"Config",(function(){return V})),n.d(t,"KeyStore",(function(){return B})),function(e){e.WorkerNotSupplied="worker_not_supplied",e.IndexedDbUndefined="indexeddb_undefined",e.UndefinedColumn="undefined_column",e.UndefinedValue="undefined_value",e.UndefinedColumnName="undefined_column_name",e.UndefinedDbName="undefined_database_name",e.UndefinedColumnValue="undefined_column_value",e.NotArray="not_array",e.NoValueSupplied="no_value_supplied",e.ColumnNotExist="column_not_exist",e.EnableSearchOff="enable_search_off",e.InvalidOp="invalid_operator",e.NullValue="null_value",e.WrongDataType="wrong_data_type",e.TableNotExist="table_not_exist",e.DbNotExist="db_not_exist",e.ConnectionAborted="connection_aborted",e.ConnectionClosed="connection_closed",e.NotObject="not_object",e.InvalidConfig="invalid_config",e.DbBlocked="Db_blocked",e.IndexedDbNotSupported="indexeddb_not_supported",e.NullValueInWhere="null_value_in_where",e.InvalidJoinQuery="invalid_join_query",e.InvalidOrderQuery="invalid_order_query",e.InvalidQuery="invalid_query",e.InvalidGroupQuery="invalid_group_query",e.ImportScriptsFailed="import_scripts_failed",e.MethodNotExist="method_not_exist"}(r||(r={})),function(e){e.Registered="registerd",e.Failed="failed",e.NotStarted="not_started"}(o||(o={})),function(e){e.String="string",e.Object="object",e.Array="array",e.Number="number",e.Boolean="boolean",e.Null="null",e.DateTime="date_time"}(i||(i={})),function(e){e.InitDb="init_db",e.IsDbExist="is_db_exist",e.GetDbVersion="get_db_version",e.GetDbList="get_db_list",e.Get="get",e.Set="set",e.Select="select",e.Insert="insert",e.Update="update",e.Remove="remove",e.GetDbSchema="get_db_schema",e.OpenDb="open_db",e.Clear="clear",e.DropDb="drop_db",e.Count="count",e.ChangeLogStatus="change_log_status",e.Terminate="terminate",e.Transaction="transaction",e.InitKeyStore="init_keystore",e.CloseDb="close_db",e.Union="union",e.Intersect="intersect",e.ImportScripts="import_scripts"}(u||(u={})),function(e){e.RequestQueueEmpty="requestQueueEmpty",e.RequestQueueFilled="requestQueueFilled"}(s||(s={})),function(e){e.Where="where",e.Like="like",e.Regex="regex",e.In="in",e.Equal="=",e.Between="-",e.GreaterThan=">",e.LessThan="<",e.GreaterThanEqualTo=">=",e.LessThanEqualTo="<=",e.NotEqualTo="!=",e.Aggregate="aggregate",e.Max="max",e.Min="min",e.Avg="avg",e.Count="count",e.Sum="sum",e.Or="or",e.Skip="skip",e.Limit="limit",e.And="and",e.IgnoreCase="ignoreCase",e.Then="then"}(c||(c={})),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(a||(a={})),function(e){e.First="f",e.Last="l",e.Any="a"}(l||(l={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_started",e.UnableToStart="unable_to_start",e.ClosedByJsStore="closed_by_jsstore"}(f||(f={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_connected"}(h||(h={}));var p,y,d,b,_,v,m,g,S,O,w,x,k,E,D=function(){function e(){this.results=null,this.errorOccured=!1,this.errorCount=0}return e.prototype.onErrorOccured=function(e){++this.errorCount,1===this.errorCount&&null!=this.onError&&this.onError(e.target.error),console.error(e)},e}(),C=function(){function e(){}return e.callDbDroppedByBrowser=function(){e.isDbDeletedByBrowser=e.dbStatus.conStatus===h.Connected},e.createTransaction=function(t,n,r){null===e.transaction&&(r=r||"readwrite",e.transaction=e.dbConnection.transaction(t,r),e.transaction.oncomplete=function(){e.transaction=null,n()},e.transaction.ontimeout=function(){this._transaction=null,console.error("transaction timed out")})},e.transaction=null,e.dbStatus={conStatus:h.NotStarted},e}(),q=(p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),A=function(e){function t(t,n,r){var o=e.call(this)||this;return o.rowAffected=0,o.key=t,o.onSuccess=n,o.onError=r,o}return q(t,e),t.prototype.execute=function(){var e,t,n,r=this;this.initTransaction(),this.errorOccured||(e=F.columnName,t=this.key,(n=r.objectStore.index(e).openCursor(IDBKeyRange.only(t))).onerror=function(e){r.errorOccured=!0,r.onErrorOccured(e)},n.onsuccess=function(e){var t=e.target.result;t&&(t.delete(),++r.rowAffected,t.continue())})},t.prototype.initTransaction=function(){C.createTransaction([F.tableName],this.onTransactionCompleted.bind(this)),this.objectStore=C.transaction.objectStore(F.tableName)},t.prototype.onTransactionCompleted=function(){!1===this.errorOccured&&this.onSuccess(this.rowAffected)},t}(D),T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(e){function t(t,n,r){var o=e.call(this)||this;o.onTransactionCompleted_=function(){!1===o.errorOccured&&o.onSuccess&&o.onSuccess(null)};try{o.query=t,o.onSuccess=n,o.onError=r}catch(e){console.error(e)}return o}return T(t,e),t.prototype.execute=function(){var e,t=this;this.initTransaction(),(e=t.objectStore.index(F.columnName).openCursor(IDBKeyRange.only(t.query[F.columnName]))).onsuccess=function(e){var n=e.target.result;n?n.update(t.query):t.objectStore.add(t.query).onerror=function(e){t.errorOccured=!0,t.onErrorOccured(e)}},e.onerror=function(e){t.errorOccured=!0,t.onErrorOccured(e)}},t.prototype.initTransaction=function(){C.createTransaction([F.tableName],this.onTransactionCompleted_),this.objectStore=C.transaction.objectStore(F.tableName)},t}(D),I=function(){function e(){}return e.updateDbStatus=function(e,t){void 0===t?C.dbStatus.conStatus=e:C.dbStatus={conStatus:e,lastError:t}},e}(),N=function(e,t,n){var o=self.indexedDB.open(e,1);C.isDbDeletedByBrowser=!1,o.onerror=function(e){"InvalidStateError"===e.target.error.name?n({message:"Indexeddb is blocked",type:r.IndexedDbNotSupported}):n(e.target.error)},o.onsuccess=function(e){C.dbStatus.conStatus=h.Connected,C.dbConnection=o.result,C.dbConnection.onclose=function(){C.callDbDroppedByBrowser(),I.updateDbStatus(h.Closed,r.ConnectionClosed)},C.dbConnection.onversionchange=function(e){null===e.newVersion&&(e.target.close(),C.callDbDroppedByBrowser(),I.updateDbStatus(h.Closed,r.ConnectionClosed))},C.dbConnection.onerror=function(e){C.dbStatus.lastError="Error occured in connection :"+e.target.result},C.dbConnection.onabort=function(e){C.dbStatus={conStatus:h.Closed,lastError:"Connection aborted"}},null!=t&&t()},o.onupgradeneeded=function(e){e.target.result.createObjectStore(F.tableName,{keyPath:"Key"}).createIndex("Key","Key",{unique:!0})}},Q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),L=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onTransactionCompleted_=function(){!1===o.errorOccured&&o.onSuccess(o.results)},o.key=t,o.onSuccess=n,o.onError=r,o}return Q(t,e),t.prototype.execute=function(){var e,t,n,r=this;this.initTransaction_(),e=F.columnName,t=this.key,(n=r.objectStore.index(e).openCursor(IDBKeyRange.only(t))).onerror=function(e){r.errorOccured=!0,r.onErrorOccured(e)},n.onsuccess=function(e){var t=e.target.result;t&&(r.results=t.value.Value)}},t.prototype.initTransaction_=function(){C.createTransaction([F.tableName],this.onTransactionCompleted_,"readonly"),this.objectStore=C.transaction.objectStore(F.tableName)},t}(D),R=function(){function e(e){void 0===e&&(e=null),this.onQueryFinished=e}return e.prototype.checkConnectionAndExecuteLogic=function(e){var t=this;if("init_db"===e.name)this.executeLogic(e);else switch(C.dbStatus.conStatus){case h.Connected:this.executeLogic(e);break;case h.NotStarted:setTimeout((function(){t.checkConnectionAndExecuteLogic(e)}),100);break;case h.Closed:C.isDbDeletedByBrowser&&this.createDb((function(){C.isDbDeletedByBrowser=!1,t.checkConnectionAndExecuteLogic(e)}),(function(e){console.error(e)}))}},e.prototype.returnResult=function(e){this.onQueryFinished(e)},e.prototype.executeLogic=function(e){var t=this,n=function(e){t.returnResult({returnedValue:e})},r=function(e){t.returnResult({errorDetails:e,errorOccured:!0})};switch(e.name){case"get":this.get(e.query,n,r);break;case"set":this.set(e.query,n,r);break;case"remove":this.remove(e.query,n,r);break;case"init_db":this.createDb(n,r);break;case"close_db":this.closeDb(n,r)}},e.prototype.set=function(e,t,n){new j(e,t,n).execute()},e.prototype.remove=function(e,t,n){new A(e,t,n).execute()},e.prototype.get=function(e,t,n){new L(e,t,n).execute()},e.prototype.createDb=function(e,t){new N("KeyStore",e,t)},e.prototype.closeDb=function(e,t){C.dbStatus.conStatus===h.Connected&&(C.dbStatus.conStatus=h.Closed,C.dbConnection.close()),e()},e}(),P=function(e){return new Promise(e)},F=function(){function e(){}return e.prcoessQuery=function(e){var t=this;return P((function(n,r){e.onSuccess=function(e){n(e)},e.onError=function(e){r(e)},t.requestQueue.push(e),t.executeCode()}))},e.executeCode=function(){if(!this.isCodeExecuting&&this.requestQueue.length>0){this.isCodeExecuting=!0;var e={name:this.requestQueue[0].name,query:this.requestQueue[0].query};new R(this.onQueryFinished.bind(this)).checkConnectionAndExecuteLogic(e)}},e.onQueryFinished=function(e){var t=this.requestQueue.shift();this.isCodeExecuting=!1,e.errorOccured?t.onError(e.errorDetails):t.onSuccess(e.returnedValue),this.executeCode()},e.requestQueue=[],e.tableName="LocalStore",e.columnName="Key",e.isCodeExecuting=!1,e}(),B=function(){function e(){}return e.init=function(){if(indexedDB)return F.prcoessQuery({name:"init_db",query:null})},e.close=function(){return F.prcoessQuery({name:"close_db",query:null})},e.get=function(e){return F.prcoessQuery({name:"get",query:e})},e.set=function(e,t){var n={Key:e,Value:t};return F.prcoessQuery({name:"set",query:n})},e.remove=function(e){return F.prcoessQuery({name:"remove",query:e})},e}(),V=function(){function e(){}return e.isLogEnabled=!1,e.isRuningInWorker=!1,e}(),W=function(){function e(e,t){void 0===t&&(t=null),this.type=e,this.info_=t,this.message=this.getMsg_()}return e.prototype.throw=function(){throw this.get()},e.log=function(e){V.isLogEnabled&&console.log(e)},e.prototype.logError=function(){console.error(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.getMsg_=function(){var e;switch(this.type){case r.NotArray:e="Supplied value is not an array";break;case r.UndefinedColumn:e="Column is undefined in Where";break;case r.UndefinedValue:e="Value is undefined in Where";break;case r.UndefinedColumnName:e="Column name is undefined '"+this.info_.TableName+"'";break;case r.UndefinedDbName:e="Database name is not supplied";break;case r.UndefinedColumnValue:e="Column value is undefined";break;case r.NoValueSupplied:e="No value is supplied";break;case r.InvalidOp:e="Invalid Op Value '"+this.info_.Op+"'";break;case r.ColumnNotExist:e=this.info_.isOrder?"Column '"+this.info_.column+"' in order query does not exist":"Column '"+this.info_.column+"' does not exist";break;case r.EnableSearchOff:e="Search is turned off for the Column '"+this.info_.column+"'";break;case r.NullValue:e="Null value is not allowed for column '"+this.info_.ColumnName+"'";break;case r.WrongDataType:e="Supplied value for column '"+this.info_.column+"' have wrong data type";break;case r.TableNotExist:e="Table '"+this.info_.tableName+"' does not exist";break;case r.DbNotExist:e="Database with name "+this.info_.dbName+" does not exist";break;case r.NotObject:e="supplied value is not object";break;case r.InvalidOp:e="Invalid Config '"+this.info_.Config+" '";break;case r.DbBlocked:e="database is blocked, cant be deleted right now";break;case r.NullValueInWhere:e="Null/undefined is not allowed in where. Column '"+this.info_.column+"' has null";break;case r.InvalidJoinQuery:e=this.info_;break;default:e=this.message}return e},e}(),K=function(){function e(){}return Object.defineProperty(e.prototype,"dbName",{get:function(){return U.activeDb.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dbStatus",{get:function(){return U.dbStatus},set:function(e){U.dbStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dbConnection",{get:function(){return U.dbConnection},set:function(e){U.dbConnection=e},enumerable:!1,configurable:!0}),e.prototype.updateDbStatus=function(e,t){U.updateDbStatus(e,t)},e.prototype.onDbDroppedByBrowser=function(e){U.callDbDroppedByBrowser(e)},Object.defineProperty(e.prototype,"dbVersion",{get:function(){return parseInt(U.activeDbVersion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeDb",{get:function(){return U.activeDb},enumerable:!1,configurable:!0}),e.prototype.getDbList=function(){return U.getDbList()},e.prototype.setDbList=function(e){return U.setDbList(e)},e.prototype.onDbClose=function(e){this.onDbDroppedByBrowser(),this.updateDbStatus(f.Closed,r.ConnectionClosed)},e.prototype.onDbVersionChange=function(e){null===e.newVersion&&(e.target.close(),this.onDbDroppedByBrowser(!0),this.updateDbStatus(f.Closed,r.ConnectionClosed))},e.prototype.onDbConError=function(e){U.dbStatus.lastError="Error occured in connection :"+e.target.result},e}(),M=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(e){function t(t,n){var r=e.call(this)||this;return r.onSuccess_=t,r.onError_=n,r}return M(t,e),t.prototype.deleteMetaData=function(){var e=this;return P((function(t,n){B.remove("JsStore_"+e.dbName+"_Db_Version"),e.activeDb.tables.forEach((function(t){B.remove("JsStore_"+e.dbName+"_"+t.name+"_Version"),t.columns.forEach((function(n){n.autoIncrement&&B.remove("JsStore_"+e.dbName+"_"+t.name+"_"+n.name+"_Value")}))})),e.getDbList().then((function(r){r.splice(r.indexOf(e.dbName),1),e.setDbList(r).then((function(){B.remove("JsStore_"+e.dbName+"_Schema").then(t).catch(n)}))}))}))},t.prototype.deleteDb=function(){var e=this;setTimeout((function(){var t=indexedDB.deleteDatabase(e.dbName);t.onblocked=function(){null!=e.onError_&&e.onError_(new W(r.DbBlocked).get())},t.onerror=function(t){null!=e.onError_&&e.onError_(event.target.error)},t.onsuccess=function(){e.deleteMetaData().then((function(){e.onSuccess_(),e.dbStatus.conStatus=f.Closed})).catch(e.onError_)}}),100)},t}(K),U=function(){function e(){}return e.callDbDroppedByBrowser=function(t){e.dbStatus.conStatus===f.Connected&&(e.isDbDeletedByBrowser=!0,!0===t&&new G((function(){}),(function(){})).deleteMetaData())},e.createTransaction=function(t,n,r){if(null===e.transaction){r=r||a.ReadWrite,e.transaction=e.dbConnection.transaction(t,r);var o=function(){e.transaction=null,n()};e.transaction.oncomplete=o,e.transaction.onabort=o}},e.setDbList=function(e){return B.set("DataBase_List",e)},e.updateDbStatus=function(t,n){void 0===n?e.dbStatus.conStatus=t:e.dbStatus={conStatus:t,lastError:n}},e.getDbList=function(){return P((function(e,t){B.get("DataBase_List").then((function(t){e(null==t?[]:t)})).catch(t)}))},e.getDbVersion=function(e){return P((function(t,n){B.get("JsStore_"+e+"_Db_Version").then((function(e){t(Number(e))})).catch(n)}))},e.getDbSchema=function(e){return B.get("JsStore_"+e+"_Schema")},e.getTable=function(t){return e.activeDb.tables.find((function(e){return e.name===t}))},e.transaction=null,e.activeDbVersion=0,e.dbStatus={conStatus:f.NotStarted},e}(),J=function(e){if(null==e)return!0;switch(typeof e){case"string":return 0===e.length;case"number":return isNaN(e)}return!1},z=function(e){if(null==e)return i.Null;var t=typeof e;switch(t){case"object":if(Array.isArray(e))return i.Array;if(e instanceof Date)return i.DateTime}return t},Z=function(){function e(e){this.table=e}return e.prototype.check=function(e,t){var n=this,o=null;return typeof e===i.Object?this.table?this.table.columns.every((function(t){return null===o&&(t.name in e&&(o=n.checkByColumn_(t,e[t.name])),!0)})):o=new W(r.TableNotExist,{tableName:t}):o=new W(r.NotObject),null!=o?o.get():null},e.prototype.checkByColumn_=function(e,t){var n=null;!0===e.notNull&&J(t)&&(n=new W(r.NullValue,{ColumnName:e.name}));var o=z(t),i=null!=t;if(e.dataType&&i&&o!==e.dataType&&"object"!==o&&(n=new W(r.WrongDataType,{column:e.name})),i&&"object"===o){var u=["+","-","*","/","{push}"];for(var s in t){u.indexOf(s)<0&&e.dataType&&o!==e.dataType&&(n=new W(r.WrongDataType,{column:e.name}));break}}return n},e}(),$=function(){function e(e,t){this.errorOccured=!1,this.autoIncrementValue={},this.table=e,this.autoIncrementValue=t}return e.prototype.checkAndModifyValue=function(e){var t=this;return this.value=e,this.table.columns.every((function(e){return t.checkAndModifyColumnValue_(e),!t.errorOccured})),this.errorOccured},e.prototype.checkNotNullAndDataType_=function(e){e.notNull&&J(this.value[e.name])?this.onValidationError_(r.NullValue,{ColumnName:e.name}):e.dataType&&!J(this.value[e.name])&&z(this.value[e.name])!==e.dataType&&this.onValidationError_(r.WrongDataType,{column:e.name})},e.prototype.checkAndModifyColumnValue_=function(e){var t=this.value[e.name];e.autoIncrement?J(t)?this.value[e.name]=++this.autoIncrementValue[e.name]:z(t)===i.Number&&t>this.autoIncrementValue[e.name]&&(this.autoIncrementValue[e.name]=t):void 0!==e.default&&J(t)&&(this.value[e.name]=e.default),this.checkNotNullAndDataType_(e)},e.prototype.onValidationError_=function(e,t){this.errorOccured=!0,this.log=new W(e,t)},e}(),Y=function(e){return Promise.all(e)},H=function(e){var t=e.columns.filter((function(e){return e.autoIncrement}));return P((function(n,r){Y(t.map((function(t){var n="JsStore_"+U.activeDb.name+"_"+e.name+"_"+t.name+"_Value";return B.get(n)}))).then((function(e){for(var r={},o=0;o<t.length;o++)r[t[o].name]=e[o];n(r)})).catch(r)}))},X=function(){function e(e,t){this.table=e,this.values=t}return e.prototype.checkAndModifyValues=function(){var e=this;return P((function(t,n){var r=function(r){e.valueCheckerObj=new $(e.table,r),e.startChecking().then(t).catch(n)};!1===Ft.isTransactionQuery?H(e.table).then((function(e){r(e)})).catch(n):r(ee.autoIncrementValues[e.table.name])}))},e.prototype.startChecking=function(){var e=this;return P((function(t,n){var r=!1;e.values.every((function(t){return!(r=e.valueCheckerObj.checkAndModifyValue(t))})),r&&n(e.valueCheckerObj.log.get());var o,i,u,s=(o=e.table,i=e.valueCheckerObj.autoIncrementValue,u=Object.keys(i),Y(u.map((function(e){var t="JsStore_"+U.activeDb.name+"_"+o.name+"_"+e+"_Value",n=i[e];return!0===Ft.isTransactionQuery&&(ee.autoIncrementValues[o.name][e]=n),B.set(t,n)}))));!1===Ft.isTransactionQuery?s.then(t).catch(n):t()}))},e}(),ee=function(){function e(e,t){this.isTransaction=!1,this.api=e,this.query=t}return e.prototype.checkAndModify=function(){var e=this;return P((function(t,n){var r=function(){null==e.error?t():n(e.error)};switch(e.api){case u.Select:case u.Remove:case u.Count:e.checkFetchQuery_(),r();break;case u.Insert:e.checkInsertQuery_().then(r).catch((function(t){e.error=t,r()}));break;case u.Update:e.checkUpdateQuery_(),r()}}))},e.prototype.isInsertQryValid_=function(e){var t,n=this.getTable_(this.query.into);if(n)switch(z(this.query.values)){case i.Array:break;case i.Null:t=new W(r.NoValueSupplied);break;default:t=new W(r.NotArray)}else t=new W(r.TableNotExist,{tableName:this.query.into});return e(n),null==t?null:t.get()},e.prototype.checkInsertQuery_=function(){var e=this;return P((function(t,n){var r,o=e.isInsertQryValid_((function(e){r=e}));if(null==o)if(!0===e.query.skipDataCheck)t();else{var i=new X(r,e.query.values);i.checkAndModifyValues().then((function(){e.query.values=i.values,t()})).catch(n)}else n(o)}))},e.prototype.checkUpdateQuery_=function(){this.error=new Z(this.getTable_(this.query.in)).check(this.query.set,this.query.in),null==this.error&&null!=this.query.where&&(this.checkForNullInWhere_(),null==this.error&&this.addGreatAndLessToNotOp_())},e.prototype.checkForNullInWhere_=function(){for(var e in this.query.where)if(null==this.query.where[e])return void(this.error=new W(r.NullValueInWhere,{column:e}).get())},e.prototype.checkFetchQuery_=function(){!0===this.isTableExist_(this.query.from)?null!=this.query.where&&(this.checkForNullInWhere_(),null==this.error&&this.addGreatAndLessToNotOp_()):this.error=new W(r.TableNotExist,{tableName:this.query.from}).get()},e.prototype.isTableExist_=function(e){return this.activeDb_.tables.findIndex((function(t){return t.name===e}))>=0},Object.defineProperty(e.prototype,"activeDb_",{get:function(){return U.activeDb},enumerable:!1,configurable:!0}),e.prototype.getTable_=function(e){return U.getTable(e)},e.prototype.addGreatAndLessToNotOp_=function(){var e=this.query.where,t=function(e,t){return t.findIndex((function(t){return null!=e[t][c.NotEqualTo]}))>=0},n=function(e,t){var n;return t.forEach((function(t){null!=(n=e[t])[c.NotEqualTo]&&(e[t][c.GreaterThan]=n[c.NotEqualTo],void 0===e[c.Or]?(e[c.Or]={},e[c.Or][t]={}):void 0===e[c.Or][t]&&(e[c.Or][t]={}),e[c.Or][t][c.LessThan]=n[c.NotEqualTo],delete e[t][c.NotEqualTo])})),e};switch(z(e)){case i.Object:var r=Object.keys(e);if(t(e,r))if(1===r.length)this.query.where=n(e,r);else{var o=[];r.forEach((function(t){var r;o.push(n(((r={})[t]=e[t],r),[t]))})),this.query.where=o}break;default:var u=[];e.forEach((function(e){var r=Object.keys(e);t(e,r)&&(e=n(e,r)),u.push(e)})),this.query.where=u}},e.autoIncrementValues={},e}(),te=function(){function e(){}return Object.defineProperty(e.prototype,"activeDb",{get:function(){return U.activeDb},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dbConnection",{get:function(){return U.dbConnection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transaction",{get:function(){return U.transaction},enumerable:!1,configurable:!0}),e.prototype.createTransaction=function(e,t,n){U.createTransaction(e,t,n)},e.prototype.regexTest=function(e){return this.regexExpression.test(e)},e.prototype.isTableExist=function(e){return this.activeDb.tables.findIndex((function(t){return t.name===e}))>=0},e.prototype.getTable=function(e){return U.getTable(e)},e.prototype.getKeyRange=function(e,t){var n;switch(t){case c.Between:n=IDBKeyRange.bound(e.low,e.high,!1,!1);break;case c.GreaterThan:n=IDBKeyRange.lowerBound(e,!0);break;case c.GreaterThanEqualTo:n=IDBKeyRange.lowerBound(e);break;case c.LessThan:n=IDBKeyRange.upperBound(e,!0);break;case c.LessThanEqualTo:n=IDBKeyRange.upperBound(e);break;default:n=IDBKeyRange.only(e)}return n},e.prototype.getPrimaryKey=function(e){return this.getTable(e).primaryKey||this.getKeyPath(e)},e.prototype.getKeyPath=function(e){return this.dbConnection.transaction([e],"readonly").objectStore(e).keyPath},e}(),ne=function(e){return"object"===z(e)&&!(e instanceof RegExp)},re=function(e){if(ne(e)){var t={};for(var n in e)t[n]=null!=e[n]&&ne(e[n])?re(e[n]):e[n];return t}return e},oe=function(e,t){var n=z(e);if(n!==z(t))return!1;switch(n){case i.DateTime:return e.getTime()===t.getTime();default:return e===t}},ie=function(e){var t,n,r=e.split("%");switch(r[1]?(t=r[1],n=r.length>2?l.Any:l.Last):(t=r[0],n=l.First),n){case l.First:return new RegExp("^"+t,"i");case l.Last:return new RegExp(t+"$","i");default:return new RegExp(""+t,"i")}},ue=function(){function e(e,t){this.where=re(e),this.checkFlag=t}return e.prototype.remove=function(e){var t=e.pop();delete e.reduce((function(e,t){return e&&e[t]}),this.where)[t]},e.prototype.check=function(e){var t=!0;if(!this.checkFlag)return t;for(var n in this.where){if(!t)return t;var r=this.where[n],o=e[n];if("object"===z(r))for(var i in r){if(!t)return t;switch(i){case c.In:t=this.checkIn(n,o);break;case c.Like:t=this.checkLike_(n,o);break;case c.Regex:t=this.checkRegex(n,o);break;case c.Between:case c.GreaterThan:case c.LessThan:case c.GreaterThanEqualTo:case c.LessThanEqualTo:case c.NotEqualTo:t=this.checkComparisionOp_(n,o,i);break;default:t=!1}}else t=oe(r,o)}return t},e.prototype.checkIn=function(e,t){return null!=this.where[e][c.In].find((function(e){return oe(e,t)}))},e.prototype.checkLike_=function(e,t){return ie(this.where[e][c.Like]).test(t)},e.prototype.checkRegex=function(e,t){return this.where[e][c.Regex].test(t)},e.prototype.checkComparisionOp_=function(e,t,n){var r=this.where[e][n];switch(n){case c.GreaterThan:return t>r;case c.LessThan:return t<r;case c.LessThanEqualTo:return t<=r;case c.GreaterThanEqualTo:return t>=r;case c.Between:return t>r.low&&t<r.high;case c.NotEqualTo:return t!==r}},e}(),se=function(e){for(var t in e)return t},ce=function(e){return Object.keys(e)},ae=function(e){return ce(e).length},le=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rowAffected=0,t}return le(t,e),t.prototype.onErrorOccured=function(e,t){if(void 0===t&&(t=!1),t)e.logError(),this.error=e.get();else{var n=void 0;e.name?(n=new W(e.name)).message=e.message:(n=new W(e.target.error.name)).message=e.target.error.message,this.error=n.get()}},t.prototype.onExceptionOccured=function(e){console.error(e),this.onError({message:e.message,type:r.InvalidQuery})},t.prototype.getColumnInfo=function(e,t){return this.getTable(t).columns.find((function(t){return t.name===e}))},t.prototype.goToWhereLogic=function(){var e=se(this.query.where);if(this.objectStore.indexNames.contains(e)){var t=this.query.where[e];if("object"===z(t)){var n=ae(t)>1||ae(this.query.where)>1;this.whereCheckerInstance=new ue(this.query.where,n);var o=se(t);switch(this.whereCheckerInstance.remove([e,o]),o){case c.Like:var i=ie(t[c.Like]);this.executeRegexLogic(e,i);break;case c.Regex:this.executeRegexLogic(e,t[c.Regex]);break;case c.In:this.executeInLogic(e,t[c.In]);break;case c.Between:case c.GreaterThan:case c.LessThan:case c.GreaterThanEqualTo:case c.LessThanEqualTo:this.executeWhereLogic(e,t,o,"next");break;case c.Aggregate:break;default:this.executeWhereLogic(e,t,null,"next")}}else n=ae(this.query.where)>1,this.whereCheckerInstance=new ue(this.query.where,n),this.whereCheckerInstance.remove([e]),this.executeWhereLogic(e,t,null,"next")}else{var u=this.getColumnInfo(e,this.tableName),s=new W(null==u?r.ColumnNotExist:r.EnableSearchOff,{column:e});this.onErrorOccured(s,!0)}},t}(te),he=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pe=function(e){function t(t,n,r){var o=e.call(this)||this;return o.query=t,o.onSuccess=n,o.onError=r,o}return he(t,e),t.prototype.execute=function(){var e=this;this.createTransaction([this.query],(function(){null==e.error?e.onSuccess():e.onError(e.error)}));var t=this.transaction.objectStore(this.query).clear();t.onsuccess=function(t){e.getTable(e.query).columns.forEach((function(t){t.autoIncrement&&B.set("JsStore_"+e.activeDb.name+"_"+e.query+"_"+t.name+"_Value",0)}))},t.onerror=this.onErrorOccured},t}(fe),ye=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(e){function t(t,n){var r=e.call(this)||this;return r.onSuccess=t,r.onError=n,r}return ye(t,e),t.prototype.execute=function(e){var t=this,n=[],r=indexedDB.open(this.dbName,this.dbVersion),o=!1;r.onerror=function(e){null!=t.onError&&t.onError(e.target.error)},r.onsuccess=function(e){t.dbStatus.conStatus=f.Connected,t.dbConnection=r.result,t.dbConnection.onclose=t.onDbClose.bind(t),t.dbConnection.onversionchange=t.onDbVersionChange.bind(t),t.dbConnection.onerror=t.onDbConError.bind(t),o?t.savedbNameIntoDbList_().then((function(){null!=t.onSuccess&&t.onSuccess(o)})):(t.setPrimaryKey_(),t.onSuccess(o))},r.onupgradeneeded=function(r){o=!0;var i=r.target.result,u=function(e,r){try{var o;e.primaryKey.length>0?(t.activeDb.tables[r].primaryKey=e.primaryKey,o=i.createObjectStore(e.name,{keyPath:e.primaryKey})):o=i.createObjectStore(e.name,{autoIncrement:!0}),e.columns.forEach((function(n){if(!0===n.enableSearch){var r=n.primaryKey?{unique:!0}:{unique:n.unique};r.multiEntry=n.multiEntry;var i=null==n.keyPath?n.name:n.keyPath;o.createIndex(n.name,i,r),n.autoIncrement&&B.set("JsStore_"+t.dbName+"_"+e.name+"_"+n.name+"_Value",0)}})),n.push(e.name),B.set("JsStore_"+t.dbName+"_"+e.name+"_Version",e.version)}catch(e){console.error(e)}};e.forEach((function(e,t){e.requireDelete?(i.objectStoreNames.contains(e.name)&&i.deleteObjectStore(e.name),u(e,t)):e.requireCreation&&u(e,t)}))}},t.prototype.savedbNameIntoDbList_=function(){var e=this;return P((function(t,n){e.getDbList().then((function(r){r.indexOf(e.dbName)<0?(r.push(e.dbName),e.setDbList(r).then(t).catch(n)):t()})).catch(n)}))},t.prototype.setPrimaryKey_=function(){var e=this;this.activeDb.tables.forEach((function(t,n){t.columns.every((function(t){return e.activeDb.tables[n].primaryKey=t.primaryKey?t.name:"",!t.primaryKey}))}))},t}(K),be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.results=[],t}return be(t,e),t.prototype.onQueryFinished=function(){},t}(fe),ve=function(){function e(){}return e.prototype.setCaseAndValue=function(e,t){this.caseQuery_=e,this.setValue(t)},e.prototype.setCaseAndColumn=function(e,t){return this.caseQuery_=e,this.setColumn(t),this},e.prototype.setColumn=function(e){return this.columnName_=e,this.caseColumnQuery_=this.caseQuery_[this.columnName_],this.length_=this.caseColumnQuery_.length,this},e.prototype.setValue=function(e){return this.value=e,this},e.prototype.evaluate=function(){for(var e=0;e<this.length_;e++)if(!0===this.checkCase_(this.caseColumnQuery_[e]))return this.caseColumnQuery_[e].then;var t=this.caseColumnQuery_[this.length_-1].then;return null==t?this.value[this.columnName_]:t},e.prototype.checkCase_=function(e){var t;for(t in e){switch(t){case c.GreaterThan:if(this.value[this.columnName_]>e[t])return!0;break;case c.Equal:if(this.value[this.columnName_]===e[t])return!0;break;case c.LessThan:if(this.value[this.columnName_]<e[t])return!0;break;case c.GreaterThanEqualTo:if(this.value[this.columnName_]>=e[t])return!0;break;case c.LessThanEqualTo:if(this.value[this.columnName_]<=e[t])return!0;break;case c.NotEqualTo:if(this.value[this.columnName_]!==e[t])return!0;break;case c.Between:if(this.value[this.columnName_]>e[t].low&&this.value[this.columnName_]<e[t].high)return!0}return!1}},e}(),me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sorted=!1,t.isSubQuery=!1,t.shouldEvaluateLimitAtEnd=!1,t.shouldEvaluateSkipAtEnd=!1,t.thenEvaluator=new ve,t}return me(t,e),t.prototype.setPushResult=function(){var e=this;this.query.case?this.pushResult=function(t){var n;for(n in e.thenEvaluator.setCaseAndValue(e.query.case,t),e.query.case)t[n]=e.thenEvaluator.setColumn(n).evaluate();e.results.push(t)}:this.pushResult=function(t){e.results.push(t)}},t.prototype.removeDuplicates=function(){var e=this.results;this.results=null;for(var t=this.getPrimaryKey(this.query.from),n={},r=0,o=e.length;r<o;r++)n[e[r][t]]=e[r];for(var r in e=[],n)e.push(n[r]);this.results=e},t}(_e),Se=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Se(t,e),t.prototype.executeWhereUndefinedLogic=function(){if(this.query.order&&!1!==this.query.order.idbSorting&&this.query.order.by){if(!this.objectStore.indexNames.contains(this.query.order.by)){var e=new W(r.ColumnNotExist,{column:this.query.order.by,isOrder:!0});return void this.onErrorOccured(e,!0)}var t=this.query.order.type&&"desc"===this.query.order.type.toLowerCase()?"prev":"next";this.sorted=!0,y=this.objectStore.index(this.query.order.by).openCursor(null,t)}else y=this.objectStore.openCursor();y.onerror=this.onErrorOccured,!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForNoWhere_():this.skipRecord?this.executeSkipForNoWhere_():this.limitRecord?this.executeLimitForNotWhere_():this.executeSimpleForNotWhere_():this.executeSimpleForNotWhere_()},t.prototype.executeSkipAndLimitForNoWhere_=function(){var e,t=this,n=!1;y.onsuccess=function(r){(e=r.target.result)?n&&t.results.length!==t.limitRecord?(t.pushResult(e.value),e.continue()):(n=!0,e.advance(t.skipRecord)):t.onQueryFinished()}},t.prototype.executeSkipForNoWhere_=function(){var e,t=this,n=!1;y.onsuccess=function(r){(e=r.target.result)?n?(t.pushResult(e.value),e.continue()):(n=!0,e.advance(t.skipRecord)):t.onQueryFinished()}},t.prototype.executeSimpleForNotWhere_=function(){var e,t=this;y.onsuccess=function(n){(e=n.target.result)?(t.pushResult(e.value),e.continue()):t.onQueryFinished()}},t.prototype.executeLimitForNotWhere_=function(){var e,t=this;y.onsuccess=function(n){(e=n.target.result)&&t.results.length!==t.limitRecord?(t.pushResult(e.value),e.continue()):t.onQueryFinished()}},t}(ge),we=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.executeInLogic=function(e,t){var n=this;_=this.skipRecord,b=function(e){0===_?n.pushResult(e):--_},d=function(){return n.whereCheckerInstance.check(v.value)},!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForIn_(e,t):this.skipRecord?this.executeSkipForIn_(e,t):this.limitRecord?this.executeLimitForIn_(e,t):this.executeSimpleForIn_(e,t):this.executeSimpleForIn_(e,t)},t.prototype.executeSkipAndLimitForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){v=t.target.result,r.results.length!==r.limitRecord&&v?(d()&&b(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t.prototype.executeSkipForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){(v=t.target.result)?(d()&&b(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t.prototype.executeLimitForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){(v=t.target.result)&&r.results.length!==r.limitRecord?(d()&&r.pushResult(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t.prototype.executeSimpleForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){(v=t.target.result)?(d()&&r.pushResult(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t}(Oe),ke=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ke(t,e),t.prototype.executeRegexLogic=function(e,t){var n=this;S=this.skipRecord,this.regexExpression=t,g=function(e){0===S?n.pushResult(e):--S},m=function(){return n.regexTest(O.key)&&n.whereCheckerInstance.check(O.value)},(w=this.objectStore.index(e).openCursor()).onerror=this.onErrorOccured,!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForRegex_():this.skipRecord?this.executeSkipForRegex_():this.limitRecord?this.executeLimitForRegex_():this.executeSimpleForRegex_():this.executeSimpleForRegex_()},t.prototype.executeSkipAndLimitForRegex_=function(){var e=this;w.onsuccess=function(t){O=t.target.result,e.results.length!==e.limitRecord&&O?(m()&&g(O.value),O.continue()):e.onQueryFinished()}},t.prototype.executeSkipForRegex_=function(){var e=this;w.onsuccess=function(t){(O=t.target.result)?(m()&&g(O.value),O.continue()):e.onQueryFinished()}},t.prototype.executeLimitForRegex_=function(){var e=this;w.onsuccess=function(t){O=t.target.result,e.results.length!==e.limitRecord&&O?(m()&&e.pushResult(O.value),O.continue()):e.onQueryFinished()}},t.prototype.executeSimpleForRegex_=function(){var e=this;w.onsuccess=function(t){(O=t.target.result)?(m()&&e.pushResult(O.value),O.continue()):e.onQueryFinished()}},t}(xe),De=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return De(t,e),t.prototype.executeWhereLogic=function(e,t,n,r){var o=this;x=function(){return o.whereCheckerInstance.check(k.value)},t=n?t[n]:t,(E=this.objectStore.index(e).openCursor(this.getKeyRange(t,n),r)).onerror=this.onErrorOccured,!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForWhere_():this.skipRecord?this.executeSkipForWhere_():this.limitRecord?this.executeLimitForWhere_():this.executeSimpleForWhere_():this.executeSimpleForWhere_()},t.prototype.executeSkipAndLimitForWhere_=function(){var e=this,t=!1;E.onsuccess=function(n){(k=n.target.result)?t&&e.results.length!==e.limitRecord?(x()&&e.pushResult(k.value),k.continue()):(t=!0,k.advance(e.skipRecord)):e.onQueryFinished()}},t.prototype.executeSkipForWhere_=function(){var e=this,t=!1;E.onsuccess=function(n){(k=n.target.result)?t?(x()&&e.pushResult(k.value),k.continue()):(t=!0,k.advance(e.skipRecord)):e.onQueryFinished()}},t.prototype.executeLimitForWhere_=function(){var e=this;E.onsuccess=function(t){(k=t.target.result)&&e.results.length!==e.limitRecord?(x()&&e.pushResult(k.value),k.continue()):e.onQueryFinished()}},t.prototype.executeSimpleForWhere_=function(){var e=this;E.onsuccess=function(t){(k=t.target.result)?(x()&&e.pushResult(k.value),k.continue()):e.onQueryFinished()}},t}(Ee),qe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qe(t,e),t.prototype.processGroupBy=function(){var e=this.query.groupBy,t=this.results,n={};if(this.results=this.query.groupBy=null,z(e)!==i.Object)if(z(e)===i.String)for(var r in t)n[t[r][e]]=t[r];else{var o=void 0;for(var r in t){for(var u in o="",e)o+=t[r][e[u]];n[o]=t[r]}}else if(1===Object.keys(e).length){var s=se(e);for(var r in this.thenEvaluator.setCaseAndColumn(e,s),t)n[this.thenEvaluator.setValue(t[r]).evaluate()]=t[r]}else for(var r in o=void 0,t){for(var u in o="",this.thenEvaluator.setCaseAndValue(e,t[r]),e)o+=this.thenEvaluator.setColumn(u).evaluate();n[o]=t[r]}for(var r in t=[],n)t.push(n[r]);this.results=t},t.prototype.executeAggregateGroupBy=function(){var e=this.query.groupBy,t=this.results;this.results=void 0;var n,r,o,u,s={},a=this.query.aggregate,l=function(){var e=function(){return o=(o=s[r])?o["count("+u+")"]:0,o+=t[n][u]?1:0},l=function(){return o=(o=s[r])?o["max("+u+")"]:0,t[n][u]=t[n][u]?t[n][u]:0,o>t[n][u]?o:t[n][u]},f=function(){return o=(o=s[r])?o["min("+u+")"]:1/0,t[n][u]=t[n][u]?t[n][u]:1/0,o<t[n][u]?o:t[n][u]},h=function(){return o=(o=s[r])?o["sum("+u+")"]:0,o+=t[n][u]?t[n][u]:0},p=function(){var e=(o=s[r])?o["sum("+u+")"]:0;e+=t[n][u]?t[n][u]:0,t[n]["sum("+u+")"]=e,o=o?o["count("+u+")"]:0,o+=t[n][u]?1:0,t[n]["count("+u+")"]=o};for(var y in a){var d=a[y],b=z(d),_=void 0;switch(y){case c.Count:_=e;break;case c.Max:_=l;break;case c.Min:_=f;break;case c.Sum:_=h;break;case c.Avg:_=p}switch(b){case i.String:u=d,t[n][y+"("+u+")"]=_();break;case i.Array:for(var v in d)u=d[v],t[n][y+"("+u+")"]=_()}}};if(z(e)===i.String)for(n in t)r=t[n][e],l(),s[r]=t[n];else for(n in t){for(var f in r="",e)r+=t[n][e[f]];l(),s[r]=t[n]}for(var h in t=[],s)t.push(s[h]);if(a.avg)if(z(a.avg)===i.String)for(n in t){var p=t[n]["sum("+a.avg+")"],y=t[n]["count("+a.avg+")"];t[n]["avg("+a.avg+")"]=p/y,a.count!==a.avg&&delete t[n]["count("+a.avg+")"],a.sum!==a.avg&&delete t[n]["sum("+a.avg+")"]}else{var d=z(a.count)===i.String,b=z(a.sum)===i.String;for(n in t)for(var f in a.avg){var _=a.avg[f],v=t[n]["sum("+_+")"],m=t[n]["count("+_+")"];t[n]["avg("+_+")"]=v/m,d&&(a.count!==_||-1===a.count.indexOf(_))&&delete t[n]["count("+_+")"],b&&(a.sum!==_||-1===a.sum.indexOf(_))&&delete t[n]["sum("+_+")"]}}this.results=t},t}(Ce),Te=function(e){return e.replace(/\s/g,"")},je=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return je(t,e),t.prototype.processGroupDistinctAggr=function(){if(this.query.distinct){var e=[],t=this.results[0];for(var n in t)e.push(n);var r=this.getPrimaryKey(this.query.from),o=e.indexOf(r);e.splice(o,1),this.query.groupBy=e.length>0?e:null}this.query.groupBy?this.query.aggregate?this.executeAggregateGroupBy():this.processGroupBy():this.query.aggregate&&this.processAggregateQry()},t.prototype.getOrderColumnInfo_=function(e){var t;if(null==this.query.join)t=this.getColumnInfo(e,this.query.from);else{var n=Te(e).split(".");e=n[1],t=this.getColumnInfo(e,n[0])}if(null==t){var o=this.results[0][e];if(o)return{dataType:z(o),name:e};this.onErrorOccured(new W(r.ColumnNotExist,{column:e,isOrder:!0}),!0)}return t},t.prototype.compareStringInDesc_=function(e,t){return t.localeCompare(e)},t.prototype.compareStringinAsc_=function(e,t){return e.localeCompare(t)},t.prototype.compareDefaultInDesc_=function(e,t){return new String(t).localeCompare(e)},t.prototype.compareDefaultinAsc_=function(e,t){return new String(e).localeCompare(t)},t.prototype.compareNumberInDesc_=function(e,t){return t-e},t.prototype.compareNumberinAsc_=function(e,t){return e-t},t.prototype.compareDateInDesc_=function(e,t){return t.getTime()-e.getTime()},t.prototype.compareDateInAsc_=function(e,t){return e.getTime()-t.getTime()},t.prototype.getValInDesc_=function(e,t,n){for(var r in n){this.thenEvaluator.setCaseAndValue(n,e);var o=this.thenEvaluator.setColumn(r).evaluate();this.thenEvaluator.setCaseAndValue(n,t);var u=this.thenEvaluator.setColumn(r).evaluate();switch(typeof e[o]){case i.String:return this.compareStringInDesc_(e[o],t[u]);default:return this.compareNumberInDesc_(e[o],t[u])}}},t.prototype.getValInAsc_=function(e,t,n){for(var r in n){this.thenEvaluator.setCaseAndValue(n,e);var o=this.thenEvaluator.setColumn(r).evaluate();this.thenEvaluator.setCaseAndValue(n,t);var u=this.thenEvaluator.setColumn(r).evaluate();switch(typeof e[o]){case i.String:return this.compareStringinAsc_(e[o],t[u]);default:return this.compareNumberinAsc_(e[o],t[u])}}},t.prototype.getValueComparer_=function(e,t){switch(e.dataType){case i.String:return"asc"===t.type?this.compareStringinAsc_:this.compareStringInDesc_;case i.Number:return"asc"===t.type?this.compareNumberinAsc_:this.compareNumberInDesc_;case i.DateTime:return"asc"===t.type?this.compareDateInAsc_:this.compareDateInDesc_;default:return"asc"===t.type?this.compareDefaultinAsc_:this.compareDefaultInDesc_}},t.prototype.orderBy_=function(e){var t,n=this;e.type=this.getOrderType_(e.type);var r=e.by;if(null!=r&&typeof r===i.Object)"asc"===e.type?this.results.sort((function(e,t){return n.getValInAsc_(e,t,r)})):this.results.sort((function(e,t){return n.getValInDesc_(e,t,r)}));else{var o=this.getOrderColumnInfo_(r);if(null!=o){var u=this.getValueComparer_(o,e);r=o.name,null==e.case?this.results.sort((function(e,t){return u(e[r],t[r])})):(this.thenEvaluator.setCaseAndColumn(((t={})[r]=e.case,t),r),this.results.sort((function(e,t){return u(n.thenEvaluator.setValue(e).evaluate(),n.thenEvaluator.setValue(t).evaluate())})))}}},t.prototype.getOrderType_=function(e){return null==e?"asc":e.toLowerCase()},t.prototype.processOrderBy=function(){var e=this.query.order;if(e&&this.results.length>0&&!this.sorted){var t=z(e);if(t===i.Object)this.orderBy_(e);else if(t===i.Array){this.orderBy_(e[0]);for(var n=function(t,n){if(null==r.error){var o=e[t-1].by,i=e[t],u=i.by,s=r.getOrderColumnInfo_(u);if(null!=s){u=s.name,i.type=r.getOrderType_(i.type);var c=r.getValueComparer_(s,i);r.results.sort((function(e,t){return e[o]===t[o]?c(e[u],t[u]):0}))}}},r=this,o=1,u=e.length;o<u;o++)n(o)}}},t.prototype.processAggregateQry=function(){var e,t=this.results,n=t.length,r={};this.results=void 0;var o=function(){var n=0;for(var r in t)n+=t[r][e]?1:0;return n},u=function(){var n=0;for(var r in t)n=n>t[r][e]?n:t[r][e];return n},s=function(){var n=1/0,r=1/0;for(var o in t)n=n<(r=t[o][e]?t[o][e]:1/0)?n:r;return n},c=function(){var n=0;for(var r in t)n+=t[r][e];return n},a=function(){var r=0;for(var o in t)r+=t[o][e];return r/n};for(var l in this.query.aggregate){var f=this.query.aggregate[l],h=z(f),p=void 0;switch(l){case"count":p=o;break;case"max":p=u;break;case"min":p=s;break;case"sum":p=c;break;case"avg":p=a}switch(h){case i.String:r[l+"("+(e=f)+")"]=p();break;case i.Array:for(var y in f)r[l+"("+(e=f[y])+")"]=p()}}for(var l in r)t[0][l]=r[l];this.results=[t[0]]},t}(Ae),Ne=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qe=function(){return(Qe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.joinQueryStack_=[],t.currentQueryStackIndex_=0,t.tablesFetched=[],t}return Ne(t,e),t.prototype.executeJoinQuery=function(){var e=this,t=this.query;z(t.join)===i.Object?this.joinQueryStack_=[t.join]:this.joinQueryStack_=t.join;var n=t.from;new Ve({from:n,where:t.where,case:t.case,flatten:t.flatten},(function(t){e.results=t.map((function(t){var n;return(n={})[e.currentQueryStackIndex_]=t,n})),e.tablesFetched.push(n),e.startExecutingJoinLogic_()}),this.onError).execute()},t.prototype.onJoinQueryFinished_=function(){var e=this;if(null==this.error){if(this.results.length>0){this.query[c.Skip]&&!this.query[c.Limit]&&this.results.splice(0,this.query[c.Skip]);try{var t=[],n=Object.keys(this.results[0]).length,o=function(e,t){if(null!=e.as)for(var n in e.as)void 0===t[e.as[n]]&&(t[e.as[n]]=t[n],delete t[n]);return t};this.results.forEach((function(r){for(var i=r[0],u=1;u<n;u++){var s=e.joinQueryStack_[u-1];i=Qe(Qe({},i),o(s,r[u]))}t.push(i)})),this.results=t,t=null,this.processOrderBy(),this.processGroupDistinctAggr()}catch(e){return void this.onError({message:e.message,type:r.InvalidJoinQuery})}this.query[c.Skip]&&this.query[c.Limit]?(this.results.splice(0,this.query[c.Skip]),this.results=this.results.slice(0,this.query[c.Limit])):this.query[c.Limit]&&(this.results=this.results.slice(0,this.query[c.Limit]))}this.onSuccess(this.results)}else this.onError(this.error)},t.prototype.startExecutingJoinLogic_=function(){var e=this,t=this.joinQueryStack_[this.currentQueryStackIndex_];if(t)try{var n=this.getJoinTableInfo_(t.on);t.with===n.table1.table&&(n={table1:n.table2,table2:n.table1}),new Ve({from:t.with,where:t.where,case:t.case,flatten:t.flatten},(function(r){e.jointables(t.type,n,r),e.tablesFetched.push(n.table2.table),++e.currentQueryStackIndex_,e.startExecutingJoinLogic_()}),this.onError).execute()}catch(e){this.onExceptionOccured(e)}else this.onJoinQueryFinished_()},t.prototype.jointables=function(e,t,n){var r,o,i,u,s=this,c=[],a=t.table1.column,l=t.table2.column,f=this.tablesFetched.indexOf(t.table1.table),h=this.currentQueryStackIndex_+1;switch(e){case"left":i=0,u={},s.getTable(t.table2.table).columns.forEach((function(e){u[e.name]=null})),s.results.forEach((function(e){r=[],o=1===h?function(t){e[f][a]===t[l]&&r.push(t)}:function(t){var n=e[f];null!=n&&n[a]===t[l]&&r.push(t)},n.forEach(o),0===r.length&&(r=[u]),r.forEach((function(t){c[i]=Qe({},e),c[i++][h]=t}))}));break;default:!function(){var e=0;s.results.forEach((function(t){n.forEach((function(n){t[f][a]===n[l]&&(c[e]=Qe({},t),c[e++][h]=n)}))}))}()}this.results=c},t.prototype.getJoinTableInfo_=function(e){var t=(e=Te(e)).split("="),n=t[0].split("."),r=t[1].split(".");return{table1:{table:n[0],column:n[1]},table2:{table:r[0],column:r[1]}}},t.prototype.checkJoinQuery_=function(e,t){var n,o=e.table1,i=e.table2,u=this.getTable(o.table),s=this.getTable(i.table);t.with!==i.table&&(n=new W(r.InvalidJoinQuery,"on value should contains value of with")),null==u.columns.find((function(e){return e.name===o.column}))?n=new W(r.InvalidJoinQuery,"column "+o.column+" does not exist in table "+o.table):null==s.columns.find((function(e){return e.name===i.column}))&&(n=new W(r.InvalidJoinQuery,"column "+i.column+" does not exist in table "+i.table)),null==t.as&&(t.as={}),u.columns.every((function(e){var u=s.columns.find((function(t){return t.name===e.name&&t.name!==o.column}));return null==u||null!=t.as[u.name]||(n=new W(r.InvalidJoinQuery,"column "+e.name+" exist in both table "+o.table+" & "+i.table),!1)})),null!=n&&this.onErrorOccured(n,!0)},t}(Ie),Re=function(e){return Array.isArray(e)},Pe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=function(){return(Fe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Be=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,s=i.length;u<s;u++,o++)r[o]=i[u];return r},Ve=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onTransactionCompleted_=function(){if(null==o.error){if(o.query.flatten){var e=[],t={};o.query.flatten.forEach((function(n){o.results.forEach((function(r,o){r[n].forEach((function(t){var o;e.push(Fe(Fe({},r),((o={})[n]=t,o)))})),t[o]=!0}))}));var n=0;ce(t).forEach((function(e){o.results.splice(Number(e)-n,1),++n})),o.results=o.results.concat(e)}o.processGroupDistinctAggr(),o.processOrderBy(),o.error?o.onError(o.error):(o.shouldEvaluateSkipAtEnd&&o.results.splice(0,o.query.skip),o.shouldEvaluateLimitAtEnd&&(o.results=o.results.slice(0,o.query.limit)),o.onSuccess(o.results))}else o.onError(o.error)},o.onError=r,o.onSuccess=n,o.query=t,o.tableName=t.from,o.setPushResult(),Re(o.query.where)?(o.isArrayQry=!0,o.setLimitAndSkipEvaluationAtEnd_()):(o.skipRecord=t.skip,o.limitRecord=t.limit),t.order?((Re(t.order)||t.order.case||"object"==typeof t.order.by)&&(o.query.order.idbSorting=!1),o.setLimitAndSkipEvaluationAtEnd_()):t.groupBy&&o.setLimitAndSkipEvaluationAtEnd_(),o}return Pe(t,e),t.prototype.setLimitAndSkipEvaluationAtEnd_=function(){this.query.limit&&(this.shouldEvaluateLimitAtEnd=!0),this.query.skip&&(this.shouldEvaluateSkipAtEnd=!0)},t.prototype.execute=function(){var e=new ee(u.Select,this.query);if(e.checkAndModify(),null==e.error)try{null==this.query.join?null!=this.query.where?(this.initTransaction_(),Re(this.query.where)?this.processWhereArrayQry():this.processWhere_()):(this.initTransaction_(),this.executeWhereUndefinedLogic()):this.executeJoinQuery()}catch(e){this.onExceptionOccured(e)}else this.onError(e.error)},t.prototype.processWhereArrayQry=function(){var e=this;this.isArrayQry=!0;var t,n=this.query.where,r=this.getPrimaryKey(this.query.from),o=!0,i=[],u=function(){var u;t===c.And?!0===o?i=e.results:i.length>0&&(u=[],e.results.forEach((function(e){var t;t=e[r],i.findIndex((function(e){return e[r]===t}))>=0&&u.push(e)})),i=u,u=null):i.length>0?(e.results=Be(i,e.results),e.removeDuplicates(),i=e.results):i=e.results,o=!1,n.length>0?(e.results=[],s()):(e.results=i,!0===e.isSubQuery&&e.onTransactionCompleted_())},s=function(){e.query.where=n.shift(),e.query.where[c.Or]&&1===Object.keys(e.query.where).length?(t=c.Or,e.query.where=e.query.where[c.Or],e.onWhereArrayQrySuccess=u):(t=c.And,e.onWhereArrayQrySuccess=u),e.processWhere_()};s()},t.prototype.onQueryFinished=function(){!0===this.isOr?this.orQuerySuccess_():!0===this.isArrayQry?this.onWhereArrayQrySuccess():!0!==this.isTransaction&&!0!==this.isSubQuery||this.onTransactionCompleted_()},t.prototype.initTransaction_=function(){this.createTransaction([this.tableName],this.onTransactionCompleted_,a.ReadOnly),this.objectStore=this.transaction.objectStore(this.tableName)},t.prototype.processWhere_=function(){this.query.where.or&&this.processOrLogic_(),this.goToWhereLogic()},t.prototype.orQueryFinish_=function(){this.isOr=!1,this.results=this.orInfo.results,this.orInfo=null,this.removeDuplicates(),this.onQueryFinished()},t.prototype.orQuerySuccess_=function(){if(this.orInfo.results=Be(this.orInfo.results,this.results),!this.query.limit||this.query.limit>this.orInfo.results.length){this.results=[];var e=se(this.orInfo.orQuery);if(null!=e){var t={};t[e]=this.orInfo.orQuery[e],delete this.orInfo.orQuery[e],this.query.where=t,this.goToWhereLogic()}else this.orQueryFinish_()}else this.orQueryFinish_()},t.prototype.processOrLogic_=function(){this.isOr=!0,this.orInfo={orQuery:this.query.where.or,results:[]},delete this.query.where.or},t}(Le),We=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resultCount=0,t.onTransactionCompleted_=function(){null==t.error?t.onSuccess(t.resultCount):t.onError(t.error)},t}return We(t,e),t.prototype.onQueryFinished=function(){!0===this.isTransaction&&this.onTransactionCompleted_()},t}(_e),Me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Me(t,e),t.prototype.executeWhereUndefinedLogic=function(){var e,t,n=this;this.objectStore.count?(e=this.objectStore.count()).onsuccess=function(){n.resultCount=e.result,n.onQueryFinished()}:(e=this.objectStore.openCursor()).onsuccess=function(e){(t=e.target.result)?(++n.resultCount,t.continue()):n.onQueryFinished()},e.onerror=this.onErrorOccured.bind(this)},t}(Ke),Ue=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.executeInLogic=function(e,t){var n,r,o=this,i=this.objectStore.index(e),u=function(e){return P((function(t,u){(r=i.openCursor(o.getKeyRange(e))).onsuccess=function(e){(n=e.target.result)?(o.whereCheckerInstance.check(n.value)&&++o.resultCount,n.continue()):t()},r.onerror=u}))};this.objectStore.count&&(u=function(e){return P((function(t,n){(r=i.count(o.getKeyRange(e))).onsuccess=function(e){o.resultCount+=e.target.result,t()},r.onerror=n}))}),Y(t.map((function(e){return u(e)}))).then((function(){o.onQueryFinished()})).catch((function(e){o.onErrorOccured(e)}))},t}(Ge),ze=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ze(t,e),t.prototype.executeRegexLogic=function(e,t){var n,r=this;this.regexExpression=t;var o=this.objectStore.index(e).openCursor();o.onsuccess=function(e){(n=e.target.result)?(r.regexTest(n.key)&&r.whereCheckerInstance.check(n.value)&&++r.resultCount,n.continue()):r.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(Je),$e=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),t.prototype.executeWhereLogic=function(e,t,n){var r,o,i=this;t=n?t[n]:t,(1===Object.keys(this.query.where).length&&this.objectStore.count?function(){(r=i.objectStore.index(e).count(i.getKeyRange(t,n))).onsuccess=function(){i.resultCount=r.result,i.onQueryFinished()}}:function(){(r=i.objectStore.index(e).openCursor(i.getKeyRange(t,n))).onsuccess=function(e){(o=e.target.result)?(i.whereCheckerInstance.check(o.value)&&++i.resultCount,o.continue()):i.onQueryFinished()}})(),r.onerror=this.onErrorOccured.bind(this)},t}(Ze),He=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xe=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onError=r,o.onSuccess=n,o.query=t,o.tableName=t.from,o}return He(t,e),t.prototype.execute=function(){var e=this,t=new ee(u.Count,this.query);if(t.checkAndModify(),null==t.error)try{var n=function(){new Ve(e.query,(function(t){e.resultCount=t.length,e.onTransactionCompleted_()}),e.onError).execute()};null==this.query.join?null!=this.query.where?this.query.where.or||Re(this.query.where)?n():(this.initTransaction_(),this.goToWhereLogic()):(this.initTransaction_(),this.executeWhereUndefinedLogic()):n()}catch(e){this.onExceptionOccured(e)}else this.onError(t.error)},t.prototype.initTransaction_=function(){this.createTransaction([this.query.from],this.onTransactionCompleted_,a.ReadOnly),this.objectStore=this.transaction.objectStore(this.query.from)},t}(Ye),et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tt=function(e){function t(t,n,r){var o=e.call(this)||this;return o.valuesAffected_=[],o.onTransactionCompleted_=function(){null==o.error?o.onSuccess(!0===o.query.return?o.valuesAffected_:o.rowAffected):o.onError(o.error)},o.onError=r,o.query=t,o.onSuccess=n,o.tableName=o.query.into,o}return et(t,e),t.prototype.execute=function(){var e=this,t=new ee(u.Insert,this.query);t.checkAndModify().then((function(){e.query=t.query,e.insertData_(e.query.values)})).catch(this.onError)},t.prototype.onQueryFinished_=function(){!0===this.isTransaction&&this.onTransactionCompleted_()},t.prototype.insertData_=function(e){var t,n,r,o=this;n=this.query.return?function(e){o.valuesAffected_.push(e)}:function(e){++o.rowAffected},this.createTransaction([this.tableName],this.onTransactionCompleted_),t=this.transaction.objectStore(this.tableName),r=this.query.upsert?function(e){return t.put(e)}:function(e){return t.add(e)},Y(e.map((function(e){return P((function(t,o){var i=r(e);i.onerror=o,i.onsuccess=function(){n(e),t()}}))}))).then((function(){o.onQueryFinished_()})).catch((function(e){o.transaction.abort(),o.onErrorOccured(e)}))},t}(fe),nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nt(t,e),t.prototype.onQueryFinished=function(){},t}(_e),ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ot(t,e),t.prototype.executeWhereUndefinedLogic=function(){var e,t=this,n=this.objectStore.openCursor();n.onsuccess=function(n){(e=n.target.result)?(e.delete(),++t.rowAffected,e.continue()):t.onQueryFinished()},n.onerror=this.onErrorOccured.bind(this)},t}(rt),ut=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ut(t,e),t.prototype.executeInLogic=function(e,t){var n,r,o=this;Y(t.map((function(t){return i=t,P((function(t,u){(r=o.objectStore.index(e).openCursor(o.getKeyRange(i))).onsuccess=function(e){(n=e.target.result)?(o.whereCheckerInstance.check(n.value)&&(n.delete(),++o.rowAffected),n.continue()):t()},r.onerror=u}));var i}))).then((function(){o.onQueryFinished()})).catch((function(e){o.onErrorOccured(e)}))},t}(it),ct=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ct(t,e),t.prototype.executeRegexLogic=function(e,t){var n,r=this;this.regexExpression=t;var o=this.objectStore.index(e).openCursor();o.onsuccess=function(e){(n=e.target.result)?(r.regexTest(n.key)&&r.whereCheckerInstance.check(n.value)&&(n.delete(),++r.rowAffected),n.continue()):r.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(st),lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lt(t,e),t.prototype.executeWhereLogic=function(e,t,n){var r,o,i=this;t=n?t[n]:t,(o=this.objectStore.index(e).openCursor(this.getKeyRange(t,n))).onsuccess=function(e){(r=e.target.result)?(i.whereCheckerInstance.check(r.value)&&(r.delete(),++i.rowAffected),r.continue()):i.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(at),ht=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pt=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onTransactionCompleted_=function(){null==o.error?o.onSuccess(o.rowAffected):o.onError(o.error)},o.query=t,o.onSuccess=n,o.onError=r,o.tableName=o.query.from,o}return ht(t,e),t.prototype.execute=function(){var e=new ee(u.Remove,this.query);if(e.checkAndModify(),null==e.error)try{this.initTransaction_(),null!=this.query.where?Re(this.query.where)?this.processWhereArrayQry():this.processWhere_():this.executeWhereUndefinedLogic()}catch(e){this.onExceptionOccured(e)}else this.onError(e.error)},t.prototype.processWhereArrayQry=function(){var e=this,t=new Ve(this.query,(function(t){var n,r,o=[],i=e.getPrimaryKey(e.query.from);t.forEach((function(e){o.push(e[i])})),t=null;var u=((n={})[i]=((r={})[c.In]=o,r),n);e.query[c.Where]=u,e.processWhere_()}),this.onError);t.isSubQuery=!0,t.execute()},t.prototype.processWhere_=function(){this.query.where.or&&this.processOrLogic(),this.goToWhereLogic()},t.prototype.initTransaction_=function(){this.createTransaction([this.query.from],this.onTransactionCompleted_),this.objectStore=this.transaction.objectStore(this.query.from)},t.prototype.onQueryFinished=function(){!0===this.isOr?this.orQuerySuccess_():!0===this.isTransaction&&this.onTransactionCompleted_()},t.prototype.orQuerySuccess_=function(){var e=se(this._orInfo.OrQuery);if(null!=e){var t={};t[e]=this._orInfo.OrQuery[e],delete this._orInfo.OrQuery[e],this.query.where=t,this.goToWhereLogic()}else this.isOr=!0},t.prototype.processOrLogic=function(){this.isOr=!0,this._orInfo={OrQuery:this.query.where.or},delete this.query.where.or},t}(ft),yt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dt=function(e,t){for(var n in e)if(z(e[n])!==i.Object)t[n]=e[n];else for(var r in e[n]){switch(r){case"+":t[n]+=e[n][r];break;case"-":t[n]-=e[n][r];break;case"*":t[n]*=e[n][r];break;case"/":t[n]/=e[n][r];break;case"{push}":t[n].push(e[n][r]);break;default:t[n]=e[n]}break}return t},bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTransactionCompleted_=function(){t.error?t.onError(t.error):t.onSuccess(t.rowAffected)},t}return yt(t,e),t.prototype.initTransaction=function(){this.createTransaction([this.query.in],this.onTransactionCompleted_),this.objectStore=this.transaction.objectStore(this.query.in)},t.prototype.onQueryFinished=function(){!0===this.isTransaction&&this.onTransactionCompleted_()},t}(fe),_t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _t(t,e),t.prototype.executeWhereUndefinedLogic=function(){var e,t=this,n=this.objectStore.openCursor();n.onsuccess=function(n){if(e=n.target.result)try{var r=e.update(dt(t.query.set,e.value));r.onsuccess=function(){++t.rowAffected,e.continue()},r.onerror=t.onErrorOccured.bind(t)}catch(e){t.onErrorOccured(e),t.transaction.abort()}else t.onQueryFinished()},n.onerror=this.onErrorOccured.bind(this)},t}(bt),mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mt(t,e),t.prototype.executeInLogic=function(e,t){var n,r,o=this,i=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,u){(r=i.openCursor(o.getKeyRange(t))).onsuccess=function(t){(n=t.target.result)?(o.whereCheckerInstance.check(n.value)&&(n.update(dt(o.query.set,n.value)),++o.rowAffected),n.continue()):e()},r.onerror=u}));var t}))).then((function(){o.onQueryFinished()})).catch((function(e){o.onErrorOccured(e)}))},t}(vt),St=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return St(t,e),t.prototype.executeRegexLogic=function(e,t){var n,r=this;this.regexExpression=t;var o=this.objectStore.index(e).openCursor();o.onsuccess=function(e){if(n=e.target.result)if(r.regexTest(n.key)&&r.whereCheckerInstance.check(n.value))try{var t=n.update(dt(r.query.set,n.value));t.onsuccess=function(){++r.rowAffected,n.continue()},t.onerror=r.onErrorOccured.bind(r)}catch(e){r.transaction.abort(),r.onErrorOccured(e)}else n.continue();else r.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(gt),wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wt(t,e),t.prototype.executeWhereLogic=function(e,t,n){var r,o,i=this;t=n?t[n]:t,(o=this.objectStore.index(e).openCursor(this.getKeyRange(t,n))).onsuccess=function(e){if(r=e.target.result)if(i.whereCheckerInstance.check(r.value))try{var t=r.update(dt(i.query.set,r.value));t.onsuccess=function(){++i.rowAffected,r.continue()},t.onerror=i.onErrorOccured.bind(i)}catch(e){i.transaction.abort(),i.onErrorOccured(e)}else r.continue();else i.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(Ot),kt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onSuccess=n,o.onError=r,o.query=t,o.tableName=o.query.in,o}return kt(t,e),t.prototype.execute=function(){var e=new ee(u.Update,this.query);if(e.checkAndModify(),null==e.error)try{this.initTransaction(),null!=this.query.where?this.query.where.or||Re(this.query.where)?this.executeComplexLogic_():this.goToWhereLogic():this.executeWhereUndefinedLogic()}catch(e){this.onExceptionOccured(e)}else this.onError(e.error)},t.prototype.executeComplexLogic_=function(){var e=this,t=new Ve({from:this.query.in,where:this.query.where,ignoreCase:this.query.ignoreCase},(function(t){var n,r,o=e.getPrimaryKey(e.query.in),i=[];t.forEach((function(e){i.push(e[o])})),t=null;var u=((n={})[o]=((r={})[c.In]=i,r),n);e.query.ignoreCase=null,e.query[c.Where]=u,e.initTransaction(),e.goToWhereLogic()}),this.onError);t.isSubQuery=!0,t.execute()},t}(xt),Dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ct=function(e){function t(t,n,r){var o=e.call(this)||this;return o.reqQueue=[],o.isQueryExecuting=!1,o.isTxStarted_=!1,o.query=t,o.onError=r,o.onSuccess=n,o.results={},o}return Dt(t,e),t.prototype.execute=function(){var e=this,t=this.getNotExistingTable_(this.query.tables);null==t?Y(this.query.tables.map((function(t){return H(e.getTable(t))}))).then((function(t){t.forEach((function(t,n){ee.autoIncrementValues[e.query.tables[n]]=t})),e.startExecution_()})).catch(this.onError):this.onError(new W(r.TableNotExist,{tableName:t}).get())},t.prototype.startExecution_=function(){var e=this,t=this.query.method,n=self[t];if(!n)return this.onError({type:r.MethodNotExist,message:"method "+t+" does not exist."});n.call(this,{data:this.query.data,insert:function(t){return e.pushReq_({name:u.Insert,query:t})},select:function(t){return e.pushReq_({name:u.Select,query:t})},update:function(t){return e.pushReq_({name:u.Update,query:t})},remove:function(t){return e.pushReq_({name:u.Remove,query:t})},count:function(t){return e.pushReq_({name:u.Count,query:t})},setResult:function(t,n){e.results[t]=n},getResult:function(t){return e.results[t]},abort:function(t){e.abortTx_(t)},start:function(){e.checkQueries_(e.reqQueue).then((function(t){e.startTx_()})).catch((function(t){e.onError(t)}))}})},t.prototype.startTx_=function(){try{this.isTxStarted_=!0,this.initTx_(this.query.tables),this.processExecutionOfQry_()}catch(e){this.onExceptionOccured(e)}},t.prototype.initTx_=function(e){this.createTransaction(e,this.onTxCompleted_.bind(this))},t.prototype.onTxCompleted_=function(){this.onSuccess(this.results)},t.prototype.onReqFinished_=function(e){var t=this.reqQueue.shift();t&&(this.error?(this.abortTx_("automatic abort of transaction due to error occured"),this.onErrorOccured(this.error)):(this.isQueryExecuting=!1,t.onSuccess&&t.onSuccess(e),this.processExecutionOfQry_()))},t.prototype.abortTx_=function(e){null!=this.transaction&&this.transaction.abort()},t.prototype.executeRequest_=function(e){var t;this.isQueryExecuting=!0;var n=this.onReqFinished_.bind(this),r=this.onError.bind(this),o=e.query;switch(e.name){case u.Select:t=new Ve(o,n,r);break;case u.Insert:t=new tt(o,n,r);break;case u.Update:t=new Et(o,n,r);break;case u.Remove:t=new pt(o,n,r);break;case u.Count:t=new Xe(o,n,r)}t.isTransaction=!0,t.execute()},t.prototype.pushReq_=function(e){var t=this,n=function(){t.reqQueue.push(e)},r=P((function(n,r){e.onSuccess=function(e){n(e)},e.onError=function(e){t.error=e,r(e)}}));return!0===this.isTxStarted_?this.checkQueries_([e]).then((function(){n(),t.processExecutionOfQry_()})).catch((function(e){t.error=e,t.abortTx_(JSON.stringify(e))})):n(),r},t.prototype.processExecutionOfQry_=function(){this.reqQueue.length>0&&!1===this.isQueryExecuting&&this.executeRequest_(this.reqQueue[0])},t.prototype.checkQueries_=function(e){return Y(e.map((function(e){return new ee(e.name,e.query).checkAndModify()})))},t.prototype.getNotExistingTable_=function(e){var t=this,n=null;return e.every((function(e){return!1!==t.isTableExist(e)||(n=e,!1)})),n},t}(fe),qt=function(){function e(e){this.columns=[],this.requireDelete=!1,this.requireCreation=!1,this.name=e.name,this.version=e.version,this.columns=e.columns,this.setPrimaryKey_()}return e.prototype.createMetaData=function(e){var t=this;return P((function(n){t.callback_=n,t.setRequireDelete_(e),t.setDbVersion_(e)}))},e.prototype.setPrimaryKey_=function(){var e=this;this.columns.every((function(t){return e.primaryKey=t.primaryKey?t.name:"",!t.primaryKey}))},e.prototype.setRequireDelete_=function(e){var t=this;B.get("JsStore_"+e+"_"+this.name+"_Version").then((function(e){null==e?t.requireCreation=!0:e<t.version&&(t.requireDelete=!0)}))},e.prototype.setDbVersion_=function(e){var t=this;U.activeDbVersion=U.activeDbVersion>this.version?U.activeDbVersion:this.version,B.set("JsStore_"+e+"_Db_Version",U.activeDbVersion),B.set("JsStore_"+e+"_"+this.name+"_Version",U.activeDbVersion).then((function(){t.version=U.activeDbVersion,t.callback_(t)}))},e}(),At=function(){function e(e){this.tables=[],this.dbName=e.name,this.tables=e.tables}return e.prototype.createMetaData=function(){var e=this;return Y(this.tables.map((function(t){return new qt(t).createMetaData(e.dbName)})))},e}(),Tt=function(e){this.name=e.name,this.autoIncrement=null!=e.autoIncrement&&e.autoIncrement,this.primaryKey=null!=e.primaryKey&&e.primaryKey,this.unique=null!=e.unique&&e.unique,this.notNull=null!=e.notNull&&e.notNull,this.dataType=null!=e.dataType?e.dataType:e.autoIncrement?"number":null,this.default=e.default,this.multiEntry=null!=e.multiEntry&&e.multiEntry,this.enableSearch=null==e.enableSearch||e.enableSearch,this.keyPath=e.keyPath},jt=function(e){for(var t in this.columns=[],this.name=e.name,this.version=null==e.version?1:e.version,e.columns){var n={name:t};for(var r in e.columns[t]){var o=e.columns[t][r];switch(r){case"primaryKey":case"autoIncrement":case"unique":case"dataType":case"enableSearch":case"keyPath":case"multiEntry":case"default":case"notNull":n[r]=o}}this.columns.push(new Tt(n))}},It=function(e){var t=this;this.tables=[],this.name=e.name,e.tables.forEach((function(e){t.tables.push(new jt(e))}))},Nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),t.prototype.execute=function(e,t,n){var r,o=0,i={},u=!0,s=e.length;if(e.every((function(t,n){return!(n+1<s&&t.from!==e[n+1].from&&(u=!1,1))})),u){var c=this.getPrimaryKey(e[0].from);r=function(e){return e[c]}}else r=function(e){var t="";for(var n in e)t+=e[n];return t};var a=function(){if(o<e.length)new Ve(e[o++],(function(e){e.forEach((function(e){i[r(e)]=e})),a()}),n).execute();else{var u=[];for(var s in i)u.push(i[s]);t(u)}};a()},t}(fe),Lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(){return(Rt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Lt(t,e),t.prototype.execute=function(e,t,n){var r=this;this.query=e;var o,i=0,u={},s={},c=!0,a=e.queries,l=a.length;if(a.every((function(e,t){return!(t+1<l&&e.from!==a[t+1].from&&(c=!1,1))})),c){var f=this.getPrimaryKey(a[0].from);o=function(e){return e[f]}}else o=function(e){var t="";for(var n in e)t+=e[n];return t};var h=function(){if(i<l)new Ve(a[i],(function(e){u={},e.forEach((function(e){var t=o(e);0===i?s[t]=e:null!=s[t]&&(u[t]=e)})),i>0&&(s=Rt({},u)),++i,h()}),n).execute();else{var c,f=[],p=void 0,y=e.skip,d=e.limit,b=!1,_=function(){f.push(u[c])},v=function(){f.length<d?_():b=!0},m=function(e){0===y?e():--y};if(p=e.skip&&e.limit?function(){m((function(){v()}))}:e.limit?v:e.skip?function(){m((function(){_()}))}:function(){_()},d){for(c in u)if(p(c),b)break}else for(c in u)p(c);r.results=f,r.query.join={},r.processOrderBy(),r.processGroupDistinctAggr(),t(r.results)}};h()},t}(Ie),Ft=function(){function e(e){this.onQueryFinished=e,ee.autoIncrementValues={}}return e.prototype.checkConnectionAndExecuteLogic=function(e){var t=this;switch(W.log("request executing:"+e.name),e.name){case u.InitDb:case u.IsDbExist:case u.GetDbVersion:case u.GetDbList:case u.GetDbSchema:case u.Get:case u.Set:case u.ChangeLogStatus:case u.Terminate:case u.OpenDb:case u.InitKeyStore:case u.CloseDb:var n=this.checkForIdbSupport_();null==n?this.executeLogic_(e):this.returnResult_({errorDetails:n,errorOccured:!0});break;default:switch(this.dbStatus_.conStatus){case f.Connected:this.executeLogic_(e);break;case f.Closed:!0===this.isDbDeletedByBrowser_?this.initDb_(null,(function(){t.isDbDeletedByBrowser_=!1,t.checkConnectionAndExecuteLogic(e)}),e.onError):this.initDb_(this.activeDb_,(function(){t.checkConnectionAndExecuteLogic(e)}),e.onError)}}},e.prototype.changeLogStatus_=function(e,t,n){V.isLogEnabled=e,t()},e.prototype.returnResult_=function(e){!0===V.isRuningInWorker?self.postMessage(e):this.onQueryFinished(e)},e.prototype.executeLogic_=function(t){var n=this,o=function(e){n.returnResult_({returnedValue:e})},i=function(e){n.returnResult_({errorDetails:e,errorOccured:!0})};switch(e.isTransactionQuery=t.name===u.Transaction,t.name){case u.InitDb:!0===this.isDbDeletedByBrowser_?this.initDb_(null,(function(){n.isDbDeletedByBrowser_=!1,o()}),i):this.initDb_(t.query,o,i);break;case u.OpenDb:this.openDb_(t.query,o,i);break;case u.Select:new Ve(t.query,o,i).execute();break;case u.Insert:new tt(t.query,o,i).execute();break;case u.Update:new Et(t.query,o,i).execute();break;case u.Remove:new pt(t.query,o,i).execute();break;case u.IsDbExist:this.isDbExist_(t.query,o,i);break;case u.GetDbVersion:this.getDbVersion_(t.query).then(o).catch(i);break;case u.GetDbList:this.getDbList_().then(o).catch(i);break;case u.GetDbSchema:this.getDbSchema_(t.query).then(o).catch(i);break;case u.Clear:new pe(t.query,o,i).execute();break;case u.DropDb:this.dropDb_(o,i);break;case u.Count:new Xe(t.query,o,i).execute();break;case u.Get:this.get_(t.query).then(o).catch(i);break;case u.Set:this.set_(t.query).then(o).catch(i);break;case u.ChangeLogStatus:this.changeLogStatus_(t.query,o,i);break;case u.Transaction:new Ct(t.query,o,i).execute();break;case u.CloseDb:case u.Terminate:this.terminate_(o,i);break;case u.Union:(new Qt).execute(t.query,o,i);break;case u.InitKeyStore:this.initKeyStore_(o);break;case u.Intersect:(new Pt).execute(t.query,o,i);break;case u.ImportScripts:try{importScripts.apply(void 0,t.query),o()}catch(e){i({type:r.ImportScriptsFailed,message:e.message})}}},e.prototype.openDb_=function(e,t,n){var o=this;null!=this.activeDb_&&this.activeDb_.name===e?this.processCreateDb(this.activeDb_).then(t).catch(n):this.getDbSchema_(e).then((function(i){null!=i?o.processCreateDb(i).then(t).catch(n):n(new W(r.DbNotExist,{dbName:e}).get())})).catch(n)},e.prototype.initKeyStore_=function(e){B.init().then(e()).catch((function(){U.dbStatus={conStatus:f.UnableToStart,lastError:r.IndexedDbNotSupported}}))},e.prototype.getDbSchema_=function(e){return U.getDbSchema(e)},e.prototype.terminate_=function(e,t){var n=this;B.close().then((function(){n.closeDb_(),e()}))},Object.defineProperty(e.prototype,"isDbDeletedByBrowser_",{get:function(){return U.isDbDeletedByBrowser},set:function(e){U.isDbDeletedByBrowser=e},enumerable:!1,configurable:!0}),e.prototype.getDbList_=function(){return U.getDbList()},Object.defineProperty(e.prototype,"activeDb_",{get:function(){return U.activeDb},set:function(e){U.activeDb=e},enumerable:!1,configurable:!0}),e.prototype.closeDb_=function(){U.dbStatus.conStatus===f.Connected&&(U.dbStatus.conStatus=f.ClosedByJsStore,U.dbConnection.close())},e.prototype.dropDb_=function(e,t){this.closeDb_(),new G(e,t).deleteDb()},e.prototype.processCreateDb=function(e){var t=this;return P((function(n,r){new At(e).createMetaData().then((function(o){t.activeDb_=e,new de((function(r){t.activeDb_=e,r&&B.set("JsStore_"+e.name+"_Schema",e),n(r)}),r).execute(o)}))}))},e.prototype.initDb_=function(e,t,n){var r=this;null==e?this.processCreateDb(this.activeDb_):(this.closeDb_(),this.getDbVersion_(e.name).then((function(o){r.activeDbVersion_=o||1,r.processCreateDb(new It(e)).then(t).catch(n)})).catch(n))},Object.defineProperty(e.prototype,"activeDbVersion_",{get:function(){return U.activeDbVersion},set:function(e){U.activeDbVersion=e},enumerable:!1,configurable:!0}),e.prototype.getDbVersion_=function(e){return U.getDbVersion(e)},Object.defineProperty(e.prototype,"dbStatus_",{get:function(){return U.dbStatus},enumerable:!1,configurable:!0}),e.prototype.checkForIdbSupport_=function(){if(this.dbStatus_.conStatus===f.UnableToStart){var e={type:this.dbStatus_.lastError};switch(e.type){case r.IndexedDbNotSupported:e.message="Browser does not support IndexedDB";break;default:e.message="unknown error occured"}return e}},e.prototype.isDbExist_=function(e,t,n){z(e)===i.String?this.getDbVersion_(e).then((function(e){t(Boolean(e))})):this.getDbVersion_(e.dbName).then((function(n){t(e.table.version<=n)}))},e.prototype.get_=function(e){return B.get(e)},e.prototype.set_=function(e){return B.set(e.key,e.value)},e.isTransactionQuery=!1,e}(),Bt=function(){void 0===self.alert&&"undefined"==typeof ServiceWorkerGlobalScope&&(V.isRuningInWorker=!0,self.onmessage=function(e){(new Ft).checkConnectionAndExecuteLogic(e.data)})},Vt=function(){U.dbStatus={conStatus:f.UnableToStart,lastError:r.IndexedDbNotSupported}};!function(){try{indexedDB||(indexedDB=self.mozIndexedDB||self.webkitIndexedDB||self.msIndexedDB),indexedDB?(IDBTransaction=IDBTransaction||self.webkitIDBTransaction||self.msIDBTransaction,self.IDBKeyRange=self.IDBKeyRange||self.webkitIDBKeyRange||self.msIDBKeyRange):Vt()}catch(e){Vt()}}(),Bt()}})},tPlz:function(e,t){
/*!
 * @license :sqlweb - V1.5.0 - 01/11/2020
 * https://github.com/ujjwalguptaofficial/sqlweb
 * Copyright (c) 2020 @Ujjwal Gupta; Licensed MIT
 */
e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(7);t.default={setup:function(e,t){e.$sql={run:function(t){var n=Object(r.parseSql)(t);return e[n.api](n.data)},Query:o.Query}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"parseSql",(function(){return o}));var r=n(2),o=function(e){return!0===r.Util.isString(e)?r.Util.parseSql(e):e.query_}},function(e,t,n){"use strict";n.r(t),n.d(t,"Util",(function(){return u}));var r=n(3),o=n(4),i=n(5),u=function(){function e(){}return e.isString=function(e){return"string"==typeof e},e.parseJson=function(e){return JSON.parse(e,(function(e,t){return"string"==typeof t&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/.test(t)?new Date(t):t}))},e.parseSql=function(e){try{return e=e.replace(new RegExp("\n","g"),"").trim(),r.parse(e)}catch(e){throw new o.LogHelper(i.ERROR_TYPE.SynTaxError,e.message).get()}},e}()},function(e,t,n){"use strict";function r(e,t,n,o){this.message=e,this.expected=t,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(r,Error),r.buildMessage=function(e,t){var n={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}return"Expected "+function(e){var t,r,o,i=new Array(e.length);for(t=0;t<e.length;t++)i[t]=(o=e[t],n[o.type](o));if(i.sort(),i.length>0){for(t=1,r=1;t<i.length;t++)i[t-1]!==i[t]&&(i[r]=i[t],r++);i.length=r}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:r,parse:function(e,t){t=void 0!==t?t:{};var n,o={},i={query:on},u=on,s=Yt(";",!1),c=Yt("(",!1),a=Yt(")",!1),l=Yt(",",!1),f=Yt("({",!1),h=Yt("})",!1),p=Yt(":",!1),y=Yt("=",!1),d=Yt("*",!1),b=Yt(".",!1),_=Yt("[",!1),v=Yt("]",!1),m=Yt("!=",!1),g=Yt(">=",!1),S=Yt("<=",!1),O=Yt(">",!1),w=Yt("<",!1),x=Yt("'%",!1),k=Yt("%'",!1),E=Yt("'",!1),D=Xt("on value"),C=/^[a-zA-Z_.]/,q=Ht([["a","z"],["A","Z"],"_","."],!1,!1),A=function(e){return e.join("")},T=Xt("table name"),j=Xt("database name"),I=Xt("column"),N=Xt("order type"),Q=Yt("asc",!1),L=Yt("desc",!1),R=Yt("&&",!1),P=Yt("||",!1),F=Xt("column value"),B=Xt("identifier"),V=/^[a-zA-Z0-9_]/,W=Ht([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),K=Xt("word"),M=(Ht([["a","z"],["A","Z"],["0","9"]],!1,!1),/^[^'%]/),G=Ht(["'","%"],!0,!1),U=Xt("number"),J=/^[0-9]/,z=Ht([["0","9"]],!1,!1),Z=Xt("Whitespace"),$=/^[ \t]/,Y=Ht([" ","\t"],!1,!1),H=Xt("One or more whitespaces"),X=/^[aA]/,ee=Ht(["a","A"],!1,!1),te=/^[bB]/,ne=Ht(["b","B"],!1,!1),re=/^[cC]/,oe=Ht(["c","C"],!1,!1),ie=/^[dD]/,ue=Ht(["d","D"],!1,!1),se=/^[eE]/,ce=Ht(["e","E"],!1,!1),ae=/^[fF]/,le=Ht(["f","F"],!1,!1),fe=/^[gG]/,he=Ht(["g","G"],!1,!1),pe=/^[hH]/,ye=Ht(["h","H"],!1,!1),de=/^[iI]/,be=Ht(["i","I"],!1,!1),_e=/^[jJ]/,ve=Ht(["j","J"],!1,!1),me=/^[kK]/,ge=Ht(["k","K"],!1,!1),Se=/^[lL]/,Oe=Ht(["l","L"],!1,!1),we=/^[mM]/,xe=Ht(["m","M"],!1,!1),ke=/^[nN]/,Ee=Ht(["n","N"],!1,!1),De=/^[oO]/,Ce=Ht(["o","O"],!1,!1),qe=/^[pP]/,Ae=Ht(["p","P"],!1,!1),Te=/^[qQ]/,je=Ht(["q","Q"],!1,!1),Ie=/^[rR]/,Ne=Ht(["r","R"],!1,!1),Qe=/^[sS]/,Le=Ht(["s","S"],!1,!1),Re=/^[tT]/,Pe=Ht(["t","T"],!1,!1),Fe=/^[uU]/,Be=Ht(["u","U"],!1,!1),Ve=/^[vV]/,We=Ht(["v","V"],!1,!1),Ke=/^[wW]/,Me=Ht(["w","W"],!1,!1),Ge=/^[xX]/,Ue=Ht(["x","X"],!1,!1),Je=/^[yY]/,ze=Ht(["y","Y"],!1,!1),Ze=(Ht(["z","Z"],!1,!1),Xt("min")),$e=Xt("max"),Ye=Xt("avg"),He=Xt("count"),Xe=Xt("sum"),et=(Xt("aggregate"),Xt("between")),tt=Xt("in"),nt=Xt("like"),rt=Xt("select"),ot=Xt("distinct"),it=Xt("order"),ut=Xt("by"),st=Xt("from"),ct=Xt("group"),at=Xt("limit"),lt=Xt("skip"),ft=Xt("where"),ht=Xt("insert"),pt=Xt("into"),yt=Xt("return"),dt=Xt("values"),bt=Xt("skipdatacheck"),_t=Xt("update"),vt=Xt("set"),mt=Xt("delete"),gt=Xt("version"),St=Xt("enablesearch"),Ot=Xt("multiEntry"),wt=Xt("primarykey"),xt=Xt("unique"),kt=Xt("string"),Et=Xt("object"),Dt=Xt("array"),Ct=Xt("boolean"),qt=Xt("date_time"),At=Yt("_",!1),Tt=Xt("autoincrement"),jt=Xt("notnull"),It=Xt("default"),Nt=Xt("define"),Qt=Xt("table"),Lt=Xt("db"),Rt=Xt("isDbExist"),Pt=Xt("openDb"),Ft=Xt("disablesearch"),Bt=Xt("join"),Vt=Xt("on"),Wt=Xt("inner"),Kt=Xt("left"),Mt=Xt("as"),Gt=Xt("upsert"),Ut=0,Jt=[{line:1,column:1}],zt=0,Zt=[],$t=0;if("startRule"in t){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');u=i[t.startRule]}function Yt(e,t){return{type:"literal",text:e,ignoreCase:t}}function Ht(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function Xt(e){return{type:"other",description:e}}function en(t){var n,r=Jt[t];if(r)return r;for(n=t-1;!Jt[n];)n--;for(r={line:(r=Jt[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Jt[t]=r,r}function tn(e,t){var n=en(e),r=en(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function nn(e){Ut<zt||(Ut>zt&&(zt=Ut,Zt=[]),Zt.push(e))}function rn(e,t,n){return new r(r.buildMessage(e,t),e,t,n)}function on(){var t;return(t=function(){var t,n,r,i,u,s,c,a,l,f,h,p,y,b,m;if(t=Ut,(n=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=yr())!==o&&(n=tr())!==o&&(r=cr())!==o&&(i=tr())!==o&&(u=Xn())!==o&&(s=dr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(rt));return e}())!==o){if(r=[],(i=$n())!==o)for(;i!==o;)r.push(i),i=$n();else r=o;if(r!==o){if(i=Ut,42===e.charCodeAt(Ut)?(u="*",Ut++):(u=o,0===$t&&nn(d)),u!==o){if(s=[],(c=$n())!==o)for(;c!==o;)s.push(c),c=$n();else s=o;s!==o?i=u=[u,s]:(Ut=i,i=o)}else Ut=i,i=o;if(i===o&&(i=null),i!==o)if((u=function(){var e,t,n,r;if(e=Ut,(t=function(){var e,t,n,r;if(e=Ut,(t=yn())!==o){for(n=[],r=dn();r!==o;)n.push(r),r=dn();n!==o?(e,i=t,(u=n).splice(0,0,i),e=t=u):(Ut=e,e=o)}else Ut=e,e=o;var i,u;return e}())!==o){if(n=[],(r=$n())!==o)for(;r!==o;)n.push(r),r=$n();else n=o;n!==o?(e,e=t=t):(Ut=e,e=o)}else Ut=e,e=o;return e}())===o&&(u=null),u!==o)if((s=function(){var t,n;t=Ut,(n=function(){var t,n,r,i,u,s;t=Ut,91===e.charCodeAt(Ut)?(n="[",Ut++):(n=o,0===$t&&nn(_));if(n!==o)if((r=_n())!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o){for(u=[],s=bn();s!==o;)u.push(s),s=bn();u!==o?(93===e.charCodeAt(Ut)?(s="]",Ut++):(s=o,0===$t&&nn(v)),s!==o?(t,c=r,(a=u).splice(0,0,c),t=n=a):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;var c,a;return t}())!==o&&$n()!==o?(t,n=n[0],t=n):(Ut=t,t=o);return t}())===o&&(s=null),s!==o)if((c=wr())!==o)if($n()!==o)if((a=Fn())!==o){for(l=[],f=$n();f!==o;)l.push(f),f=$n();if(l!==o){for(f=[],h=Ln();h!==o;)f.push(h),h=Ln();if(f!==o){for(h=[],p=$n();p!==o;)h.push(p),p=$n();if(h!==o)if((p=En())===o&&(p=null),p!==o){for(y=[],b=$n();b!==o;)y.push(b),b=$n();if(y!==o){for(b=[],(m=xn())===o&&(m=kn())===o&&(m=wn())===o&&(m=gn())===o&&(m=vn());m!==o;)b.push(m),(m=xn())===o&&(m=kn())===o&&(m=wn())===o&&(m=gn())===o&&(m=vn());b!==o?(t,n=function(e,t,n,r,o,i){const u={};let s;return i.forEach(e=>{var t=Object.keys(e)[0];switch(t){case"skip":u.skip=e[t];break;case"limit":u.limit=e[t];break;case"distinct":u.distinct=e[t];break;case"order":u.order=e[t];break;case"groupBy":u.groupBy=e[t]}}),null!=o&&(s=[],o.forEach(e=>{if(e.table){var t=r.find(t=>t.with===e.table);null!=t&&(Array.isArray(t.where)?t.where.push(e.query):t.where=[e.query])}else s.push(e)}),0===s.length&&(s=null)),null!=e&&e.forEach(e=>{const t=r.find(t=>t.with===e.table);if(null!=t){const n={[e.column]:e.alias};null==t.as?t.as=n:t.as={...n,...t.as}}}),{api:"select",data:{from:n,where:s,...u,aggregate:t,join:0===r.length?null:r}}}(u,s,a,f,p,b),t=n):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;return t}())===o&&(t=function(){var t,n,r,i,u,s,c,a,l,f,h;if(t=Ut,(n=Sr())!==o)if($n()!==o)if(r=Ut,42===e.charCodeAt(Ut)?(i="*",Ut++):(i=o,0===$t&&nn(d)),i!==o&&(u=$n())!==o?r=i=[i,u]:(Ut=r,r=o),r===o&&(r=null),r!==o)if((i=wr())!==o)if((u=$n())!==o)if((s=Fn())!==o){for(c=[],a=$n();a!==o;)c.push(a),a=$n();if(c!==o)if((a=En())===o&&(a=null),a!==o){for(l=[],f=$n();f!==o;)l.push(f),f=$n();if(l!==o){for(f=[],(h=wn())===o&&(h=vn());h!==o;)f.push(h),(h=wn())===o&&(h=vn());f!==o?(t,n=function(e,t,n){const r={};return n.forEach(e=>{var t=Object.keys(e)[0];switch(t){case"distinct":r.distinct=e[t];break;case"groupBy":r.groupBy=e[t]}}),{api:"count",data:{from:e,where:t,...r}}}(s,a,f),t=n):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;return t}())===o&&(t=function(){var t,n,r,i,u,s,c,a,l,p;if(t=Ut,(n=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=ir())!==o&&(n=lr())!==o&&(r=yr())!==o&&(i=tr())!==o&&(u=pr())!==o&&(s=dr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(ht));return e}())!==o)if($n()!==o)if(function(){var e,t,n,r,i;$t++,e=Ut,(t=ir())!==o&&(n=lr())!==o&&(r=dr())!==o&&(i=fr())!==o?e=t=[t,n,r,i]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(pt));return e}()!==o)if($n()!==o)if((r=Fn())!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=_r())!==o&&(n=Yn())!==o&&(r=cr())!==o&&(i=br())!==o&&(u=tr())!==o&&(s=yr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(dt));return e}())!==o){for(s=[],c=$n();c!==o;)s.push(c),c=$n();if(s!==o)if((c=function(){var t;(t=function(){var t,n,r;t=Ut,61===e.charCodeAt(Ut)?(n="=",Ut++):(n=o,0===$t&&nn(y));n!==o&&(r=Kn())!==o?(t,t=n=r):(Ut=t,t=o);return t}())===o&&(t=function(){var t,n,r,i,u,s,c,a;t=Ut,"({"===e.substr(Ut,2)?(n="({",Ut+=2):(n=o,0===$t&&nn(f));if(n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if((i=hn())!==o){for(u=[],s=$n();s!==o;)u.push(s),s=$n();if(u!==o){for(s=[],c=fn();c!==o;)s.push(c),c=fn();if(s!==o){for(c=[],a=$n();a!==o;)c.push(a),a=$n();c!==o?("})"===e.substr(Ut,2)?(a="})",Ut+=2):(a=o,0===$t&&nn(h)),a!==o?(t,p=s,y={[(l=i).key]:l.value},null!=p&&p.forEach(e=>{y[e.key]=e.value}),t=n=[y]):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;var l,p,y;return t}());return t}())!==o){for(a=[],l=$n();l!==o;)a.push(l),l=$n();if(a!==o){for(l=[],p=pn();p!==o;)l.push(p),p=pn();l!==o?(t,n=function(e,t,n){let r={};return n.forEach(e=>{var t=Object.keys(e)[0];switch(t){case"skipDataCheck":r.skipDataCheck=e[t];break;case"return":r.return=e[t];break;case"upsert":r.upsert=e[t]}}),{api:"insert",data:{into:e,values:t,...r}}}(r,c,l),t=n):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;return t}())===o&&(t=function(){var e,t,n,r,i,u,s,c,a,l;if(e=Ut,function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=br())!==o&&(n=hr())!==o&&(r=er())!==o&&(i=Yn())!==o&&(u=dr())!==o&&(s=tr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(_t));return e}()!==o)if($n()!==o)if((t=Fn())!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if((r=function(){var e,t,n,r;$t++,e=Ut,(t=yr())!==o&&(n=tr())!==o&&(r=dr())!==o?e=t=[t,n,r]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(vt));return e}())!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=function(){var e,t,n,r,i,u;if(e=Ut,(t=jn())!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o){for(r=[],i=Pn();i!==o;)r.push(i),i=Pn();if(r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();i!==o?(e,s=t,r.forEach(e=>{s={...s,...e}}),e=t=s):(Ut=e,e=o)}else Ut=e,e=o}else Ut=e,e=o}else Ut=e,e=o;var s;return e}())!==o){for(s=[],c=$n();c!==o;)s.push(c),c=$n();if(s!==o)if((c=En())===o&&(c=null),c!==o){for(a=[],l=$n();l!==o;)a.push(l),l=$n();a!==o?(e,e={api:"update",data:{in:t,set:u,where:c}}):(Ut=e,e=o)}else Ut=e,e=o;else Ut=e,e=o}else Ut=e,e=o;else Ut=e,e=o}else Ut=e,e=o;else Ut=e,e=o}else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;return e}())===o&&(t=function(){var e,t,n,r,i,u,s,c;if(e=Ut,function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=er())!==o&&(n=tr())!==o&&(r=cr())!==o&&(i=tr())!==o&&(u=dr())!==o&&(s=tr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(mt));return e}()!==o){for(t=[],n=$n();n!==o;)t.push(n),n=$n();if(t!==o)if((n=wr())!==o)if($n()!==o)if((r=Fn())!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=En())===o&&(u=null),u!==o){for(s=[],c=$n();c!==o;)s.push(c),c=$n();s!==o?(e,e={api:"remove",data:{from:r,where:u}}):(Ut=e,e=o)}else Ut=e,e=o;else Ut=e,e=o}else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o}else Ut=e,e=o;return e}())===o&&(t=function(){var t,n,r,i;if(t=Ut,(n=function(){var t,n,r,i,u,c;if(t=Ut,xr()!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if((r=function(){var e,t,n;$t++,e=Ut,(t=er())!==o&&(n=Hn())!==o?e=t=[t,n]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Lt));return e}())!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();i!==o&&(u=Bn())!==o?(59===e.charCodeAt(Ut)?(c=";",Ut++):(c=o,0===$t&&nn(s)),c===o&&(c=null),c!==o?(t,t={name:u}):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}())!==o){for(r=[],i=un();i!==o;)r.push(i),i=un();r!==o?(t,c=r,(u=n).tables=c,t=n={api:"initDb",data:u}):(Ut=t,t=o)}else Ut=t,t=o;var u,c;return t}())===o&&(t=function(){var e,t,n;if(e=Ut,function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=fr())!==o&&(n=hr())!==o&&(r=tr())!==o&&(i=lr())!==o&&(u=er())!==o&&(s=Hn())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Pt));return e}()!==o){for(t=[],n=$n();n!==o;)t.push(n),n=$n();t!==o&&(n=Bn())!==o?(e,e={api:"openDb",data:n}):(Ut=e,e=o)}else Ut=e,e=o;return e}())===o&&(t=function(){var e,t,n,r,i;if(e=Ut,function(){var e,t,n,r,i,u,s,c,a,l;$t++,e=Ut,(t=ir())!==o&&(n=yr())!==o&&(r=er())!==o&&(i=Hn())!==o&&(u=tr())!==o&&(s=mr())!==o&&(c=ir())!==o&&(a=yr())!==o&&(l=dr())!==o?e=t=[t,n,r,i,u,s,c,a,l]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Rt));return e}()!==o){for(t=[],n=$n();n!==o;)t.push(n),n=$n();if(t!==o)if((n=Bn())!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();r!==o?((i=function(){var e,t,n,r,i;if(e=Ut,kr()!==o){for(t=[],n=$n();n!==o;)t.push(n),n=$n();if(t!==o)if((n=Fn())!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();r!==o&&(i=ln())!==o?(e,e={name:n,version:i}):(Ut=e,e=o)}else Ut=e,e=o;else Ut=e,e=o}else Ut=e,e=o;return e}())===o&&(i=null),i!==o?(e,u=n,(c={api:"isDbExist"}).data=null==(s=i)?u:{dbName:u,table:s},e=c):(Ut=e,e=o)):(Ut=e,e=o)}else Ut=e,e=o;else Ut=e,e=o}else Ut=e,e=o;var u,s,c;return e}()),t}function un(){var t,n,r,i,u,l,f,h,p,y,d,b,_,v,m,g,S;if(t=Ut,xr()!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if((r=kr())!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=Fn())!==o){for(l=[],f=$n();f!==o;)l.push(f),f=$n();if(l!==o)if(40===e.charCodeAt(Ut)?(f="(",Ut++):(f=o,0===$t&&nn(c)),f!==o){for(h=[],p=$n();p!==o;)h.push(p),p=$n();if(h!==o)if((p=cn())!==o){for(y=[],d=sn();d!==o;)y.push(d),d=sn();if(y!==o){for(d=[],b=$n();b!==o;)d.push(b),b=$n();if(d!==o)if(41===e.charCodeAt(Ut)?(b=")",Ut++):(b=o,0===$t&&nn(a)),b!==o){for(_=[],v=$n();v!==o;)_.push(v),v=$n();if(_!==o)if((v=ln())===o&&(v=null),v!==o)if(59===e.charCodeAt(Ut)?(m=";",Ut++):(m=o,0===$t&&nn(s)),m===o&&(m=null),m!==o){for(g=[],S=$n();S!==o;)g.push(S),S=$n();g!==o?(t,t=function(e,t,n,r){n.push(t);var o={};n.forEach((function(e){o={...o,...e}}));var i=null==r?null:r.version;return{name:e,columns:o,version:i}}(u,p,y,v)):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}function sn(){var t,n,r,i,u;for(t=Ut,n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(44===e.charCodeAt(Ut)?(r=",",Ut++):(r=o,0===$t&&nn(l)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();i!==o&&(u=cn())!==o?(t,t=n=u):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o;return t}function cn(){var e,t,n,r,i;if(e=Ut,(t=Vn())!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o){for(r=[],i=an();i!==o;)r.push(i),i=an();r!==o?(e,e=t=function(e,t){var n={unique:!1,autoIncrement:!1,default:null,notNull:!1,dataType:null,primaryKey:!1,multiEntry:!1,enableSearch:!0};return t.forEach(e=>{var t=Object.keys(e)[0];n[t]=e[t]}),{[e]:n}}(t,r)):(Ut=e,e=o)}else Ut=e,e=o}else Ut=e,e=o;return e}function an(){var t,n,r,i;if(t=Ut,(n=function(){var t;(t=function(){var t,n;t=Ut,(n=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=yr())!==o&&(n=dr())!==o&&(r=pr())!==o&&(i=ir())!==o&&(u=lr())!==o&&(s=rr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(kt));return e}())===o&&(n=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=lr())!==o&&(n=br())!==o&&(r=ar())!==o&&(i=Hn())!==o&&(u=tr())!==o&&(s=pr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(U));return e}())===o&&(n=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=fr())!==o&&(n=Hn())!==o&&(r=ur())!==o&&(i=tr())!==o&&(u=Xn())!==o&&(s=dr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Et));return e}())===o&&(n=function(){var e,t,n,r,i,u;$t++,e=Ut,(t=Yn())!==o&&(n=pr())!==o&&(r=pr())!==o&&(i=Yn())!==o&&(u=gr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Dt));return e}())===o&&(n=function(){var e,t,n,r,i,u,s,c;$t++,e=Ut,(t=Hn())!==o&&(n=fr())!==o&&(r=fr())!==o&&(i=cr())!==o&&(u=tr())!==o&&(s=Yn())!==o&&(c=lr())!==o?e=t=[t,n,r,i,u,s,c]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Ct));return e}())===o&&(n=function(){var t,n,r,i,u,s,c,a,l,f;$t++,t=Ut,(n=er())!==o&&(r=Yn())!==o&&(i=dr())!==o&&(u=tr())!==o?(95===e.charCodeAt(Ut)?(s="_",Ut++):(s=o,0===$t&&nn(At)),s!==o&&(c=dr())!==o&&(a=ir())!==o&&(l=ar())!==o&&(f=tr())!==o?t=n=[n,r,i,u,s,c,a,l,f]:(Ut=t,t=o)):(Ut=t,t=o);$t--,t===o&&(n=o,0===$t&&nn(qt));return t}());n!==o&&(t,n={dataType:n.join("").toLowerCase()});return t=n}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s,c,a,l,f,h,p,y;$t++,e=Ut,(t=Yn())!==o&&(n=br())!==o&&(r=dr())!==o&&(i=fr())!==o&&(u=ir())!==o&&(s=lr())!==o&&(c=Xn())!==o&&(a=pr())!==o&&(l=tr())!==o&&(f=ar())!==o&&(h=tr())!==o&&(p=lr())!==o&&(y=dr())!==o?e=t=[t,n,r,i,u,s,c,a,l,f,h,p,y]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Tt));return e}())!==o&&(e,t={autoIncrement:!0});return e=t}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s,c;$t++,e=Ut,(t=lr())!==o&&(n=fr())!==o&&(r=dr())!==o&&(i=lr())!==o&&(u=br())!==o&&(s=cr())!==o&&(c=cr())!==o?e=t=[t,n,r,i,u,s,c]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(jt));return e}())!==o&&(e,t={notNull:!0});return e=t}())===o&&(t=function(){var e,t,n;if(e=Ut,function(){var e,t,n,r,i,u,s,c;$t++,e=Ut,(t=er())!==o&&(n=tr())!==o&&(r=nr())!==o&&(i=Yn())!==o&&(u=br())!==o&&(s=cr())!==o&&(c=dr())!==o?e=t=[t,n,r,i,u,s,c]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(It));return e}()!==o){for(t=[],n=$n();n!==o;)t.push(n),n=$n();t!==o&&(n=Kn())!==o?(e,e={default:n}):(Ut=e,e=o)}else Ut=e,e=o;return e}())===o&&(t=function(){var t,n;t=Ut,(n=function(){var t,n,r,i,u,s,c;$t++,t=Ut,(n=br())!==o&&(r=lr())!==o&&(i=ir())!==o&&(u=function(){var t;Te.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(je));return t}())!==o&&(s=br())!==o&&(c=tr())!==o?t=n=[n,r,i,u,s,c]:(Ut=t,t=o);$t--,t===o&&(n=o,0===$t&&nn(xt));return t}())!==o&&(t,n={unique:!0});return t=n}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s,c,a,l,f;$t++,e=Ut,(t=hr())!==o&&(n=pr())!==o&&(r=ir())!==o&&(i=ar())!==o&&(u=Yn())!==o&&(s=pr())!==o&&(c=gr())!==o&&(a=sr())!==o&&(l=tr())!==o&&(f=gr())!==o?e=t=[t,n,r,i,u,s,c,a,l,f]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(wt));return e}())!==o&&(e,t={primaryKey:!0});return e=t}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s,c,a,l,f;$t++,e=Ut,(t=ar())!==o&&(n=br())!==o&&(r=cr())!==o&&(i=dr())!==o&&(u=ir())!==o&&(s=tr())!==o&&(c=lr())!==o&&(a=dr())!==o&&(l=pr())!==o&&(f=gr())!==o?e=t=[t,n,r,i,u,s,c,a,l,f]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Ot));return e}())!==o&&(e,t={multiEntry:!0});return e=t}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s,c,a,l,f,h,p;$t++,e=Ut,(t=tr())!==o&&(n=lr())!==o&&(r=Yn())!==o&&(i=Hn())!==o&&(u=cr())!==o&&(s=tr())!==o&&(c=yr())!==o&&(a=tr())!==o&&(l=Yn())!==o&&(f=pr())!==o&&(h=Xn())!==o&&(p=or())!==o?e=t=[t,n,r,i,u,s,c,a,l,f,h,p]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(St));return e}())!==o&&(e,t={enableSearch:!0});return e=t}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s,c,a,l,f,h,p,y;$t++,e=Ut,(t=er())!==o&&(n=ir())!==o&&(r=yr())!==o&&(i=Yn())!==o&&(u=Hn())!==o&&(s=cr())!==o&&(c=tr())!==o&&(a=yr())!==o&&(l=tr())!==o&&(f=Yn())!==o&&(h=pr())!==o&&(p=Xn())!==o&&(y=or())!==o?e=t=[t,n,r,i,u,s,c,a,l,f,h,p,y]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Ft));return e}())!==o&&(e,t={enableSearch:!1});return e=t}());return t}())!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();r!==o?(t,t=n=n):(Ut=t,t=o)}else Ut=t,t=o;return t}function ln(){var e,t,n;if(e=Ut,function(){var e,t,n,r,i,u,s,c;$t++,e=Ut,(t=_r())!==o&&(n=tr())!==o&&(r=pr())!==o&&(i=yr())!==o&&(u=ir())!==o&&(s=fr())!==o&&(c=lr())!==o?e=t=[t,n,r,i,u,s,c]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(gt));return e}()!==o){for(t=[],n=$n();n!==o;)t.push(n),n=$n();t!==o&&(n=Jn())!==o?(e,e={version:n}):(Ut=e,e=o)}else Ut=e,e=o;return e}function fn(){var t,n,r,i;if(t=Ut,44===e.charCodeAt(Ut)?(n=",",Ut++):(n=o,0===$t&&nn(l)),n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();r!==o&&(i=hn())!==o?(t,t=n=i):(Ut=t,t=o)}else Ut=t,t=o;return t}function hn(){var t,n,r,i,u,s;if(t=Ut,(n=Vn())!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if(58===e.charCodeAt(Ut)?(i=":",Ut++):(i=o,0===$t&&nn(p)),i!==o){for(u=[],s=$n();s!==o;)u.push(s),s=$n();u!==o&&(s=Kn())!==o?(t,t=n={key:n,value:s}):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}function pn(){var e,t,n,r;if(e=Ut,(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s,c,a,l,f,h,p,y;$t++,e=Ut,(t=yr())!==o&&(n=sr())!==o&&(r=ir())!==o&&(i=hr())!==o&&(u=er())!==o&&(s=Yn())!==o&&(c=dr())!==o&&(a=Yn())!==o&&(l=Xn())!==o&&(f=or())!==o&&(h=tr())!==o&&(p=Xn())!==o&&(y=sr())!==o?e=t=[t,n,r,i,u,s,c,a,l,f,h,p,y]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(bt));return e}())!==o&&(e,t="skipDataCheck");return e=t}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=pr())!==o&&(n=tr())!==o&&(r=dr())!==o&&(i=br())!==o&&(u=pr())!==o&&(s=lr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(yt));return e}())!==o&&(e,t="return");return e=t}())===o&&(t=function(){var e,t;e=Ut,(t=function(){var e,t,n,r,i,u,s;$t++,e=Ut,(t=br())!==o&&(n=hr())!==o&&(r=yr())!==o&&(i=tr())!==o&&(u=pr())!==o&&(s=dr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Gt));return e}())!==o&&(e,t="upsert");return e=t}()),t!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();n!==o?(e,e=t={[t]:!0}):(Ut=e,e=o)}else Ut=e,e=o;return e}function yn(){var t,n,r,i,u,s,c,a;if(t=Ut,(n=Vn())!==o)if(46===e.charCodeAt(Ut)?(r=".",Ut++):(r=o,0===$t&&nn(b)),r!==o)if((i=Vn())!==o){if(u=[],(s=$n())!==o)for(;s!==o;)u.push(s),s=$n();else u=o;if(u!==o)if((s=function(){var e,t,n;$t++,e=Ut,(t=Yn())!==o&&(n=yr())!==o?e=t=[t,n]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Mt));return e}())!==o){if(c=[],(a=$n())!==o)for(;a!==o;)c.push(a),a=$n();else c=o;c!==o&&(a=Vn())!==o?(t,t=n={table:n,column:i,alias:a}):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o;return t}function dn(){var t,n,r,i,u;for(t=Ut,n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(44===e.charCodeAt(Ut)?(r=",",Ut++):(r=o,0===$t&&nn(l)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();i!==o&&(u=yn())!==o?(t,t=n=u):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o;return t}function bn(){var t,n,r,i,u,s;if(t=Ut,44===e.charCodeAt(Ut)?(n=",",Ut++):(n=o,0===$t&&nn(l)),n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if((i=_n())!==o){for(u=[],s=$n();s!==o;)u.push(s),s=$n();u!==o?(t,t=n=i):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}function _n(){var t;return(t=function(){var t,n,r,i,u,s,l,f,h;if(t=Ut,function(){var e,t,n,r;$t++,e=Ut,(t=ar())!==o&&(n=ir())!==o&&(r=lr())!==o?e=t=[t,n,r]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Ze));return e}()!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(40===e.charCodeAt(Ut)?(r="(",Ut++):(r=o,0===$t&&nn(c)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=Vn())!==o){for(s=[],l=$n();l!==o;)s.push(l),l=$n();if(s!==o){for(l=[],f=In();f!==o;)l.push(f),f=In();if(l!==o){for(f=[],h=$n();h!==o;)f.push(h),h=$n();f!==o?(41===e.charCodeAt(Ut)?(h=")",Ut++):(h=o,0===$t&&nn(a)),h!==o?(t,p=u,(y=l).splice(0,0,p),t={min:y}):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;var p,y;return t}())===o&&(t=function(){var t,n,r,i,u,s,l,f,h;if(t=Ut,function(){var e,t,n,r;$t++,e=Ut,(t=ar())!==o&&(n=Yn())!==o&&(r=mr())!==o?e=t=[t,n,r]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn($e));return e}()!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(40===e.charCodeAt(Ut)?(r="(",Ut++):(r=o,0===$t&&nn(c)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=Vn())!==o){for(s=[],l=$n();l!==o;)s.push(l),l=$n();if(s!==o){for(l=[],f=In();f!==o;)l.push(f),f=In();if(l!==o){for(f=[],h=$n();h!==o;)f.push(h),h=$n();f!==o?(41===e.charCodeAt(Ut)?(h=")",Ut++):(h=o,0===$t&&nn(a)),h!==o?(t,p=u,(y=l).splice(0,0,p),t={max:y}):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;var p,y;return t}())===o&&(t=function(){var t,n,r,i,u,s,l,f,h;if(t=Ut,function(){var e,t,n,r;$t++,e=Ut,(t=Yn())!==o&&(n=_r())!==o&&(r=rr())!==o?e=t=[t,n,r]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Ye));return e}()!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(40===e.charCodeAt(Ut)?(r="(",Ut++):(r=o,0===$t&&nn(c)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=Vn())!==o){for(s=[],l=$n();l!==o;)s.push(l),l=$n();if(s!==o){for(l=[],f=In();f!==o;)l.push(f),f=In();if(l!==o){for(f=[],h=$n();h!==o;)f.push(h),h=$n();f!==o?(41===e.charCodeAt(Ut)?(h=")",Ut++):(h=o,0===$t&&nn(a)),h!==o?(t,p=u,(y=l).splice(0,0,p),t={avg:y}):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;var p,y;return t}())===o&&(t=function(){var t,n,r,i,u,s,l,f,h;if(t=Ut,Sr()!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(40===e.charCodeAt(Ut)?(r="(",Ut++):(r=o,0===$t&&nn(c)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=Vn())!==o){for(s=[],l=$n();l!==o;)s.push(l),l=$n();if(s!==o){for(l=[],f=In();f!==o;)l.push(f),f=In();if(l!==o){for(f=[],h=$n();h!==o;)f.push(h),h=$n();f!==o?(41===e.charCodeAt(Ut)?(h=")",Ut++):(h=o,0===$t&&nn(a)),h!==o?(t,p=u,(y=l).splice(0,0,p),t={count:y}):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;var p,y;return t}())===o&&(t=function(){var t,n,r,i,u,s,l,f,h;if(t=Ut,function(){var e,t,n,r;$t++,e=Ut,(t=yr())!==o&&(n=br())!==o&&(r=ar())!==o?e=t=[t,n,r]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Xe));return e}()!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(40===e.charCodeAt(Ut)?(r="(",Ut++):(r=o,0===$t&&nn(c)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=Vn())!==o){for(s=[],l=$n();l!==o;)s.push(l),l=$n();if(s!==o){for(l=[],f=In();f!==o;)l.push(f),f=In();if(l!==o){for(f=[],h=$n();h!==o;)f.push(h),h=$n();f!==o?(41===e.charCodeAt(Ut)?(h=")",Ut++):(h=o,0===$t&&nn(a)),h!==o?(t,p=u,(y=l).splice(0,0,p),t={sum:y}):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;var p,y;return t}()),t}function vn(){var e,t,n,r,i,u;if(e=Ut,function(){var e,t,n,r,i,u;$t++,e=Ut,(t=rr())!==o&&(n=pr())!==o&&(r=fr())!==o&&(i=br())!==o&&(u=hr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(ct));return e}()!==o)if($n()!==o)if(Or()!==o)if($n()!==o)if((t=Vn())!==o){for(n=[],r=mn();r!==o;)n.push(r),r=mn();if(n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();r!==o?(e,u=n,e={groupBy:[t,...u]}):(Ut=e,e=o)}else Ut=e,e=o}else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;return e}function mn(){var t,n,r,i,u,s,c;for(t=Ut,n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(44===e.charCodeAt(Ut)?(r=",",Ut++):(r=o,0===$t&&nn(l)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=Vn())!==o){for(s=[],c=$n();c!==o;)s.push(c),c=$n();s!==o?(t,t=n=u):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;return t}function gn(){var e,t,n,r,i,u;if(e=Ut,function(){var e,t,n,r,i,u;$t++,e=Ut,(t=fr())!==o&&(n=pr())!==o&&(r=er())!==o&&(i=tr())!==o&&(u=pr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(it));return e}()!==o)if($n()!==o)if(Or()!==o)if($n()!==o)if((t=On())!==o){for(n=[],r=Sn();r!==o;)n.push(r),r=Sn();n!==o?(e,i=t,(u=n).unshift(i),e={order:u}):(Ut=e,e=o)}else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;else Ut=e,e=o;return e}function Sn(){var t,n,r,i,u;for(t=Ut,n=[],r=$n();r!==o;)n.push(r),r=$n();if(n!==o)if(44===e.charCodeAt(Ut)?(r=",",Ut++):(r=o,0===$t&&nn(l)),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();i!==o&&(u=On())!==o?(t,t=n=u):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o;return t}function On(){var t,n,r;return t=Ut,(n=Vn())!==o?((r=function(){var t,n,r,i;if(t=Ut,$n()!==o)if((n=function(){var t;$t++,"asc"===e.substr(Ut,3)?(t="asc",Ut+=3):(t=o,0===$t&&nn(Q));t===o&&("desc"===e.substr(Ut,4)?(t="desc",Ut+=4):(t=o,0===$t&&nn(L)));$t--,t===o&&(o,0===$t&&nn(N));return t}())!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();r!==o?(t,t=n):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o;return t}())===o&&(r=null),r!==o?(t,t=n={by:n,type:r}):(Ut=t,t=o)):(Ut=t,t=o),t}function wn(){var e,t;return e=Ut,function(){var e,t,n,r,i,u,s,c,a;$t++,e=Ut,(t=er())!==o&&(n=ir())!==o&&(r=yr())!==o&&(i=dr())!==o&&(u=ir())!==o&&(s=lr())!==o&&(c=Xn())!==o&&(a=dr())!==o?e=t=[t,n,r,i,u,s,c,a]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(ot));return e}()!==o?((t=$n())===o&&(t=null),t!==o?(e,e={distinct:!0}):(Ut=e,e=o)):(Ut=e,e=o),e}function xn(){var e,t,n;return e=Ut,function(){var e,t,n,r,i;$t++,e=Ut,(t=yr())!==o&&(n=sr())!==o&&(r=ir())!==o&&(i=hr())!==o?e=t=[t,n,r,i]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(lt));return e}()!==o&&$n()!==o&&(t=Jn())!==o?((n=$n())===o&&(n=null),n!==o?(e,e={skip:t}):(Ut=e,e=o)):(Ut=e,e=o),e}function kn(){var e,t,n;return e=Ut,function(){var e,t,n,r,i,u;$t++,e=Ut,(t=cr())!==o&&(n=ir())!==o&&(r=ar())!==o&&(i=ir())!==o&&(u=dr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(at));return e}()!==o&&$n()!==o&&(t=Jn())!==o?((n=$n())===o&&(n=null),n!==o?(e,e={limit:t}):(Ut=e,e=o)):(Ut=e,e=o),e}function En(){var e,t;return e=Ut,function(){var e,t,n,r,i,u;$t++,e=Ut,(t=vr())!==o&&(n=or())!==o&&(r=tr())!==o&&(i=pr())!==o&&(u=tr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(ft));return e}()!==o&&$n()!==o&&(t=function(){var e,t,n,r;e=Ut,(t=Cn())===o&&(t=qn());if(t!==o){for(n=[],r=Dn();r!==o;)n.push(r),r=Dn();n!==o?(e,t=function(e,t){if(Array.isArray(e)||(e=[e]),null!=t){var n=t=>{e.push(t)};Array.isArray(e)&&t.forEach(e=>{Array.isArray(e)?e.forEach(e=>{n(e)}):n(e)})}return e}(t,n),e=t):(Ut=e,e=o)}else Ut=e,e=o;return e}())!==o?(e,e=t):(Ut=e,e=o),e}function Dn(){var e,t,n,r;if(e=Ut,$n()!==o)if((t=Wn())!==o){for(n=[],r=$n();r!==o;)n.push(r),r=$n();n!==o?((r=Cn())===o&&(r=qn()),r!==o?(e,e=function(e,t){if("||"===e){var n={};return Array.isArray(t)?t.forEach(e=>{n={...n,...e}}):n=t,{or:n}}return t}(t,r)):(Ut=e,e=o)):(Ut=e,e=o)}else Ut=e,e=o;else Ut=e,e=o;return e}function Cn(){var e,t,n,r,i,u;if(e=Ut,(t=Tn())!==o){for(n=[],r=An();r!==o;)n.push(r),r=An();n!==o?(e,i=t,e=t=null==(u=n)?i:(u.splice(0,0,i),u)):(Ut=e,e=o)}else Ut=e,e=o;return e}function qn(){var t,n,r,i,u,s,l;if(t=Ut,40===e.charCodeAt(Ut)?(n="(",Ut++):(n=o,0===$t&&nn(c)),n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if((i=Tn())!==o){for(u=[],s=An();s!==o;)u.push(s),s=An();if(u!==o){for(s=[],l=$n();l!==o;)s.push(l),l=$n();s!==o?(41===e.charCodeAt(Ut)?(l=")",Ut++):(l=o,0===$t&&nn(a)),l!==o?(t,t=n=function(e,t){if(null==t)return e;var n=e;return t.forEach(e=>{var t=Object.keys(e)[0];if("or"===t){null==n.or&&(n.or={});var r=Object.keys(e[t])[0];n.or[r]=e[t][r]}else n[t]=e[t]}),n}(i,u)):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}function An(){var e,t,n,r;return e=Ut,$n()!==o&&(t=Wn())!==o&&$n()!==o&&(n=Tn())!==o?(e,r=n,e="&&"===t?r:r.table?(r.query={or:r.query},r):{or:r}):(Ut=e,e=o),e}function Tn(){var t;return(t=jn())===o&&(t=function(){var t,n,r,i,u,s,c;if(t=Ut,(n=Vn())!==o)if((r=Qn())===o&&(r=null),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=function(){var e,t,n,r,i;$t++,e=Ut,(t=cr())!==o&&(n=ir())!==o&&(r=sr())!==o&&(i=tr())!==o?e=t=[t,n,r,i]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(nt));return e}())!==o){for(s=[],c=$n();c!==o;)s.push(c),c=$n();s!==o&&(c=function(){var t;(t=function(){var t,n,r,i,u,s;t=Ut,"'%"===e.substr(Ut,2)?(n="'%",Ut+=2):(n=o,0===$t&&nn(x));if(n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if((i=Gn())!==o){for(u=[],s=$n();s!==o;)u.push(s),s=$n();u!==o?("%'"===e.substr(Ut,2)?(s="%'",Ut+=2):(s=o,0===$t&&nn(k)),s!==o?(t,t=n="%"+i+"%"):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}())===o&&(t=function(){var t,n,r,i,u;t=Ut,"'%"===e.substr(Ut,2)?(n="'%",Ut+=2):(n=o,0===$t&&nn(x));if(n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();r!==o&&(i=Gn())!==o?(39===e.charCodeAt(Ut)?(u="'",Ut++):(u=o,0===$t&&nn(E)),u!==o?(t,t=n="%"+i):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o;return t}())===o&&(t=function(){var t,n,r,i,u;t=Ut,39===e.charCodeAt(Ut)?(n="'",Ut++):(n=o,0===$t&&nn(E));if(n!==o)if((r=Gn())!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();i!==o?("%'"===e.substr(Ut,2)?(u="%'",Ut+=2):(u=o,0===$t&&nn(k)),u!==o?(t,t=n=r+"%"):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o;return t}());return t}())!==o?(t,a=n,f=c,t=n=null==(l=r)?{[a]:{like:f}}:{table:a,query:{[l]:{like:f}}}):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;var a,l,f;return t}())===o&&(t=function(){var t,n,r,i,u,s,l,f,h,p,y,d;if(t=Ut,(n=Vn())!==o)if((r=Qn())===o&&(r=null),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=function(){var e,t,n;$t++,e=Ut,(t=ir())!==o&&(n=lr())!==o?e=t=[t,n]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(tt));return e}())!==o){for(s=[],l=$n();l!==o;)s.push(l),l=$n();if(s!==o)if(40===e.charCodeAt(Ut)?(l="(",Ut++):(l=o,0===$t&&nn(c)),l!==o){for(f=[],h=$n();h!==o;)f.push(h),h=$n();if(f!==o)if((h=Kn())!==o){for(p=[],y=$n();y!==o;)p.push(y),y=$n();if(p!==o){for(y=[],d=Nn();d!==o;)y.push(d),d=Nn();y!==o?(41===e.charCodeAt(Ut)?(d=")",Ut++):(d=o,0===$t&&nn(a)),d!==o?(t,b=n,v=h,m=y,n=null==(_=r)?{[b]:{in:[v,...m]}}:{table:b,query:{[_]:{in:[v,...m]}}},t=n):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;var b,_,v,m;return t}())===o&&(t=function(){var t,n,r,i,u,s,c;if(t=Ut,(n=Vn())!==o)if((r=Qn())===o&&(r=null),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if("!="===e.substr(Ut,2)?(u="!=",Ut+=2):(u=o,0===$t&&nn(m)),u===o&&(">="===e.substr(Ut,2)?(u=">=",Ut+=2):(u=o,0===$t&&nn(g)),u===o&&("<="===e.substr(Ut,2)?(u="<=",Ut+=2):(u=o,0===$t&&nn(S)),u===o&&(62===e.charCodeAt(Ut)?(u=">",Ut++):(u=o,0===$t&&nn(O)),u===o&&(60===e.charCodeAt(Ut)?(u="<",Ut++):(u=o,0===$t&&nn(w)))))),u!==o){for(s=[],c=$n();c!==o;)s.push(c),c=$n();s!==o&&(c=Kn())!==o?(t,a=n,f=u,h=c,t=n=null==(l=r)?{[a]:{[f]:h}}:{table:a,query:{[l]:{[f]:h}}}):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;var a,l,f,h;return t}())===o&&(t=function(){var t,n,r,i,u,s,f,h,p,y,d,b,_,v,m;if(t=Ut,(n=Vn())!==o)if((r=Qn())===o&&(r=null),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if((u=function(){var e,t,n,r,i,u,s,c;$t++,e=Ut,(t=Hn())!==o&&(n=tr())!==o&&(r=dr())!==o&&(i=vr())!==o&&(u=tr())!==o&&(s=tr())!==o&&(c=lr())!==o?e=t=[t,n,r,i,u,s,c]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(et));return e}())!==o){for(s=[],f=$n();f!==o;)s.push(f),f=$n();if(s!==o)if(40===e.charCodeAt(Ut)?(f="(",Ut++):(f=o,0===$t&&nn(c)),f!==o){for(h=[],p=$n();p!==o;)h.push(p),p=$n();if(h!==o)if((p=Kn())!==o){for(y=[],d=$n();d!==o;)y.push(d),d=$n();if(y!==o)if(44===e.charCodeAt(Ut)?(d=",",Ut++):(d=o,0===$t&&nn(l)),d!==o){for(b=[],_=$n();_!==o;)b.push(_),_=$n();if(b!==o)if((_=Kn())!==o){for(v=[],m=$n();m!==o;)v.push(m),m=$n();v!==o?(41===e.charCodeAt(Ut)?(m=")",Ut++):(m=o,0===$t&&nn(a)),m!==o?(t,g=n,O=p,w=_,t=n=null==(S=r)?{[g]:{"-":{low:O,high:w}}}:{table:g,query:{[S]:{"-":{low:O,high:w}}}}):(Ut=t,t=o)):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;var g,S,O,w;return t}()),t}function jn(){var t,n,r,i,u,s,c,a,l,f;if(t=Ut,(n=Vn())!==o)if((r=Qn())===o&&(r=null),r!==o){for(i=[],u=$n();u!==o;)i.push(u),u=$n();if(i!==o)if(61===e.charCodeAt(Ut)?(u="=",Ut++):(u=o,0===$t&&nn(y)),u!==o){for(s=[],c=$n();c!==o;)s.push(c),c=$n();s!==o&&(c=Kn())!==o?(t,a=n,f=c,t=n=null==(l=r)?{[a]:f}:{table:a,query:{[l]:f}}):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;return t}function In(){var t,n,r,i,u,s;if(t=Ut,44===e.charCodeAt(Ut)?(n=",",Ut++):(n=o,0===$t&&nn(l)),n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if((i=Vn())!==o){for(u=[],s=$n();s!==o;)u.push(s),s=$n();u!==o?(t,t=n=i):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}function Nn(){var t,n,r,i,u,s;if(t=Ut,44===e.charCodeAt(Ut)?(n=",",Ut++):(n=o,0===$t&&nn(l)),n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if((i=Kn())!==o){for(u=[],s=$n();s!==o;)u.push(s),s=$n();u!==o?(t,t=n=i):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}function Qn(){var t,n,r;return t=Ut,46===e.charCodeAt(Ut)?(n=".",Ut++):(n=o,0===$t&&nn(b)),n!==o&&(r=Vn())!==o?(t,t=n=r):(Ut=t,t=o),t}function Ln(){var t,n,r,i,u,s,c,a,l,f,h,p,d;if(t=Ut,(n=function(){var e,t,n,r;e=Ut,(t=function(){var e,t,n,r,i,u;$t++,e=Ut,(t=ir())!==o&&(n=lr())!==o&&(r=lr())!==o&&(i=tr())!==o&&(u=pr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Wt));return e}())===o&&(t=function(){var e,t,n,r,i;$t++,e=Ut,(t=cr())!==o&&(n=tr())!==o&&(r=nr())!==o&&(i=dr())!==o?e=t=[t,n,r,i]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Kt));return e}());if(t!==o){if(n=[],(r=$n())!==o)for(;r!==o;)n.push(r),r=$n();else n=o;n!==o?(e,t=null==(i=t)?null:i.join(""),e=t):(Ut=e,e=o)}else Ut=e,e=o;var i;return e}())===o&&(n=null),n!==o)if(function(){var e,t,n,r,i;$t++,e=Ut,(t=ur())!==o&&(n=fr())!==o&&(r=ir())!==o&&(i=lr())!==o?e=t=[t,n,r,i]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Bt));return e}()!==o){if(r=[],(i=$n())!==o)for(;i!==o;)r.push(i),i=$n();else r=o;if(r!==o)if((i=Fn())!==o){if(u=[],(s=$n())!==o)for(;s!==o;)u.push(s),s=$n();else u=o;if(u!==o)if((s=function(){var e,t,n;$t++,e=Ut,(t=fr())!==o&&(n=lr())!==o?e=t=[t,n]:(Ut=e,e=o);$t--,e===o&&(t=o,0===$t&&nn(Vt));return e}())!==o){if(c=[],(a=$n())!==o)for(;a!==o;)c.push(a),a=$n();else c=o;if(c!==o)if((a=Rn())!==o){for(l=[],f=$n();f!==o;)l.push(f),f=$n();if(l!==o)if(61===e.charCodeAt(Ut)?(f="=",Ut++):(f=o,0===$t&&nn(y)),f!==o)if((h=Rn())!==o){for(p=[],d=$n();d!==o;)p.push(d),d=$n();p!==o?(t,t=n={with:i,on:`${a}=${h}`,type:n}):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;else Ut=t,t=o;return t}function Rn(){var t,n,r;if($t++,t=Ut,n=[],C.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=o,0===$t&&nn(q)),r!==o)for(;r!==o;)n.push(r),C.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=o,0===$t&&nn(q));else n=o;return n!==o&&(t,n=A(n)),$t--,(t=n)===o&&(n=o,0===$t&&nn(D)),t}function Pn(){var t,n,r,i,u,s;if(t=Ut,44===e.charCodeAt(Ut)?(n=",",Ut++):(n=o,0===$t&&nn(l)),n!==o){for(r=[],i=$n();i!==o;)r.push(i),i=$n();if(r!==o)if((i=jn())!==o){for(u=[],s=$n();s!==o;)u.push(s),s=$n();u!==o?(t,t=n=i):(Ut=t,t=o)}else Ut=t,t=o;else Ut=t,t=o}else Ut=t,t=o;return t}function Fn(){var e;return $t++,e=Mn(),$t--,e===o&&(o,0===$t&&nn(T)),e}function Bn(){var e;return $t++,e=Mn(),$t--,e===o&&(o,0===$t&&nn(j)),e}function Vn(){var e;return $t++,e=Mn(),$t--,e===o&&(o,0===$t&&nn(I)),e}function Wn(){var t;return(t=function(){var t;"&&"===e.substr(Ut,2)?(t="&&",Ut+=2):(t=o,0===$t&&nn(R));return t}())===o&&(t=function(){var t;"||"===e.substr(Ut,2)?(t="||",Ut+=2):(t=o,0===$t&&nn(P));return t}()),t}function Kn(){var t,n;return $t++,t=Ut,(n=function(){var t,n,r,i;t=Ut,39===e.charCodeAt(Ut)?(n="'",Ut++):(n=o,0===$t&&nn(E));n!==o&&(r=Gn())!==o?(39===e.charCodeAt(Ut)?(i="'",Ut++):(i=o,0===$t&&nn(E)),i!==o?(t,t=n=r):(Ut=t,t=o)):(Ut=t,t=o);return t}())===o&&(n=Jn()),n!==o&&(t,n=n),$t--,(t=n)===o&&(n=o,0===$t&&nn(F)),t}function Mn(){var t,n,r;if($t++,t=Ut,n=[],V.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=o,0===$t&&nn(W)),r!==o)for(;r!==o;)n.push(r),V.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=o,0===$t&&nn(W));else n=o;return n!==o&&(t,n=A(n)),$t--,(t=n)===o&&(n=o,0===$t&&nn(B)),t}function Gn(){var e,t,n;if($t++,e=Ut,t=[],(n=Un())!==o)for(;n!==o;)t.push(n),n=Un();else t=o;return t!==o&&(e,t=t.join("")),$t--,(e=t)===o&&(t=o,0===$t&&nn(K)),e}function Un(){var t;return M.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(G)),t}function Jn(){var e,t,n;if($t++,e=Ut,t=[],(n=zn())!==o)for(;n!==o;)t.push(n),n=zn();else t=o;return t!==o&&(e,t=Number(t.join(""))),$t--,(e=t)===o&&(t=o,0===$t&&nn(U)),e}function zn(){var t;return J.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(z)),t}function Zn(){var t;return $t++,$.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Y)),$t--,t===o&&(o,0===$t&&nn(Z)),t}function $n(){var e,t,n;if($t++,e=Ut,t=[],(n=Zn())!==o)for(;n!==o;)t.push(n),n=Zn();else t=o;return t!==o&&(e,t=null),$t--,(e=t)===o&&(t=o,0===$t&&nn(H)),e}function Yn(){var t;return X.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ee)),t}function Hn(){var t;return te.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ne)),t}function Xn(){var t;return re.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(oe)),t}function er(){var t;return ie.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ue)),t}function tr(){var t;return se.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ce)),t}function nr(){var t;return ae.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(le)),t}function rr(){var t;return fe.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(he)),t}function or(){var t;return pe.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ye)),t}function ir(){var t;return de.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(be)),t}function ur(){var t;return _e.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ve)),t}function sr(){var t;return me.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ge)),t}function cr(){var t;return Se.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Oe)),t}function ar(){var t;return we.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(xe)),t}function lr(){var t;return ke.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Ee)),t}function fr(){var t;return De.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Ce)),t}function hr(){var t;return qe.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Ae)),t}function pr(){var t;return Ie.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Ne)),t}function yr(){var t;return Qe.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Le)),t}function dr(){var t;return Re.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Pe)),t}function br(){var t;return Fe.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Be)),t}function _r(){var t;return Ve.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(We)),t}function vr(){var t;return Ke.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Me)),t}function mr(){var t;return Ge.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(Ue)),t}function gr(){var t;return Je.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=o,0===$t&&nn(ze)),t}function Sr(){var e,t,n,r,i,u;return $t++,e=Ut,(t=Xn())!==o&&(n=fr())!==o&&(r=br())!==o&&(i=lr())!==o&&(u=dr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o),$t--,e===o&&(t=o,0===$t&&nn(He)),e}function Or(){var e,t,n;return $t++,e=Ut,(t=Hn())!==o&&(n=gr())!==o?e=t=[t,n]:(Ut=e,e=o),$t--,e===o&&(t=o,0===$t&&nn(ut)),e}function wr(){var e,t,n,r,i;return $t++,e=Ut,(t=nr())!==o&&(n=pr())!==o&&(r=fr())!==o&&(i=ar())!==o?e=t=[t,n,r,i]:(Ut=e,e=o),$t--,e===o&&(t=o,0===$t&&nn(st)),e}function xr(){var e,t,n,r,i,u,s;return $t++,e=Ut,(t=er())!==o&&(n=tr())!==o&&(r=nr())!==o&&(i=ir())!==o&&(u=lr())!==o&&(s=tr())!==o?e=t=[t,n,r,i,u,s]:(Ut=e,e=o),$t--,e===o&&(t=o,0===$t&&nn(Nt)),e}function kr(){var e,t,n,r,i,u;return $t++,e=Ut,(t=dr())!==o&&(n=Yn())!==o&&(r=Hn())!==o&&(i=cr())!==o&&(u=tr())!==o?e=t=[t,n,r,i,u]:(Ut=e,e=o),$t--,e===o&&(t=o,0===$t&&nn(Qt)),e}if((n=u())!==o&&Ut===e.length)return n;throw n!==o&&Ut<e.length&&nn({type:"end"}),rn(Zt,zt<e.length?e.charAt(zt):null,zt<e.length?tn(zt,zt+1):tn(zt,zt))}}},function(e,t,n){"use strict";n.r(t),n.d(t,"LogHelper",(function(){return i}));var r=n(5),o=n(6),i=function(){function e(e,t){this.type=e,this.info_=t,this.message=this.getMsg_()}return e.log=function(e){o.Config.isLogEnabled&&console.log(e)},e.prototype.logError=function(){console.error(this.get())},e.prototype.logWarning=function(){console.warn(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.getMsg_=function(){var e;switch(this.type){case r.ERROR_TYPE.SynTaxError:e=this.info_;break;default:e=this.message}return e},e}()},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"ERROR_TYPE",(function(){return r})),function(e){e.SynTaxError="syntax_error"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"Config",(function(){return r}));var r=function(){function e(){}return e.isLogEnabled=!1,e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"Query",(function(){return o}));var r=n(2),o=function(){function e(e){this.topLevelKeys_=["skip","limit"],this.query_=this.parseSql_(e)}return e.prototype.map=function(e,t){var n=JSON.stringify(this.query_);this.query_=this.parseJson_(n.replace('"'+e+'"',JSON.stringify(t)))},e.prototype.parseJson_=function(e){return r.Util.parseJson(e)},e.prototype.parseSql_=function(e){return r.Util.parseSql(e)},e}()}])},uXZf:function(e,t){
/*!
 * @license :jsstore - V3.13.5 - 06/04/2021
 * https://github.com/ujjwalguptaofficial/JsStore
 * Copyright (c) 2021 @Ujjwal Gupta; Licensed MIT
 */
e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";var r,o,i,u,s,c,a,l,f;n.r(t),n.d(t,"Instance",(function(){return v})),n.d(t,"Connection",(function(){return _})),n.d(t,"Config",(function(){return p})),n.d(t,"enableLog",(function(){return m})),n.d(t,"DATA_TYPE",(function(){return i})),function(e){e.WorkerNotSupplied="worker_not_supplied",e.IndexedDbUndefined="indexeddb_undefined",e.UndefinedColumn="undefined_column",e.UndefinedValue="undefined_value",e.UndefinedColumnName="undefined_column_name",e.UndefinedDbName="undefined_database_name",e.UndefinedColumnValue="undefined_column_value",e.NotArray="not_array",e.NoValueSupplied="no_value_supplied",e.ColumnNotExist="column_not_exist",e.EnableSearchOff="enable_search_off",e.InvalidOp="invalid_operator",e.NullValue="null_value",e.WrongDataType="wrong_data_type",e.TableNotExist="table_not_exist",e.DbNotExist="db_not_exist",e.ConnectionAborted="connection_aborted",e.ConnectionClosed="connection_closed",e.NotObject="not_object",e.InvalidConfig="invalid_config",e.DbBlocked="Db_blocked",e.IndexedDbNotSupported="indexeddb_not_supported",e.NullValueInWhere="null_value_in_where",e.InvalidJoinQuery="invalid_join_query",e.InvalidOrderQuery="invalid_order_query",e.InvalidQuery="invalid_query",e.InvalidGroupQuery="invalid_group_query",e.ImportScriptsFailed="import_scripts_failed",e.MethodNotExist="method_not_exist"}(r||(r={})),function(e){e.Registered="registerd",e.Failed="failed",e.NotStarted="not_started"}(o||(o={})),function(e){e.String="string",e.Object="object",e.Array="array",e.Number="number",e.Boolean="boolean",e.Null="null",e.DateTime="date_time"}(i||(i={})),function(e){e.InitDb="init_db",e.IsDbExist="is_db_exist",e.GetDbVersion="get_db_version",e.GetDbList="get_db_list",e.Get="get",e.Set="set",e.Select="select",e.Insert="insert",e.Update="update",e.Remove="remove",e.GetDbSchema="get_db_schema",e.OpenDb="open_db",e.Clear="clear",e.DropDb="drop_db",e.Count="count",e.ChangeLogStatus="change_log_status",e.Terminate="terminate",e.Transaction="transaction",e.InitKeyStore="init_keystore",e.CloseDb="close_db",e.Union="union",e.Intersect="intersect",e.ImportScripts="import_scripts"}(u||(u={})),function(e){e.RequestQueueEmpty="requestQueueEmpty",e.RequestQueueFilled="requestQueueFilled"}(s||(s={})),function(e){e.Where="where",e.Like="like",e.Regex="regex",e.In="in",e.Equal="=",e.Between="-",e.GreaterThan=">",e.LessThan="<",e.GreaterThanEqualTo=">=",e.LessThanEqualTo="<=",e.NotEqualTo="!=",e.Aggregate="aggregate",e.Max="max",e.Min="min",e.Avg="avg",e.Count="count",e.Sum="sum",e.Or="or",e.Skip="skip",e.Limit="limit",e.And="and",e.IgnoreCase="ignoreCase",e.Then="then"}(c||(c={})),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(a||(a={})),function(e){e.First="f",e.Last="l",e.Any="a"}(l||(l={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_started",e.UnableToStart="unable_to_start",e.ClosedByJsStore="closed_by_jsstore"}(f||(f={}));var h,p=function(){function e(){}return e.isLogEnabled=!1,e.isRuningInWorker=!0,e}(),y=function(){function e(e,t){void 0===t&&(t=null),this.type=e,this._info=t,this.message=this.getMsg()}return e.prototype.throw=function(){throw this.get()},e.log=function(e){p.isLogEnabled&&console.log(e)},e.prototype.logError=function(){console.error(this.get())},e.prototype.logWarning=function(){console.warn(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.getMsg=function(){var e;switch(this.type){case r.WorkerNotSupplied:e="Worker object is not passed in instance constructor";break;case r.IndexedDbUndefined:e="Browser does not support indexeddb";break;default:e=this.message}return e},e}(),d=function(){function e(e){this.isDbOpened_=!1,this.isDbIdle_=!0,this.requestQueue_=[],this.isCodeExecuting_=!1,this.inactivityTimer_=-1e3,this.eventQueue=[],this.middlewares=[],this.whiteListApi_=[u.InitDb,u.IsDbExist,u.GetDbVersion,u.GetDbList,u.OpenDb,u.GetDbSchema,u.Get,u.Set,u.ChangeLogStatus,u.Terminate,u.InitKeyStore],e?(this.worker_=e,this.worker_.onmessage=this.onMessageFromWorker_.bind(this)):p.isRuningInWorker=!1}return e.prototype.initKeyStore_=function(){p.isRuningInWorker?this.prcoessExecutionOfQry_({name:u.InitKeyStore,onSuccess:function(){},onError:function(e){console.error(e)}},0):JsStoreWorker.KeyStore.init()},e.prototype.onMessageFromWorker_=function(e){this.processFinishedQuery_(e.data)},e.prototype.processFinishedQuery_=function(e){var t=this.requestQueue_.shift();if(t){if(y.log("request "+t.name+" finished"),e.errorOccured)t.onError(e.errorDetails);else{switch(t.name){case u.OpenDb:case u.InitDb:this.isDbOpened_=!0;break;case u.Terminate:this.isDbOpened_=!1,!0===p.isRuningInWorker&&this.worker_.terminate();break;case u.CloseDb:this.requestQueue_.length>0?this.openDb_():(this.isDbIdle_=!0,this.callEvent(s.RequestQueueEmpty,[]))}t.onSuccess(e.returnedValue)}this.isCodeExecuting_=!1,this.executeQry_()}},e.prototype.openDb_=function(){this.initKeyStore_(),this.prcoessExecutionOfQry_({name:u.OpenDb,query:this.activeDbName,onSuccess:function(){},onError:function(e){console.error(e)}},1)},e.prototype.executeMiddleware_=function(e){var t=this;return new Promise((function(n){var r=0,o=t.middlewares.length-1,i=function(){r<=o?t.middlewares[r++](e,i):n()};i()}))},e.prototype.pushApi=function(e){var t=this;return new Promise((function(n,r){t.executeMiddleware_(e).then((function(){e.onSuccess=n,e.onError=r,0===t.requestQueue_.length&&(t.callEvent(s.RequestQueueFilled,[]),!0===t.isDbIdle_&&!0===t.isDbOpened_?t.openDb_():(clearTimeout(t.inactivityTimer_),t.initKeyStore_())),t.prcoessExecutionOfQry_(e)})).catch(r)}))},e.prototype.prcoessExecutionOfQry_=function(e,t){this.isDbIdle_=!1,null!=t?this.requestQueue_.splice(t,0,e):this.requestQueue_.push(e),y.log("request pushed: "+e.name),this.executeQry_()},e.prototype.executeQry_=function(){var e=this,t=this.requestQueue_.length;if(!this.isCodeExecuting_&&t>0){if(!0===this.isDbOpened_)return void this.sendRequestToWorker_(this.requestQueue_[0]);var n=this.requestQueue_.findIndex((function(t){return e.whiteListApi_.indexOf(t.name)>=0}));n>=0&&(this.requestQueue_.splice(0,0,this.requestQueue_.splice(n,1)[0]),this.sendRequestToWorker_(this.requestQueue_[0]))}else 0===t&&!1===this.isDbIdle_&&this.isDbOpened_&&(this.inactivityTimer_=setTimeout((function(){e.prcoessExecutionOfQry_({name:u.CloseDb,onSuccess:function(){},onError:function(e){console.error(e)}})}),100))},e.prototype.sendRequestToWorker_=function(e){this.isCodeExecuting_=!0;var t={name:e.name,query:e.query};!0===p.isRuningInWorker?this.worker_.postMessage(t):new JsStoreWorker.QueryExecutor(this.processFinishedQuery_.bind(this)).checkConnectionAndExecuteLogic(t)},e.prototype.callEvent=function(e,t){this.eventQueue.filter((function(t){if(t.event===e)return t})).forEach((function(e){e.callback.apply(e,t)}))},e}(),b=(h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_=function(e){function t(t){return e.call(this,t)||this}return b(t,e),t.prototype.openDb=function(e){return this.activeDbName=e,this.pushApi({name:u.OpenDb,query:e})},t.prototype.initDb=function(e){return this.activeDbName=e.name,this.pushApi({name:u.InitDb,query:e})},t.prototype.dropDb=function(){return this.pushApi({name:u.DropDb})},t.prototype.select=function(e){return this.pushApi({name:u.Select,query:e})},t.prototype.count=function(e){return this.pushApi({name:u.Count,query:e})},t.prototype.insert=function(e){return this.pushApi({name:u.Insert,query:e})},t.prototype.update=function(e){return this.pushApi({name:u.Update,query:e})},t.prototype.remove=function(e){return this.pushApi({name:u.Remove,query:e})},t.prototype.clear=function(e){return this.pushApi({name:u.Clear,query:e})},t.prototype.setLogStatus=function(e){p.isLogEnabled=e||p.isLogEnabled,this.pushApi({name:u.ChangeLogStatus,query:p.isLogEnabled})},t.prototype.getDbVersion=function(e){return this.pushApi({name:u.GetDbVersion,query:e})},t.prototype.isDbExist=function(e){return this.pushApi({name:u.IsDbExist,query:e})},t.prototype.getDbList=function(){return this.pushApi({name:u.GetDbList,query:null})},t.prototype.getDbSchema=function(e){return this.pushApi({name:u.GetDbSchema,query:e})},t.prototype.get=function(e){return this.pushApi({name:u.Get,query:e})},t.prototype.set=function(e,t){return this.pushApi({name:u.Set,query:{key:e,value:t}})},t.prototype.terminate=function(){return this.pushApi({name:u.Terminate})},t.prototype.transaction=function(e){return this.pushApi({name:u.Transaction,query:e})},t.prototype.on=function(e,t){this.eventQueue.push({event:e,callback:t})},t.prototype.off=function(e,t){var n=this;this.eventQueue.map((function(t,n){if(t.event===e)return n})).forEach((function(e){n.eventQueue.splice(e,0)}))},t.prototype.union=function(e){return this.pushApi({name:u.Union,query:e})},t.prototype.intersect=function(e){return this.pushApi({name:u.Intersect,query:e})},t.prototype.addPlugin=function(e,t){e.setup(this,t)},t.prototype.addMiddleware=function(e){this.middlewares.push(e)},t.prototype.importScripts=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.pushApi({name:u.ImportScripts,query:e})},t}(d),v=function(e){return console.warn("Instance is obsolete, please use Connection. Refer - https://jsstore.net/tutorial/connection/"),new _(e)},m=function(){p.isLogEnabled=!0}}])},vRPr:function(e,t){
/*!
 * @license :jsstore - V3.13.5 - 06/04/2021
 * https://github.com/ujjwalguptaofficial/JsStore
 * Copyright (c) 2021 @Ujjwal Gupta; Licensed MIT
 */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}({10:function(e,t,n){"use strict";var r,o,i,u,s,c,a,l,f,h;n.r(t),n.d(t,"QueryExecutor",(function(){return Ft})),n.d(t,"initialize",(function(){return Bt})),n.d(t,"Config",(function(){return V})),n.d(t,"KeyStore",(function(){return B})),function(e){e.WorkerNotSupplied="worker_not_supplied",e.IndexedDbUndefined="indexeddb_undefined",e.UndefinedColumn="undefined_column",e.UndefinedValue="undefined_value",e.UndefinedColumnName="undefined_column_name",e.UndefinedDbName="undefined_database_name",e.UndefinedColumnValue="undefined_column_value",e.NotArray="not_array",e.NoValueSupplied="no_value_supplied",e.ColumnNotExist="column_not_exist",e.EnableSearchOff="enable_search_off",e.InvalidOp="invalid_operator",e.NullValue="null_value",e.WrongDataType="wrong_data_type",e.TableNotExist="table_not_exist",e.DbNotExist="db_not_exist",e.ConnectionAborted="connection_aborted",e.ConnectionClosed="connection_closed",e.NotObject="not_object",e.InvalidConfig="invalid_config",e.DbBlocked="Db_blocked",e.IndexedDbNotSupported="indexeddb_not_supported",e.NullValueInWhere="null_value_in_where",e.InvalidJoinQuery="invalid_join_query",e.InvalidOrderQuery="invalid_order_query",e.InvalidQuery="invalid_query",e.InvalidGroupQuery="invalid_group_query",e.ImportScriptsFailed="import_scripts_failed",e.MethodNotExist="method_not_exist"}(r||(r={})),function(e){e.Registered="registerd",e.Failed="failed",e.NotStarted="not_started"}(o||(o={})),function(e){e.String="string",e.Object="object",e.Array="array",e.Number="number",e.Boolean="boolean",e.Null="null",e.DateTime="date_time"}(i||(i={})),function(e){e.InitDb="init_db",e.IsDbExist="is_db_exist",e.GetDbVersion="get_db_version",e.GetDbList="get_db_list",e.Get="get",e.Set="set",e.Select="select",e.Insert="insert",e.Update="update",e.Remove="remove",e.GetDbSchema="get_db_schema",e.OpenDb="open_db",e.Clear="clear",e.DropDb="drop_db",e.Count="count",e.ChangeLogStatus="change_log_status",e.Terminate="terminate",e.Transaction="transaction",e.InitKeyStore="init_keystore",e.CloseDb="close_db",e.Union="union",e.Intersect="intersect",e.ImportScripts="import_scripts"}(u||(u={})),function(e){e.RequestQueueEmpty="requestQueueEmpty",e.RequestQueueFilled="requestQueueFilled"}(s||(s={})),function(e){e.Where="where",e.Like="like",e.Regex="regex",e.In="in",e.Equal="=",e.Between="-",e.GreaterThan=">",e.LessThan="<",e.GreaterThanEqualTo=">=",e.LessThanEqualTo="<=",e.NotEqualTo="!=",e.Aggregate="aggregate",e.Max="max",e.Min="min",e.Avg="avg",e.Count="count",e.Sum="sum",e.Or="or",e.Skip="skip",e.Limit="limit",e.And="and",e.IgnoreCase="ignoreCase",e.Then="then"}(c||(c={})),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(a||(a={})),function(e){e.First="f",e.Last="l",e.Any="a"}(l||(l={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_started",e.UnableToStart="unable_to_start",e.ClosedByJsStore="closed_by_jsstore"}(f||(f={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_connected"}(h||(h={}));var p,y,d,b,_,v,m,g,S,O,w,x,k,E,D=function(){function e(){this.results=null,this.errorOccured=!1,this.errorCount=0}return e.prototype.onErrorOccured=function(e){++this.errorCount,1===this.errorCount&&null!=this.onError&&this.onError(e.target.error),console.error(e)},e}(),C=function(){function e(){}return e.callDbDroppedByBrowser=function(){e.isDbDeletedByBrowser=e.dbStatus.conStatus===h.Connected},e.createTransaction=function(t,n,r){null===e.transaction&&(r=r||"readwrite",e.transaction=e.dbConnection.transaction(t,r),e.transaction.oncomplete=function(){e.transaction=null,n()},e.transaction.ontimeout=function(){this._transaction=null,console.error("transaction timed out")})},e.transaction=null,e.dbStatus={conStatus:h.NotStarted},e}(),q=(p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),A=function(e){function t(t,n,r){var o=e.call(this)||this;return o.rowAffected=0,o.key=t,o.onSuccess=n,o.onError=r,o}return q(t,e),t.prototype.execute=function(){var e=this;this.initTransaction();var t,n,r;this.errorOccured||(t=F.columnName,n=this.key,(r=e.objectStore.index(t).openCursor(IDBKeyRange.only(n))).onerror=function(t){e.errorOccured=!0,e.onErrorOccured(t)},r.onsuccess=function(t){var n=t.target.result;n&&(n.delete(),++e.rowAffected,n.continue())})},t.prototype.initTransaction=function(){C.createTransaction([F.tableName],this.onTransactionCompleted.bind(this)),this.objectStore=C.transaction.objectStore(F.tableName)},t.prototype.onTransactionCompleted=function(){!1===this.errorOccured&&this.onSuccess(this.rowAffected)},t}(D),T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(e){function t(t,n,r){var o=e.call(this)||this;o.onTransactionCompleted_=function(){!1===o.errorOccured&&o.onSuccess&&o.onSuccess(null)};try{o.query=t,o.onSuccess=n,o.onError=r}catch(e){console.error(e)}return o}return T(t,e),t.prototype.execute=function(){var e,t=this;this.initTransaction(),(e=t.objectStore.index(F.columnName).openCursor(IDBKeyRange.only(t.query[F.columnName]))).onsuccess=function(e){var n=e.target.result;n?n.update(t.query):t.objectStore.add(t.query).onerror=function(e){t.errorOccured=!0,t.onErrorOccured(e)}},e.onerror=function(e){t.errorOccured=!0,t.onErrorOccured(e)}},t.prototype.initTransaction=function(){C.createTransaction([F.tableName],this.onTransactionCompleted_),this.objectStore=C.transaction.objectStore(F.tableName)},t}(D),I=function(){function e(){}return e.updateDbStatus=function(e,t){void 0===t?C.dbStatus.conStatus=e:C.dbStatus={conStatus:e,lastError:t}},e}(),N=function(e,t,n){var o=self.indexedDB.open(e,1);C.isDbDeletedByBrowser=!1,o.onerror=function(e){"InvalidStateError"===e.target.error.name?n({message:"Indexeddb is blocked",type:r.IndexedDbNotSupported}):n(e.target.error)},o.onsuccess=function(){C.dbStatus.conStatus=h.Connected,C.dbConnection=o.result,C.dbConnection.onclose=function(){C.callDbDroppedByBrowser(),I.updateDbStatus(h.Closed,r.ConnectionClosed)},C.dbConnection.onversionchange=function(e){null===e.newVersion&&(e.target.close(),C.callDbDroppedByBrowser(),I.updateDbStatus(h.Closed,r.ConnectionClosed))},C.dbConnection.onerror=function(e){C.dbStatus.lastError="Error occured in connection :"+e.target.result},C.dbConnection.onabort=function(){C.dbStatus={conStatus:h.Closed,lastError:"Connection aborted"}},null!=t&&t()},o.onupgradeneeded=function(e){e.target.result.createObjectStore(F.tableName,{keyPath:"Key"}).createIndex("Key","Key",{unique:!0})}},Q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),L=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onTransactionCompleted_=function(){!1===o.errorOccured&&o.onSuccess(o.results)},o.key=t,o.onSuccess=n,o.onError=r,o}return Q(t,e),t.prototype.execute=function(){var e,t,n,r=this;this.initTransaction_(),e=F.columnName,t=this.key,(n=r.objectStore.index(e).openCursor(IDBKeyRange.only(t))).onerror=function(e){r.errorOccured=!0,r.onErrorOccured(e)},n.onsuccess=function(e){var t=e.target.result;t&&(r.results=t.value.Value)}},t.prototype.initTransaction_=function(){C.createTransaction([F.tableName],this.onTransactionCompleted_,"readonly"),this.objectStore=C.transaction.objectStore(F.tableName)},t}(D),R=function(){function e(e){void 0===e&&(e=null),this.onQueryFinished=e}return e.prototype.checkConnectionAndExecuteLogic=function(e){var t=this;if("init_db"===e.name)this.executeLogic(e);else switch(C.dbStatus.conStatus){case h.Connected:this.executeLogic(e);break;case h.NotStarted:setTimeout((function(){t.checkConnectionAndExecuteLogic(e)}),100);break;case h.Closed:C.isDbDeletedByBrowser&&this.createDb((function(){C.isDbDeletedByBrowser=!1,t.checkConnectionAndExecuteLogic(e)}),(function(e){console.error(e)}))}},e.prototype.returnResult=function(e){this.onQueryFinished(e)},e.prototype.executeLogic=function(e){var t=this,n=function(e){t.returnResult({returnedValue:e})},r=function(e){t.returnResult({errorDetails:e,errorOccured:!0})};switch(e.name){case"get":this.get(e.query,n,r);break;case"set":this.set(e.query,n,r);break;case"remove":this.remove(e.query,n,r);break;case"init_db":this.createDb(n,r);break;case"close_db":this.closeDb(n,r)}},e.prototype.set=function(e,t,n){new j(e,t,n).execute()},e.prototype.remove=function(e,t,n){new A(e,t,n).execute()},e.prototype.get=function(e,t,n){new L(e,t,n).execute()},e.prototype.createDb=function(e,t){new N("KeyStore",e,t)},e.prototype.closeDb=function(e){C.dbStatus.conStatus===h.Connected&&(C.dbStatus.conStatus=h.Closed,C.dbConnection.close()),e()},e}(),P=function(e){return new Promise(e)},F=function(){function e(){}return e.prcoessQuery=function(e){var t=this;return P((function(n,r){e.onSuccess=function(e){n(e)},e.onError=function(e){console.error(e),r(e)},t.requestQueue.push(e),t.executeCode()}))},e.executeCode=function(){if(!this.isCodeExecuting&&this.requestQueue.length>0){this.isCodeExecuting=!0;var e={name:this.requestQueue[0].name,query:this.requestQueue[0].query};new R(this.onQueryFinished.bind(this)).checkConnectionAndExecuteLogic(e)}},e.onQueryFinished=function(e){var t=this.requestQueue.shift();this.isCodeExecuting=!1,e.errorOccured?t.onError(e.errorDetails):t.onSuccess(e.returnedValue),this.executeCode()},e.requestQueue=[],e.tableName="LocalStore",e.columnName="Key",e.isCodeExecuting=!1,e}(),B=function(){function e(){}return e.init=function(){if(indexedDB)return F.prcoessQuery({name:"init_db",query:null})},e.close=function(){return F.prcoessQuery({name:"close_db",query:null})},e.get=function(e){return F.prcoessQuery({name:"get",query:e})},e.set=function(e,t){return F.prcoessQuery({name:"set",query:{Key:e,Value:t}})},e.remove=function(e){return F.prcoessQuery({name:"remove",query:e})},e}(),V=function(){function e(){}return e.isLogEnabled=!1,e.isRuningInWorker=!1,e}(),W=function(){function e(e,t){void 0===t&&(t=null),this.type=e,this.info_=t,this.message=this.getMsg_()}return e.prototype.throw=function(){throw this.get()},e.log=function(e){V.isLogEnabled&&console.log(e)},e.prototype.logError=function(){console.error(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.getMsg_=function(){var e;switch(this.type){case r.NotArray:e="Supplied value is not an array";break;case r.UndefinedColumn:e="Column is undefined in Where";break;case r.UndefinedValue:e="Value is undefined in Where";break;case r.UndefinedColumnName:e="Column name is undefined '"+this.info_.TableName+"'";break;case r.UndefinedDbName:e="Database name is not supplied";break;case r.UndefinedColumnValue:e="Column value is undefined";break;case r.NoValueSupplied:e="No value is supplied";break;case r.InvalidOp:e="Invalid Op Value '"+this.info_.Op+"'";break;case r.ColumnNotExist:e=this.info_.isOrder?"Column '"+this.info_.column+"' in order query does not exist":"Column '"+this.info_.column+"' does not exist";break;case r.EnableSearchOff:e="Search is turned off for the Column '"+this.info_.column+"'";break;case r.NullValue:e="Null value is not allowed for column '"+this.info_.ColumnName+"'";break;case r.WrongDataType:e="Supplied value for column '"+this.info_.column+"' have wrong data type";break;case r.TableNotExist:e="Table '"+this.info_.tableName+"' does not exist";break;case r.DbNotExist:e="Database with name "+this.info_.dbName+" does not exist";break;case r.NotObject:e="supplied value is not object";break;case r.InvalidOp:e="Invalid Config '"+this.info_.Config+" '";break;case r.DbBlocked:e="database is blocked, cant be deleted right now";break;case r.NullValueInWhere:e="Null/undefined is not allowed in where. Column '"+this.info_.column+"' has null";break;case r.InvalidJoinQuery:e=this.info_;break;default:e=this.message}return e},e}(),K=function(){function e(){}return Object.defineProperty(e.prototype,"dbName",{get:function(){return U.activeDb.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dbStatus",{get:function(){return U.dbStatus},set:function(e){U.dbStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dbConnection",{get:function(){return U.dbConnection},set:function(e){U.dbConnection=e},enumerable:!1,configurable:!0}),e.prototype.updateDbStatus=function(e,t){U.updateDbStatus(e,t)},e.prototype.onDbDroppedByBrowser=function(e){U.callDbDroppedByBrowser(e)},Object.defineProperty(e.prototype,"dbVersion",{get:function(){return parseInt(U.activeDbVersion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeDb",{get:function(){return U.activeDb},enumerable:!1,configurable:!0}),e.prototype.getDbList=function(){return U.getDbList()},e.prototype.setDbList=function(e){return U.setDbList(e)},e.prototype.onDbClose=function(){this.onDbDroppedByBrowser(),this.updateDbStatus(f.Closed,r.ConnectionClosed)},e.prototype.onDbVersionChange=function(e){null===e.newVersion&&(e.target.close(),this.onDbDroppedByBrowser(!0),this.updateDbStatus(f.Closed,r.ConnectionClosed))},e.prototype.onDbConError=function(e){U.dbStatus.lastError="Error occured in connection :"+e.target.result},e}(),M=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(e){function t(t,n){var r=e.call(this)||this;return r.onSuccess_=t,r.onError_=n,r}return M(t,e),t.prototype.deleteMetaData=function(){var e=this;return P((function(t,n){B.remove("JsStore_"+e.dbName+"_Db_Version"),e.activeDb.tables.forEach((function(t){B.remove("JsStore_"+e.dbName+"_"+t.name+"_Version"),t.columns.forEach((function(n){n.autoIncrement&&B.remove("JsStore_"+e.dbName+"_"+t.name+"_"+n.name+"_Value")}))})),e.getDbList().then((function(r){r.splice(r.indexOf(e.dbName),1),e.setDbList(r).then((function(){B.remove("JsStore_"+e.dbName+"_Schema").then(t).catch(n)}))}))}))},t.prototype.deleteDb=function(){var e=this;setTimeout((function(){var t=indexedDB.deleteDatabase(e.dbName);t.onblocked=function(){null!=e.onError_&&e.onError_(new W(r.DbBlocked).get())},t.onerror=function(){null!=e.onError_&&e.onError_(event.target.error)},t.onsuccess=function(){e.deleteMetaData().then((function(){e.onSuccess_(),e.dbStatus.conStatus=f.Closed})).catch(e.onError_)}}),100)},t}(K),U=function(){function e(){}return e.callDbDroppedByBrowser=function(t){e.dbStatus.conStatus===f.Connected&&(e.isDbDeletedByBrowser=!0,!0===t&&new G((function(){}),(function(){})).deleteMetaData())},e.createTransaction=function(t,n,r){if(null===e.transaction){r=r||a.ReadWrite,e.transaction=e.dbConnection.transaction(t,r);var o=function(){e.transaction=null,n()};e.transaction.oncomplete=o,e.transaction.onabort=o}},e.setDbList=function(e){return B.set("DataBase_List",e)},e.updateDbStatus=function(t,n){void 0===n?e.dbStatus.conStatus=t:e.dbStatus={conStatus:t,lastError:n}},e.getDbList=function(){return P((function(e,t){B.get("DataBase_List").then((function(t){e(null==t?[]:t)})).catch(t)}))},e.getDbVersion=function(e){return P((function(t,n){B.get("JsStore_"+e+"_Db_Version").then((function(e){t(Number(e))})).catch(n)}))},e.getDbSchema=function(e){return B.get("JsStore_"+e+"_Schema")},e.getTable=function(t){return e.activeDb.tables.find((function(e){return e.name===t}))},e.transaction=null,e.activeDbVersion=0,e.dbStatus={conStatus:f.NotStarted},e}(),J=function(e){if(null==e)return!0;switch(typeof e){case"string":return 0===e.length;case"number":return isNaN(e)}return!1},z=function(e){if(null==e)return i.Null;var t=typeof e;switch(t){case"object":if(Array.isArray(e))return i.Array;if(e instanceof Date)return i.DateTime}return t},Z=function(){function e(e){this.table=e}return e.prototype.check=function(e,t){var n=this,o=null;return typeof e===i.Object?this.table?this.table.columns.every((function(t){return null===o&&(t.name in e&&(o=n.checkByColumn_(t,e[t.name])),!0)})):o=new W(r.TableNotExist,{tableName:t}):o=new W(r.NotObject),null!=o?o.get():null},e.prototype.checkByColumn_=function(e,t){var n=null;!0===e.notNull&&J(t)&&(n=new W(r.NullValue,{ColumnName:e.name}));var o=z(t),i=null!=t;if(e.dataType&&i&&o!==e.dataType&&"object"!==o&&(n=new W(r.WrongDataType,{column:e.name})),i&&"object"===o){var u=["+","-","*","/","{push}"];for(var s in t){u.indexOf(s)<0&&e.dataType&&o!==e.dataType&&(n=new W(r.WrongDataType,{column:e.name}));break}}return n},e}(),$=function(){function e(e,t){this.errorOccured=!1,this.autoIncrementValue={},this.table=e,this.autoIncrementValue=t}return e.prototype.checkAndModifyValue=function(e){var t=this;return this.value=e,this.table.columns.every((function(e){return t.checkAndModifyColumnValue_(e),!t.errorOccured})),this.errorOccured},e.prototype.checkNotNullAndDataType_=function(e){e.notNull&&J(this.value[e.name])?this.onValidationError_(r.NullValue,{ColumnName:e.name}):e.dataType&&!J(this.value[e.name])&&z(this.value[e.name])!==e.dataType&&this.onValidationError_(r.WrongDataType,{column:e.name})},e.prototype.checkAndModifyColumnValue_=function(e){var t=this.value[e.name];e.autoIncrement?J(t)?this.value[e.name]=++this.autoIncrementValue[e.name]:z(t)===i.Number&&t>this.autoIncrementValue[e.name]&&(this.autoIncrementValue[e.name]=t):void 0!==e.default&&J(t)&&(this.value[e.name]=e.default),this.checkNotNullAndDataType_(e)},e.prototype.onValidationError_=function(e,t){this.errorOccured=!0,this.log=new W(e,t)},e}(),Y=function(e){return Promise.all(e)},H=function(e){var t=e.columns.filter((function(e){return e.autoIncrement}));return P((function(n,r){Y(t.map((function(t){var n="JsStore_"+U.activeDb.name+"_"+e.name+"_"+t.name+"_Value";return B.get(n)}))).then((function(e){for(var r={},o=0;o<t.length;o++)r[t[o].name]=e[o];n(r)})).catch(r)}))},X=function(){function e(e,t){this.table=e,this.values=t}return e.prototype.checkAndModifyValues=function(){var e=this;return P((function(t,n){var r=function(r){e.valueCheckerObj=new $(e.table,r),e.startChecking().then(t).catch(n)};!1===Ft.isTransactionQuery?H(e.table).then((function(e){r(e)})).catch(n):r(ee.autoIncrementValues[e.table.name])}))},e.prototype.startChecking=function(){var e=this;return P((function(t,n){var r=!1;(e.values.every((function(t){return!(r=e.valueCheckerObj.checkAndModifyValue(t))})),r)&&n(e.valueCheckerObj.log.get());var o,i,u,s=(o=e.table,i=e.valueCheckerObj.autoIncrementValue,u=Object.keys(i),Y(u.map((function(e){var t="JsStore_"+U.activeDb.name+"_"+o.name+"_"+e+"_Value",n=i[e];return!0===Ft.isTransactionQuery&&(ee.autoIncrementValues[o.name][e]=n),B.set(t,n)}))));!1===Ft.isTransactionQuery?s.then(t).catch(n):t()}))},e}(),ee=function(){function e(e,t){this.isTransaction=!1,this.api=e,this.query=t}return e.prototype.checkAndModify=function(){var e=this;return P((function(t,n){var r=function(){null==e.error?t():n(e.error)};switch(e.api){case u.Select:case u.Remove:case u.Count:e.checkFetchQuery_(),r();break;case u.Insert:e.checkInsertQuery_().then(r).catch((function(t){e.error=t,r()}));break;case u.Update:e.checkUpdateQuery_(),r()}}))},e.prototype.isInsertQryValid_=function(e){var t,n=this.getTable_(this.query.into);if(n)switch(z(this.query.values)){case i.Array:break;case i.Null:t=new W(r.NoValueSupplied);break;default:t=new W(r.NotArray)}else t=new W(r.TableNotExist,{tableName:this.query.into});return e(n),null==t?null:t.get()},e.prototype.checkInsertQuery_=function(){var e=this;return P((function(t,n){var r,o=e.isInsertQryValid_((function(e){r=e}));if(null==o)if(!0===e.query.skipDataCheck)t();else{var i=new X(r,e.query.values);i.checkAndModifyValues().then((function(){e.query.values=i.values,t()})).catch(n)}else n(o)}))},e.prototype.checkUpdateQuery_=function(){this.error=new Z(this.getTable_(this.query.in)).check(this.query.set,this.query.in),null==this.error&&null!=this.query.where&&(this.checkForNullInWhere_(),null==this.error&&this.addGreatAndLessToNotOp_())},e.prototype.checkForNullInWhere_=function(){for(var e in this.query.where)if(null==this.query.where[e])return void(this.error=new W(r.NullValueInWhere,{column:e}).get())},e.prototype.checkFetchQuery_=function(){!0===this.isTableExist_(this.query.from)?null!=this.query.where&&(this.checkForNullInWhere_(),null==this.error&&this.addGreatAndLessToNotOp_()):this.error=new W(r.TableNotExist,{tableName:this.query.from}).get()},e.prototype.isTableExist_=function(e){return this.activeDb_.tables.findIndex((function(t){return t.name===e}))>=0},Object.defineProperty(e.prototype,"activeDb_",{get:function(){return U.activeDb},enumerable:!1,configurable:!0}),e.prototype.getTable_=function(e){return U.getTable(e)},e.prototype.addGreatAndLessToNotOp_=function(){var e=this.query.where,t=function(e,t){return t.findIndex((function(t){return null!=e[t][c.NotEqualTo]}))>=0},n=function(e,t){var n;return t.forEach((function(t){null!=(n=e[t])[c.NotEqualTo]&&(e[t][c.GreaterThan]=n[c.NotEqualTo],void 0===e[c.Or]?(e[c.Or]={},e[c.Or][t]={}):void 0===e[c.Or][t]&&(e[c.Or][t]={}),e[c.Or][t][c.LessThan]=n[c.NotEqualTo],delete e[t][c.NotEqualTo])})),e};switch(z(e)){case i.Object:var r=Object.keys(e);if(t(e,r))if(1===r.length)this.query.where=n(e,r);else{var o=[];r.forEach((function(t){var r;o.push(n(((r={})[t]=e[t],r),[t]))})),this.query.where=o}break;default:var u=[];e.forEach((function(e){var r=Object.keys(e);t(e,r)&&(e=n(e,r)),u.push(e)})),this.query.where=u}},e.autoIncrementValues={},e}(),te=function(){function e(){}return Object.defineProperty(e.prototype,"activeDb",{get:function(){return U.activeDb},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dbConnection",{get:function(){return U.dbConnection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transaction",{get:function(){return U.transaction},enumerable:!1,configurable:!0}),e.prototype.createTransaction=function(e,t,n){U.createTransaction(e,t,n)},e.prototype.regexTest=function(e){return this.regexExpression.test(e)},e.prototype.isTableExist=function(e){return this.activeDb.tables.findIndex((function(t){return t.name===e}))>=0},e.prototype.getTable=function(e){return U.getTable(e)},e.prototype.getKeyRange=function(e,t){var n;switch(t){case c.Between:n=IDBKeyRange.bound(e.low,e.high,!1,!1);break;case c.GreaterThan:n=IDBKeyRange.lowerBound(e,!0);break;case c.GreaterThanEqualTo:n=IDBKeyRange.lowerBound(e);break;case c.LessThan:n=IDBKeyRange.upperBound(e,!0);break;case c.LessThanEqualTo:n=IDBKeyRange.upperBound(e);break;default:n=IDBKeyRange.only(e)}return n},e.prototype.getPrimaryKey=function(e){var t=this.getTable(e).primaryKey;return t||this.getKeyPath(e)},e.prototype.getKeyPath=function(e){return this.dbConnection.transaction([e],"readonly").objectStore(e).keyPath},e}(),ne=function(e){return"object"===z(e)&&!(e instanceof RegExp)},re=function(e){if(ne(e)){var t={};for(var n in e)t[n]=null!=e[n]&&ne(e[n])?re(e[n]):e[n];return t}return e},oe=function(e,t){var n=z(e);if(n!==z(t))return!1;switch(n){case i.DateTime:return e.getTime()===t.getTime();default:return e===t}},ie=function(e){var t,n,r=e.split("%");switch(r[1]?(t=r[1],n=r.length>2?l.Any:l.Last):(t=r[0],n=l.First),n){case l.First:return new RegExp("^"+t,"i");case l.Last:return new RegExp(t+"$","i");default:return new RegExp(""+t,"i")}},ue=function(){function e(e,t){this.where=re(e),this.checkFlag=t}return e.prototype.remove=function(e){var t=e.pop();delete e.reduce((function(e,t){return e&&e[t]}),this.where)[t]},e.prototype.check=function(e){var t=!0;if(!this.checkFlag)return t;for(var n in this.where){if(!t)return t;var r=this.where[n],o=e[n];if("object"===z(r))for(var i in r){if(!t)return t;switch(i){case c.In:t=this.checkIn(n,o);break;case c.Like:t=this.checkLike_(n,o);break;case c.Regex:t=this.checkRegex(n,o);break;case c.Between:case c.GreaterThan:case c.LessThan:case c.GreaterThanEqualTo:case c.LessThanEqualTo:case c.NotEqualTo:t=this.checkComparisionOp_(n,o,i);break;default:t=!1}}else t=oe(r,o)}return t},e.prototype.checkIn=function(e,t){return null!=this.where[e][c.In].find((function(e){return oe(e,t)}))},e.prototype.checkLike_=function(e,t){return ie(this.where[e][c.Like]).test(t)},e.prototype.checkRegex=function(e,t){return this.where[e][c.Regex].test(t)},e.prototype.checkComparisionOp_=function(e,t,n){var r=this.where[e][n];switch(n){case c.GreaterThan:return t>r;case c.LessThan:return t<r;case c.LessThanEqualTo:return t<=r;case c.GreaterThanEqualTo:return t>=r;case c.Between:return t>r.low&&t<r.high;case c.NotEqualTo:return t!==r}},e}(),se=function(e){for(var t in e)return t},ce=function(e){return Object.keys(e)},ae=function(e){return ce(e).length},le=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rowAffected=0,t}return le(t,e),t.prototype.onErrorOccured=function(e,t){if(void 0===t&&(t=!1),t)e.logError(),this.error=e.get();else{var n=void 0;e.name?(n=new W(e.name)).message=e.message:(n=new W(e.target.error.name)).message=e.target.error.message,n.logError(),this.error=n.get()}},t.prototype.onExceptionOccured=function(e){console.error(e),this.onError({message:e.message,type:r.InvalidQuery})},t.prototype.getColumnInfo=function(e,t){return this.getTable(t).columns.find((function(t){return t.name===e}))},t.prototype.goToWhereLogic=function(){var e=se(this.query.where);if(this.objectStore.indexNames.contains(e)){var t=this.query.where[e];if("object"===z(t)){var n=ae(t)>1||ae(this.query.where)>1;this.whereCheckerInstance=new ue(this.query.where,n);var o=se(t);switch(this.whereCheckerInstance.remove([e,o]),o){case c.Like:var i=ie(t[c.Like]);this.executeRegexLogic(e,i);break;case c.Regex:this.executeRegexLogic(e,t[c.Regex]);break;case c.In:this.executeInLogic(e,t[c.In]);break;case c.Between:case c.GreaterThan:case c.LessThan:case c.GreaterThanEqualTo:case c.LessThanEqualTo:this.executeWhereLogic(e,t,o,"next");break;case c.Aggregate:break;default:this.executeWhereLogic(e,t,null,"next")}}else{n=ae(this.query.where)>1;this.whereCheckerInstance=new ue(this.query.where,n),this.whereCheckerInstance.remove([e]),this.executeWhereLogic(e,t,null,"next")}}else{var u=this.getColumnInfo(e,this.tableName),s=new W(null==u?r.ColumnNotExist:r.EnableSearchOff,{column:e});this.onErrorOccured(s,!0)}},t}(te),he=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pe=function(e){function t(t,n,r){var o=e.call(this)||this;return o.query=t,o.onSuccess=n,o.onError=r,o}return he(t,e),t.prototype.execute=function(){var e=this;this.createTransaction([this.query],(function(){null==e.error?e.onSuccess():e.onError(e.error)}));var t=this.transaction.objectStore(this.query).clear();t.onsuccess=function(){e.getTable(e.query).columns.forEach((function(t){t.autoIncrement&&B.set("JsStore_"+e.activeDb.name+"_"+e.query+"_"+t.name+"_Value",0)}))},t.onerror=this.onErrorOccured},t}(fe),ye=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(e){function t(t,n){var r=e.call(this)||this;return r.onSuccess=t,r.onError=n,r}return ye(t,e),t.prototype.execute=function(e){var t=this,n=[],r=indexedDB.open(this.dbName,this.dbVersion),o=!1;r.onerror=function(e){null!=t.onError&&t.onError(e.target.error)},r.onsuccess=function(){t.dbStatus.conStatus=f.Connected,t.dbConnection=r.result,t.dbConnection.onclose=t.onDbClose.bind(t),t.dbConnection.onversionchange=t.onDbVersionChange.bind(t),t.dbConnection.onerror=t.onDbConError.bind(t),o?t.savedbNameIntoDbList_().then((function(){null!=t.onSuccess&&t.onSuccess(o)})):(t.setPrimaryKey_(),t.onSuccess(o))},r.onupgradeneeded=function(r){o=!0;var i=r.target.result,u=function(e,r){try{var o;e.primaryKey.length>0?(t.activeDb.tables[r].primaryKey=e.primaryKey,o=i.createObjectStore(e.name,{keyPath:e.primaryKey})):o=i.createObjectStore(e.name,{autoIncrement:!0}),e.columns.forEach((function(n){if(!0===n.enableSearch){var r=n.primaryKey?{unique:!0}:{unique:n.unique};r.multiEntry=n.multiEntry;var i=null==n.keyPath?n.name:n.keyPath;o.createIndex(n.name,i,r),n.autoIncrement&&B.set("JsStore_"+t.dbName+"_"+e.name+"_"+n.name+"_Value",0)}})),n.push(e.name),B.set("JsStore_"+t.dbName+"_"+e.name+"_Version",e.version)}catch(e){console.error(e)}};e.forEach((function(e,t){e.requireDelete?(i.objectStoreNames.contains(e.name)&&i.deleteObjectStore(e.name),u(e,t)):e.requireCreation&&u(e,t)}))}},t.prototype.savedbNameIntoDbList_=function(){var e=this;return P((function(t,n){e.getDbList().then((function(r){r.indexOf(e.dbName)<0?(r.push(e.dbName),e.setDbList(r).then(t).catch(n)):t()})).catch(n)}))},t.prototype.setPrimaryKey_=function(){var e=this;this.activeDb.tables.forEach((function(t,n){t.columns.every((function(t){return e.activeDb.tables[n].primaryKey=t.primaryKey?t.name:"",!t.primaryKey}))}))},t}(K),be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.results=[],t}return be(t,e),t.prototype.onQueryFinished=function(){},t}(fe),ve=function(){function e(){}return e.prototype.setCaseAndValue=function(e,t){this.caseQuery_=e,this.setValue(t)},e.prototype.setCaseAndColumn=function(e,t){return this.caseQuery_=e,this.setColumn(t),this},e.prototype.setColumn=function(e){return this.columnName_=e,this.caseColumnQuery_=this.caseQuery_[this.columnName_],this.length_=this.caseColumnQuery_.length,this},e.prototype.setValue=function(e){return this.value=e,this},e.prototype.evaluate=function(){for(var e=0;e<this.length_;e++)if(!0===this.checkCase_(this.caseColumnQuery_[e]))return this.caseColumnQuery_[e].then;var t=this.caseColumnQuery_[this.length_-1].then;return null==t?this.value[this.columnName_]:t},e.prototype.checkCase_=function(e){for(var t in e){switch(t){case c.GreaterThan:if(this.value[this.columnName_]>e[t])return!0;break;case c.Equal:if(this.value[this.columnName_]===e[t])return!0;break;case c.LessThan:if(this.value[this.columnName_]<e[t])return!0;break;case c.GreaterThanEqualTo:if(this.value[this.columnName_]>=e[t])return!0;break;case c.LessThanEqualTo:if(this.value[this.columnName_]<=e[t])return!0;break;case c.NotEqualTo:if(this.value[this.columnName_]!==e[t])return!0;break;case c.Between:if(this.value[this.columnName_]>e[t].low&&this.value[this.columnName_]<e[t].high)return!0}return!1}},e}(),me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sorted=!1,t.isSubQuery=!1,t.shouldEvaluateLimitAtEnd=!1,t.shouldEvaluateSkipAtEnd=!1,t.thenEvaluator=new ve,t}return me(t,e),t.prototype.setPushResult=function(){var e=this;this.query.case?this.pushResult=function(t){for(var n in e.thenEvaluator.setCaseAndValue(e.query.case,t),e.query.case)t[n]=e.thenEvaluator.setColumn(n).evaluate();e.results.push(t)}:this.pushResult=function(t){e.results.push(t)}},t.prototype.removeDuplicates=function(){var e=this.results;this.results=null;for(var t=this.getPrimaryKey(this.query.from),n={},r=0,o=e.length;r<o;r++)n[e[r][t]]=e[r];for(var r in e=[],n)e.push(n[r]);this.results=e},t}(_e),Se=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Se(t,e),t.prototype.executeWhereUndefinedLogic=function(){if(this.query.order&&!1!==this.query.order.idbSorting&&this.query.order.by){if(!this.objectStore.indexNames.contains(this.query.order.by)){var e=new W(r.ColumnNotExist,{column:this.query.order.by,isOrder:!0});return void this.onErrorOccured(e,!0)}var t=this.query.order.type&&"desc"===this.query.order.type.toLowerCase()?"prev":"next";this.sorted=!0,y=this.objectStore.index(this.query.order.by).openCursor(null,t)}else y=this.objectStore.openCursor();y.onerror=this.onErrorOccured,!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForNoWhere_():this.skipRecord?this.executeSkipForNoWhere_():this.limitRecord?this.executeLimitForNotWhere_():this.executeSimpleForNotWhere_():this.executeSimpleForNotWhere_()},t.prototype.executeSkipAndLimitForNoWhere_=function(){var e,t=this,n=!1;y.onsuccess=function(r){(e=r.target.result)?n&&t.results.length!==t.limitRecord?(t.pushResult(e.value),e.continue()):(n=!0,e.advance(t.skipRecord)):t.onQueryFinished()}},t.prototype.executeSkipForNoWhere_=function(){var e,t=this,n=!1;y.onsuccess=function(r){(e=r.target.result)?n?(t.pushResult(e.value),e.continue()):(n=!0,e.advance(t.skipRecord)):t.onQueryFinished()}},t.prototype.executeSimpleForNotWhere_=function(){var e,t=this;y.onsuccess=function(n){(e=n.target.result)?(t.pushResult(e.value),e.continue()):t.onQueryFinished()}},t.prototype.executeLimitForNotWhere_=function(){var e,t=this;y.onsuccess=function(n){(e=n.target.result)&&t.results.length!==t.limitRecord?(t.pushResult(e.value),e.continue()):t.onQueryFinished()}},t}(ge),we=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.executeInLogic=function(e,t){var n=this;_=this.skipRecord,b=function(e){0===_?n.pushResult(e):--_},d=function(){return n.whereCheckerInstance.check(v.value)},!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForIn_(e,t):this.skipRecord?this.executeSkipForIn_(e,t):this.limitRecord?this.executeLimitForIn_(e,t):this.executeSimpleForIn_(e,t):this.executeSimpleForIn_(e,t)},t.prototype.executeSkipAndLimitForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){v=t.target.result,r.results.length!==r.limitRecord&&v?(d()&&b(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t.prototype.executeSkipForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){(v=t.target.result)?(d()&&b(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t.prototype.executeLimitForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){(v=t.target.result)&&r.results.length!==r.limitRecord?(d()&&r.pushResult(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t.prototype.executeSimpleForIn_=function(e,t){var n,r=this,o=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,i){(n=o.openCursor(r.getKeyRange(t))).onsuccess=function(t){(v=t.target.result)?(d()&&r.pushResult(v.value),v.continue()):e()},n.onerror=i}));var t}))).then((function(){r.onQueryFinished()})).catch((function(e){r.onErrorOccured(e)}))},t}(Oe),ke=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ke(t,e),t.prototype.executeRegexLogic=function(e,t){var n=this;S=this.skipRecord,this.regexExpression=t,g=function(e){0===S?n.pushResult(e):--S},m=function(){return n.regexTest(O.key)&&n.whereCheckerInstance.check(O.value)},(w=this.objectStore.index(e).openCursor()).onerror=this.onErrorOccured,!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForRegex_():this.skipRecord?this.executeSkipForRegex_():this.limitRecord?this.executeLimitForRegex_():this.executeSimpleForRegex_():this.executeSimpleForRegex_()},t.prototype.executeSkipAndLimitForRegex_=function(){var e=this;w.onsuccess=function(t){O=t.target.result,e.results.length!==e.limitRecord&&O?(m()&&g(O.value),O.continue()):e.onQueryFinished()}},t.prototype.executeSkipForRegex_=function(){var e=this;w.onsuccess=function(t){(O=t.target.result)?(m()&&g(O.value),O.continue()):e.onQueryFinished()}},t.prototype.executeLimitForRegex_=function(){var e=this;w.onsuccess=function(t){O=t.target.result,e.results.length!==e.limitRecord&&O?(m()&&e.pushResult(O.value),O.continue()):e.onQueryFinished()}},t.prototype.executeSimpleForRegex_=function(){var e=this;w.onsuccess=function(t){(O=t.target.result)?(m()&&e.pushResult(O.value),O.continue()):e.onQueryFinished()}},t}(xe),De=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return De(t,e),t.prototype.executeWhereLogic=function(e,t,n,r){var o=this;x=function(){return o.whereCheckerInstance.check(k.value)},t=n?t[n]:t,(E=this.objectStore.index(e).openCursor(this.getKeyRange(t,n),r)).onerror=this.onErrorOccured,!1===this.shouldEvaluateLimitAtEnd&&!1===this.shouldEvaluateSkipAtEnd?this.skipRecord&&this.limitRecord?this.executeSkipAndLimitForWhere_():this.skipRecord?this.executeSkipForWhere_():this.limitRecord?this.executeLimitForWhere_():this.executeSimpleForWhere_():this.executeSimpleForWhere_()},t.prototype.executeSkipAndLimitForWhere_=function(){var e=this,t=!1;E.onsuccess=function(n){(k=n.target.result)?t&&e.results.length!==e.limitRecord?(x()&&e.pushResult(k.value),k.continue()):(t=!0,k.advance(e.skipRecord)):e.onQueryFinished()}},t.prototype.executeSkipForWhere_=function(){var e=this,t=!1;E.onsuccess=function(n){(k=n.target.result)?t?(x()&&e.pushResult(k.value),k.continue()):(t=!0,k.advance(e.skipRecord)):e.onQueryFinished()}},t.prototype.executeLimitForWhere_=function(){var e=this;E.onsuccess=function(t){(k=t.target.result)&&e.results.length!==e.limitRecord?(x()&&e.pushResult(k.value),k.continue()):e.onQueryFinished()}},t.prototype.executeSimpleForWhere_=function(){var e=this;E.onsuccess=function(t){(k=t.target.result)?(x()&&e.pushResult(k.value),k.continue()):e.onQueryFinished()}},t}(Ee),qe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qe(t,e),t.prototype.processGroupBy=function(){var e=this.query.groupBy,t=this.results,n={};if(this.results=this.query.groupBy=null,z(e)!==i.Object)if(z(e)===i.String)for(var r in t)n[t[r][e]]=t[r];else{var o=void 0;for(var r in t){for(var u in o="",e)o+=t[r][e[u]];n[o]=t[r]}}else if(1===Object.keys(e).length){var s=se(e);for(var r in this.thenEvaluator.setCaseAndColumn(e,s),t)n[this.thenEvaluator.setValue(t[r]).evaluate()]=t[r]}else{o=void 0;for(var r in t){for(var u in o="",this.thenEvaluator.setCaseAndValue(e,t[r]),e)o+=this.thenEvaluator.setColumn(u).evaluate();n[o]=t[r]}}for(var r in t=[],n)t.push(n[r]);this.results=t},t.prototype.executeAggregateGroupBy=function(){var e=this.query.groupBy,t=this.results;this.results=void 0;var n,r,o,u={},s=this.query.aggregate,a=function(){var e=function(){return r=(r=u[n])?r["count("+o+")"]:0,r+=t[l][o]?1:0},a=function(){return r=(r=u[n])?r["max("+o+")"]:0,t[l][o]=t[l][o]?t[l][o]:0,r>t[l][o]?r:t[l][o]},f=function(){return r=(r=u[n])?r["min("+o+")"]:1/0,t[l][o]=t[l][o]?t[l][o]:1/0,r<t[l][o]?r:t[l][o]},h=function(){return r=(r=u[n])?r["sum("+o+")"]:0,r+=t[l][o]?t[l][o]:0},p=function(){var e=(r=u[n])?r["sum("+o+")"]:0;e+=t[l][o]?t[l][o]:0,t[l]["sum("+o+")"]=e,r=r?r["count("+o+")"]:0,r+=t[l][o]?1:0,t[l]["count("+o+")"]=r};for(var y in s){var d=s[y],b=z(d),_=void 0;switch(y){case c.Count:_=e;break;case c.Max:_=a;break;case c.Min:_=f;break;case c.Sum:_=h;break;case c.Avg:_=p}switch(b){case i.String:o=d,t[l][y+"("+o+")"]=_();break;case i.Array:for(var v in d)o=d[v],t[l][y+"("+o+")"]=_()}}};if(z(e)===i.String)for(var l in t)n=t[l][e],a(),u[n]=t[l];else for(l in t){for(var f in n="",e)n+=t[l][e[f]];a(),u[n]=t[l]}for(var h in t=[],u)t.push(u[h]);if(s.avg)if(z(s.avg)===i.String)for(l in t){var p=t[l]["sum("+s.avg+")"],y=t[l]["count("+s.avg+")"];t[l]["avg("+s.avg+")"]=p/y,s.count!==s.avg&&delete t[l]["count("+s.avg+")"],s.sum!==s.avg&&delete t[l]["sum("+s.avg+")"]}else{var d=z(s.count)===i.String,b=z(s.sum)===i.String;for(l in t)for(var f in s.avg){var _=s.avg[f],v=t[l]["sum("+_+")"],m=t[l]["count("+_+")"];t[l]["avg("+_+")"]=v/m,d&&(s.count!==_||-1===s.count.indexOf(_))&&delete t[l]["count("+_+")"],b&&(s.sum!==_||-1===s.sum.indexOf(_))&&delete t[l]["sum("+_+")"]}}this.results=t},t}(Ce),Te=function(e){return e.replace(/\s/g,"")},je=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return je(t,e),t.prototype.processGroupDistinctAggr=function(){if(this.query.distinct){var e=[],t=this.results[0];for(var n in t)e.push(n);var r=this.getPrimaryKey(this.query.from),o=e.indexOf(r);e.splice(o,1),this.query.groupBy=e.length>0?e:null}this.query.groupBy?this.query.aggregate?this.executeAggregateGroupBy():this.processGroupBy():this.query.aggregate&&this.processAggregateQry()},t.prototype.getOrderColumnInfo_=function(e){var t;if(null==this.query.join)t=this.getColumnInfo(e,this.query.from);else{var n=Te(e).split(".");e=n[1],t=this.getColumnInfo(e,n[0])}if(null==t){var o=this.results[0][e];if(o)return{dataType:z(o),name:e};this.onErrorOccured(new W(r.ColumnNotExist,{column:e,isOrder:!0}),!0)}return t},t.prototype.compareStringInDesc_=function(e,t){return t.localeCompare(e)},t.prototype.compareStringinAsc_=function(e,t){return e.localeCompare(t)},t.prototype.compareDefaultInDesc_=function(e,t){return new String(t).localeCompare(e)},t.prototype.compareDefaultinAsc_=function(e,t){return new String(e).localeCompare(t)},t.prototype.compareNumberInDesc_=function(e,t){return t-e},t.prototype.compareNumberinAsc_=function(e,t){return e-t},t.prototype.compareDateInDesc_=function(e,t){return t.getTime()-e.getTime()},t.prototype.compareDateInAsc_=function(e,t){return e.getTime()-t.getTime()},t.prototype.getValInDesc_=function(e,t,n){for(var r in n){this.thenEvaluator.setCaseAndValue(n,e);var o=this.thenEvaluator.setColumn(r).evaluate();this.thenEvaluator.setCaseAndValue(n,t);var u=this.thenEvaluator.setColumn(r).evaluate();switch(typeof e[o]){case i.String:return this.compareStringInDesc_(e[o],t[u]);default:return this.compareNumberInDesc_(e[o],t[u])}}},t.prototype.getValInAsc_=function(e,t,n){for(var r in n){this.thenEvaluator.setCaseAndValue(n,e);var o=this.thenEvaluator.setColumn(r).evaluate();this.thenEvaluator.setCaseAndValue(n,t);var u=this.thenEvaluator.setColumn(r).evaluate();switch(typeof e[o]){case i.String:return this.compareStringinAsc_(e[o],t[u]);default:return this.compareNumberinAsc_(e[o],t[u])}}},t.prototype.getValueComparer_=function(e,t){switch(e.dataType){case i.String:return"asc"===t.type?this.compareStringinAsc_:this.compareStringInDesc_;case i.Number:return"asc"===t.type?this.compareNumberinAsc_:this.compareNumberInDesc_;case i.DateTime:return"asc"===t.type?this.compareDateInAsc_:this.compareDateInDesc_;default:return"asc"===t.type?this.compareDefaultinAsc_:this.compareDefaultInDesc_}},t.prototype.orderBy_=function(e){var t,n=this;e.type=this.getOrderType_(e.type);var r=e.by;if(null!=r&&typeof r===i.Object)"asc"===e.type?this.results.sort((function(e,t){return n.getValInAsc_(e,t,r)})):this.results.sort((function(e,t){return n.getValInDesc_(e,t,r)}));else{var o=this.getOrderColumnInfo_(r);if(null!=o){var u=this.getValueComparer_(o,e);r=o.name,null==e.case?this.results.sort((function(e,t){return u(e[r],t[r])})):(this.thenEvaluator.setCaseAndColumn(((t={})[r]=e.case,t),r),this.results.sort((function(e,t){return u(n.thenEvaluator.setValue(e).evaluate(),n.thenEvaluator.setValue(t).evaluate())})))}}},t.prototype.getOrderType_=function(e){return null==e?"asc":e.toLowerCase()},t.prototype.processOrderBy=function(){var e=this.query.order;if(e&&this.results.length>0&&!this.sorted){var t=z(e);if(t===i.Object)this.orderBy_(e);else if(t===i.Array){this.orderBy_(e[0]);for(var n=function(t){if(null==r.error){var n=e[t-1].by,o=e[t],i=o.by,u=r.getOrderColumnInfo_(i);if(null!=u){i=u.name,o.type=r.getOrderType_(o.type);var s=r.getValueComparer_(u,o);r.results.sort((function(e,t){return e[n]===t[n]?s(e[i],t[i]):0}))}}},r=this,o=1,u=e.length;o<u;o++)n(o)}}},t.prototype.processAggregateQry=function(){var e,t=this.results,n=t.length,r={};this.results=void 0;var o=function(){var n=0;for(var r in t)n+=t[r][e]?1:0;return n},u=function(){var n=0;for(var r in t)n=n>t[r][e]?n:t[r][e];return n},s=function(){var n=1/0,r=1/0;for(var o in t)n=n<(r=t[o][e]?t[o][e]:1/0)?n:r;return n},c=function(){var n=0;for(var r in t)n+=t[r][e];return n},a=function(){var r=0;for(var o in t)r+=t[o][e];return r/n};for(var l in this.query.aggregate){var f=this.query.aggregate[l],h=z(f),p=void 0;switch(l){case"count":p=o;break;case"max":p=u;break;case"min":p=s;break;case"sum":p=c;break;case"avg":p=a}switch(h){case i.String:r[l+"("+(e=f)+")"]=p();break;case i.Array:for(var y in f)r[l+"("+(e=f[y])+")"]=p()}}for(var l in r)t[0][l]=r[l];this.results=[t[0]]},t}(Ae),Ne=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qe=function(){return(Qe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.joinQueryStack_=[],t.currentQueryStackIndex_=0,t.tablesFetched=[],t}return Ne(t,e),t.prototype.executeJoinQuery=function(){var e=this,t=this.query;z(t.join)===i.Object?this.joinQueryStack_=[t.join]:this.joinQueryStack_=t.join;var n=t.from;new Ve({from:n,where:t.where,case:t.case,flatten:t.flatten},(function(t){e.results=t.map((function(t){var n;return(n={})[e.currentQueryStackIndex_]=t,n})),e.tablesFetched.push(n),e.startExecutingJoinLogic_()}),this.onError).execute()},t.prototype.onJoinQueryFinished_=function(){var e=this;if(null==this.error){if(this.results.length>0){this.query[c.Skip]&&!this.query[c.Limit]&&this.results.splice(0,this.query[c.Skip]);try{var t=[],n=Object.keys(this.results[0]).length,o=function(e,t){if(null!=e.as)for(var n in e.as)void 0===t[e.as[n]]&&(t[e.as[n]]=t[n],delete t[n]);return t};this.results.forEach((function(r){for(var i=r[0],u=1;u<n;u++){var s=e.joinQueryStack_[u-1];i=Qe(Qe({},i),o(s,r[u]))}t.push(i)})),this.results=t,t=null;try{this.processOrderBy()}catch(e){return void this.onError({message:e.message,type:r.InvalidOrderQuery})}try{this.processGroupDistinctAggr()}catch(e){return void this.onError({message:e.message,type:r.InvalidGroupQuery})}}catch(e){return void this.onError({message:e.message,type:r.InvalidJoinQuery})}this.query[c.Skip]&&this.query[c.Limit]?(this.results.splice(0,this.query[c.Skip]),this.results=this.results.slice(0,this.query[c.Limit])):this.query[c.Limit]&&(this.results=this.results.slice(0,this.query[c.Limit]))}this.onSuccess(this.results)}else this.onError(this.error)},t.prototype.startExecutingJoinLogic_=function(){var e=this,t=this.joinQueryStack_[this.currentQueryStackIndex_];if(t)try{var n=this.getJoinTableInfo_(t.on);if(t.with===n.table1.table&&(n={table1:n.table2,table2:n.table1}),this.checkJoinQuery_(n,t),null!=this.error)return this.onJoinQueryFinished_();new Ve({from:t.with,where:t.where,case:t.case,flatten:t.flatten},(function(r){e.jointables(t.type,n,r),e.tablesFetched.push(n.table2.table),++e.currentQueryStackIndex_,e.startExecutingJoinLogic_()}),this.onError).execute()}catch(e){this.onExceptionOccured(e)}else this.onJoinQueryFinished_()},t.prototype.jointables=function(e,t,n){var r,o,i,u,s=this,c=[],a=t.table1.column,l=t.table2.column,f=this.tablesFetched.indexOf(t.table1.table),h=this.currentQueryStackIndex_+1;switch(e){case"left":i=0,u={},s.getTable(t.table2.table).columns.forEach((function(e){u[e.name]=null})),s.results.forEach((function(e){r=[],o=1===h?function(t){e[f][a]===t[l]&&r.push(t)}:function(t){var n=e[f];null!=n&&n[a]===t[l]&&r.push(t)},n.forEach(o),0===r.length&&(r=[u]),r.forEach((function(t){c[i]=Qe({},e),c[i++][h]=t}))}));break;default:!function(){var e=0;s.results.forEach((function(t){n.forEach((function(n){t[f][a]===n[l]&&(c[e]=Qe({},t),c[e++][h]=n)}))}))}()}this.results=c},t.prototype.getJoinTableInfo_=function(e){var t=(e=Te(e)).split("="),n=t[0].split("."),r=t[1].split(".");return{table1:{table:n[0],column:n[1]},table2:{table:r[0],column:r[1]}}},t.prototype.checkJoinQuery_=function(e,t){var n,o=e.table1,i=e.table2,u=this.getTable(o.table),s=this.getTable(i.table);t.with!==i.table&&(n=new W(r.InvalidJoinQuery,"on value should contains value of with")),null==u.columns.find((function(e){return e.name===o.column}))?n=new W(r.InvalidJoinQuery,"column "+o.column+" does not exist in table "+o.table):null==s.columns.find((function(e){return e.name===i.column}))&&(n=new W(r.InvalidJoinQuery,"column "+i.column+" does not exist in table "+i.table)),null==t.as&&(t.as={}),u.columns.every((function(e){var u=s.columns.find((function(t){return t.name===e.name&&t.name!==o.column}));return null==u||null!=t.as[u.name]||(n=new W(r.InvalidJoinQuery,"column "+e.name+" exist in both table "+o.table+" & "+i.table),!1)})),null!=n&&this.onErrorOccured(n,!0)},t}(Ie),Re=function(e){return Array.isArray(e)},Pe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=function(){return(Fe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Be=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,s=i.length;u<s;u++,o++)r[o]=i[u];return r},Ve=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onTransactionCompleted_=function(){if(null==o.error){if(o.query.flatten){var e=[],t={};o.query.flatten.forEach((function(n){o.results.forEach((function(r,o){r[n].forEach((function(t){var o;e.push(Fe(Fe({},r),((o={})[n]=t,o)))})),t[o]=!0}))}));var n=0;ce(t).forEach((function(e){o.results.splice(Number(e)-n,1),++n})),o.results=o.results.concat(e)}o.processGroupDistinctAggr(),o.processOrderBy(),o.error?o.onError(o.error):(o.shouldEvaluateSkipAtEnd&&o.results.splice(0,o.query.skip),o.shouldEvaluateLimitAtEnd&&(o.results=o.results.slice(0,o.query.limit)),o.onSuccess(o.results))}else o.onError(o.error)},o.onError=r,o.onSuccess=n,o.query=t,o.tableName=t.from,o.setPushResult(),Re(o.query.where)?(o.isArrayQry=!0,o.setLimitAndSkipEvaluationAtEnd_()):(o.skipRecord=t.skip,o.limitRecord=t.limit),t.order?((Re(t.order)||t.order.case||"object"==typeof t.order.by)&&(o.query.order.idbSorting=!1),o.setLimitAndSkipEvaluationAtEnd_()):t.groupBy&&o.setLimitAndSkipEvaluationAtEnd_(),o}return Pe(t,e),t.prototype.setLimitAndSkipEvaluationAtEnd_=function(){this.query.limit&&(this.shouldEvaluateLimitAtEnd=!0),this.query.skip&&(this.shouldEvaluateSkipAtEnd=!0)},t.prototype.execute=function(){var e=new ee(u.Select,this.query);if(e.checkAndModify(),null==e.error)try{null==this.query.join?null!=this.query.where?(this.initTransaction_(),Re(this.query.where)?this.processWhereArrayQry():this.processWhere_()):(this.initTransaction_(),this.executeWhereUndefinedLogic()):this.executeJoinQuery()}catch(e){this.onExceptionOccured(e)}else this.onError(e.error)},t.prototype.processWhereArrayQry=function(){var e=this;this.isArrayQry=!0;var t,n=this.query.where,r=this.getPrimaryKey(this.query.from),o=!0,i=[],u=function(){if(t===c.And){!0===o?i=e.results:i.length>0&&(u=[],e.results.forEach((function(e){var t;t=e[r],i.findIndex((function(e){return e[r]===t}))>=0&&u.push(e)})),i=u,u=null)}else i.length>0?(e.results=Be(i,e.results),e.removeDuplicates(),i=e.results):i=e.results;var u;o=!1,n.length>0?(e.results=[],s()):(e.results=i,!0===e.isSubQuery&&e.onTransactionCompleted_())},s=function(){e.query.where=n.shift(),e.query.where[c.Or]&&1===Object.keys(e.query.where).length?(t=c.Or,e.query.where=e.query.where[c.Or],e.onWhereArrayQrySuccess=u):(t=c.And,e.onWhereArrayQrySuccess=u),e.processWhere_()};s()},t.prototype.onQueryFinished=function(){!0===this.isOr?this.orQuerySuccess_():!0===this.isArrayQry?this.onWhereArrayQrySuccess():!0!==this.isTransaction&&!0!==this.isSubQuery||this.onTransactionCompleted_()},t.prototype.initTransaction_=function(){this.createTransaction([this.tableName],this.onTransactionCompleted_,a.ReadOnly),this.objectStore=this.transaction.objectStore(this.tableName)},t.prototype.processWhere_=function(){this.query.where.or&&this.processOrLogic_(),this.goToWhereLogic()},t.prototype.orQueryFinish_=function(){this.isOr=!1,this.results=this.orInfo.results,this.orInfo=null,this.removeDuplicates(),this.onQueryFinished()},t.prototype.orQuerySuccess_=function(){if(this.orInfo.results=Be(this.orInfo.results,this.results),!this.query.limit||this.query.limit>this.orInfo.results.length){this.results=[];var e=se(this.orInfo.orQuery);if(null!=e){var t={};t[e]=this.orInfo.orQuery[e],delete this.orInfo.orQuery[e],this.query.where=t,this.goToWhereLogic()}else this.orQueryFinish_()}else this.orQueryFinish_()},t.prototype.processOrLogic_=function(){this.isOr=!0,this.orInfo={orQuery:this.query.where.or,results:[]},delete this.query.where.or},t}(Le),We=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resultCount=0,t.onTransactionCompleted_=function(){null==t.error?t.onSuccess(t.resultCount):t.onError(t.error)},t}return We(t,e),t.prototype.onQueryFinished=function(){!0===this.isTransaction&&this.onTransactionCompleted_()},t}(_e),Me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Me(t,e),t.prototype.executeWhereUndefinedLogic=function(){var e,t,n=this;this.objectStore.count?(e=this.objectStore.count()).onsuccess=function(){n.resultCount=e.result,n.onQueryFinished()}:(e=this.objectStore.openCursor()).onsuccess=function(e){(t=e.target.result)?(++n.resultCount,t.continue()):n.onQueryFinished()};e.onerror=this.onErrorOccured.bind(this)},t}(Ke),Ue=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.executeInLogic=function(e,t){var n,r,o=this,i=this.objectStore.index(e),u=function(e){return P((function(t,u){(r=i.openCursor(o.getKeyRange(e))).onsuccess=function(e){(n=e.target.result)?(o.whereCheckerInstance.check(n.value)&&++o.resultCount,n.continue()):t()},r.onerror=u}))};this.objectStore.count&&(u=function(e){return P((function(t,n){(r=i.count(o.getKeyRange(e))).onsuccess=function(e){o.resultCount+=e.target.result,t()},r.onerror=n}))}),Y(t.map((function(e){return u(e)}))).then((function(){o.onQueryFinished()})).catch((function(e){o.onErrorOccured(e)}))},t}(Ge),ze=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ze(t,e),t.prototype.executeRegexLogic=function(e,t){var n,r=this;this.regexExpression=t;var o=this.objectStore.index(e).openCursor();o.onsuccess=function(e){(n=e.target.result)?(r.regexTest(n.key)&&r.whereCheckerInstance.check(n.value)&&++r.resultCount,n.continue()):r.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(Je),$e=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),t.prototype.executeWhereLogic=function(e,t,n){var r,o,i=this;t=n?t[n]:t,(1===Object.keys(this.query.where).length&&this.objectStore.count?function(){(r=i.objectStore.index(e).count(i.getKeyRange(t,n))).onsuccess=function(){i.resultCount=r.result,i.onQueryFinished()}}:function(){(r=i.objectStore.index(e).openCursor(i.getKeyRange(t,n))).onsuccess=function(e){(o=e.target.result)?(i.whereCheckerInstance.check(o.value)&&++i.resultCount,o.continue()):i.onQueryFinished()}})(),r.onerror=this.onErrorOccured.bind(this)},t}(Ze),He=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xe=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onError=r,o.onSuccess=n,o.query=t,o.tableName=t.from,o}return He(t,e),t.prototype.execute=function(){var e=this,t=new ee(u.Count,this.query);if(t.checkAndModify(),null==t.error)try{var n=function(){new Ve(e.query,(function(t){e.resultCount=t.length,e.onTransactionCompleted_()}),e.onError).execute()};null==this.query.join?null!=this.query.where?this.query.where.or||Re(this.query.where)?n():(this.initTransaction_(),this.goToWhereLogic()):(this.initTransaction_(),this.executeWhereUndefinedLogic()):n()}catch(e){this.onExceptionOccured(e)}else this.onError(t.error)},t.prototype.initTransaction_=function(){this.createTransaction([this.query.from],this.onTransactionCompleted_,a.ReadOnly),this.objectStore=this.transaction.objectStore(this.query.from)},t}(Ye),et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tt=function(e){function t(t,n,r){var o=e.call(this)||this;return o.valuesAffected_=[],o.onTransactionCompleted_=function(){null==o.error?o.onSuccess(!0===o.query.return?o.valuesAffected_:o.rowAffected):o.onError(o.error)},o.onError=r,o.query=t,o.onSuccess=n,o.tableName=o.query.into,o}return et(t,e),t.prototype.execute=function(){var e=this,t=new ee(u.Insert,this.query);t.checkAndModify().then((function(){e.query=t.query,e.insertData_(e.query.values)})).catch(this.onError)},t.prototype.onQueryFinished_=function(){!0===this.isTransaction&&this.onTransactionCompleted_()},t.prototype.insertData_=function(e){var t,n,r,o=this;n=this.query.return?function(e){o.valuesAffected_.push(e)}:function(){++o.rowAffected},this.createTransaction([this.tableName],this.onTransactionCompleted_),t=this.transaction.objectStore(this.tableName),r=this.query.upsert?function(e){return t.put(e)}:function(e){return t.add(e)},Y(e.map((function(e){return P((function(t,o){var i=r(e);i.onerror=o,i.onsuccess=function(){n(e),t()}}))}))).then((function(){o.onQueryFinished_()})).catch((function(e){o.transaction.abort(),o.onErrorOccured(e)}))},t}(fe),nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nt(t,e),t.prototype.onQueryFinished=function(){},t}(_e),ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ot(t,e),t.prototype.executeWhereUndefinedLogic=function(){var e,t=this,n=this.objectStore.openCursor();n.onsuccess=function(n){(e=n.target.result)?(e.delete(),++t.rowAffected,e.continue()):t.onQueryFinished()},n.onerror=this.onErrorOccured.bind(this)},t}(rt),ut=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ut(t,e),t.prototype.executeInLogic=function(e,t){var n,r,o=this;Y(t.map((function(t){return i=t,P((function(t,u){(r=o.objectStore.index(e).openCursor(o.getKeyRange(i))).onsuccess=function(e){(n=e.target.result)?(o.whereCheckerInstance.check(n.value)&&(n.delete(),++o.rowAffected),n.continue()):t()},r.onerror=u}));var i}))).then((function(){o.onQueryFinished()})).catch((function(e){o.onErrorOccured(e)}))},t}(it),ct=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ct(t,e),t.prototype.executeRegexLogic=function(e,t){var n,r=this;this.regexExpression=t;var o=this.objectStore.index(e).openCursor();o.onsuccess=function(e){(n=e.target.result)?(r.regexTest(n.key)&&r.whereCheckerInstance.check(n.value)&&(n.delete(),++r.rowAffected),n.continue()):r.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(st),lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lt(t,e),t.prototype.executeWhereLogic=function(e,t,n){var r,o,i=this;t=n?t[n]:t,(o=this.objectStore.index(e).openCursor(this.getKeyRange(t,n))).onsuccess=function(e){(r=e.target.result)?(i.whereCheckerInstance.check(r.value)&&(r.delete(),++i.rowAffected),r.continue()):i.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(at),ht=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pt=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onTransactionCompleted_=function(){null==o.error?o.onSuccess(o.rowAffected):o.onError(o.error)},o.query=t,o.onSuccess=n,o.onError=r,o.tableName=o.query.from,o}return ht(t,e),t.prototype.execute=function(){var e=new ee(u.Remove,this.query);if(e.checkAndModify(),null==e.error)try{this.initTransaction_(),null!=this.query.where?Re(this.query.where)?this.processWhereArrayQry():this.processWhere_():this.executeWhereUndefinedLogic()}catch(e){this.onExceptionOccured(e)}else this.onError(e.error)},t.prototype.processWhereArrayQry=function(){var e=this,t=new Ve(this.query,(function(t){var n,r,o=[],i=e.getPrimaryKey(e.query.from);t.forEach((function(e){o.push(e[i])})),t=null;var u=((n={})[i]=((r={})[c.In]=o,r),n);e.query[c.Where]=u,e.processWhere_()}),this.onError);t.isSubQuery=!0,t.execute()},t.prototype.processWhere_=function(){this.query.where.or&&this.processOrLogic(),this.goToWhereLogic()},t.prototype.initTransaction_=function(){this.createTransaction([this.query.from],this.onTransactionCompleted_),this.objectStore=this.transaction.objectStore(this.query.from)},t.prototype.onQueryFinished=function(){!0===this.isOr?this.orQuerySuccess_():!0===this.isTransaction&&this.onTransactionCompleted_()},t.prototype.orQuerySuccess_=function(){var e=se(this._orInfo.OrQuery);if(null!=e){var t={};t[e]=this._orInfo.OrQuery[e],delete this._orInfo.OrQuery[e],this.query.where=t,this.goToWhereLogic()}else this.isOr=!0},t.prototype.processOrLogic=function(){this.isOr=!0,this._orInfo={OrQuery:this.query.where.or},delete this.query.where.or},t}(ft),yt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dt=function(e,t){for(var n in e)if(z(e[n])!==i.Object)t[n]=e[n];else for(var r in e[n]){switch(r){case"+":t[n]+=e[n][r];break;case"-":t[n]-=e[n][r];break;case"*":t[n]*=e[n][r];break;case"/":t[n]/=e[n][r];break;case"{push}":t[n].push(e[n][r]);break;default:t[n]=e[n]}break}return t},bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTransactionCompleted_=function(){t.error?t.onError(t.error):t.onSuccess(t.rowAffected)},t}return yt(t,e),t.prototype.initTransaction=function(){this.createTransaction([this.query.in],this.onTransactionCompleted_),this.objectStore=this.transaction.objectStore(this.query.in)},t.prototype.onQueryFinished=function(){!0===this.isTransaction&&this.onTransactionCompleted_()},t}(fe),_t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _t(t,e),t.prototype.executeWhereUndefinedLogic=function(){var e,t=this,n=this.objectStore.openCursor();n.onsuccess=function(n){if(e=n.target.result)try{var r=e.update(dt(t.query.set,e.value));r.onsuccess=function(){++t.rowAffected,e.continue()},r.onerror=t.onErrorOccured.bind(t)}catch(e){t.onErrorOccured(e),t.transaction.abort()}else t.onQueryFinished()},n.onerror=this.onErrorOccured.bind(this)},t}(bt),mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mt(t,e),t.prototype.executeInLogic=function(e,t){var n,r,o=this,i=this.objectStore.index(e);Y(t.map((function(e){return t=e,P((function(e,u){(r=i.openCursor(o.getKeyRange(t))).onsuccess=function(t){(n=t.target.result)?(o.whereCheckerInstance.check(n.value)&&(n.update(dt(o.query.set,n.value)),++o.rowAffected),n.continue()):e()},r.onerror=u}));var t}))).then((function(){o.onQueryFinished()})).catch((function(e){o.onErrorOccured(e)}))},t}(vt),St=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return St(t,e),t.prototype.executeRegexLogic=function(e,t){var n,r=this;this.regexExpression=t;var o=this.objectStore.index(e).openCursor();o.onsuccess=function(e){if(n=e.target.result)if(r.regexTest(n.key)&&r.whereCheckerInstance.check(n.value))try{var t=n.update(dt(r.query.set,n.value));t.onsuccess=function(){++r.rowAffected,n.continue()},t.onerror=r.onErrorOccured.bind(r)}catch(e){r.transaction.abort(),r.onErrorOccured(e)}else n.continue();else r.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(gt),wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wt(t,e),t.prototype.executeWhereLogic=function(e,t,n){var r,o,i=this;t=n?t[n]:t,(o=this.objectStore.index(e).openCursor(this.getKeyRange(t,n))).onsuccess=function(e){if(r=e.target.result)if(i.whereCheckerInstance.check(r.value))try{var t=r.update(dt(i.query.set,r.value));t.onsuccess=function(){++i.rowAffected,r.continue()},t.onerror=i.onErrorOccured.bind(i)}catch(e){i.transaction.abort(),i.onErrorOccured(e)}else r.continue();else i.onQueryFinished()},o.onerror=this.onErrorOccured.bind(this)},t}(Ot),kt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(e){function t(t,n,r){var o=e.call(this)||this;return o.onSuccess=n,o.onError=r,o.query=t,o.tableName=o.query.in,o}return kt(t,e),t.prototype.execute=function(){var e=new ee(u.Update,this.query);if(e.checkAndModify(),null==e.error)try{this.initTransaction(),null!=this.query.where?this.query.where.or||Re(this.query.where)?this.executeComplexLogic_():this.goToWhereLogic():this.executeWhereUndefinedLogic()}catch(e){this.onExceptionOccured(e)}else this.onError(e.error)},t.prototype.executeComplexLogic_=function(){var e=this,t=new Ve({from:this.query.in,where:this.query.where,ignoreCase:this.query.ignoreCase},(function(t){var n,r,o=e.getPrimaryKey(e.query.in),i=[];t.forEach((function(e){i.push(e[o])})),t=null;var u=((n={})[o]=((r={})[c.In]=i,r),n);e.query.ignoreCase=null,e.query[c.Where]=u,e.initTransaction(),e.goToWhereLogic()}),this.onError);t.isSubQuery=!0,t.execute()},t}(xt),Dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ct=function(e){function t(t,n,r){var o=e.call(this)||this;return o.reqQueue=[],o.isQueryExecuting=!1,o.isTxStarted_=!1,o.query=t,o.onError=r,o.onSuccess=n,o.results={},o}return Dt(t,e),t.prototype.execute=function(){var e=this,t=this.getNotExistingTable_(this.query.tables);null==t?Y(this.query.tables.map((function(t){return H(e.getTable(t))}))).then((function(t){t.forEach((function(t,n){ee.autoIncrementValues[e.query.tables[n]]=t})),e.startExecution_()})).catch(this.onError):this.onError(new W(r.TableNotExist,{tableName:t}).get())},t.prototype.startExecution_=function(){var e=this,t=this.query.method,n=self[t];if(!n)return this.onError({type:r.MethodNotExist,message:"method "+t+" does not exist."});n.call(this,{data:this.query.data,insert:function(t){return e.pushReq_({name:u.Insert,query:t})},select:function(t){return e.pushReq_({name:u.Select,query:t})},update:function(t){return e.pushReq_({name:u.Update,query:t})},remove:function(t){return e.pushReq_({name:u.Remove,query:t})},count:function(t){return e.pushReq_({name:u.Count,query:t})},setResult:function(t,n){e.results[t]=n},getResult:function(t){return e.results[t]},abort:function(t){e.abortTx_(t)},start:function(){e.checkQueries_(e.reqQueue).then((function(){e.startTx_()})).catch((function(t){e.onError(t)}))}}),console.log("transaction query started")},t.prototype.startTx_=function(){try{this.isTxStarted_=!0,this.initTx_(this.query.tables),this.processExecutionOfQry_()}catch(e){this.onExceptionOccured(e)}},t.prototype.initTx_=function(e){this.createTransaction(e,this.onTxCompleted_.bind(this))},t.prototype.onTxCompleted_=function(){console.log("transaction finished"),this.onSuccess(this.results)},t.prototype.onReqFinished_=function(e){var t=this.reqQueue.shift();console.log("finished request : "+t.name+" "),t&&(this.error?(this.abortTx_("automatic abort of transaction due to error occured"),console.log("transaction aborted due to error occured"),this.onErrorOccured(this.error)):(this.isQueryExecuting=!1,t.onSuccess&&t.onSuccess(e),this.processExecutionOfQry_()))},t.prototype.abortTx_=function(e){null!=this.transaction&&(this.transaction.abort(),console.log("transaction aborted. Msg : "+e))},t.prototype.executeRequest_=function(e){var t;this.isQueryExecuting=!0,console.log("executing request : "+e.name+" ");var n=this.onReqFinished_.bind(this),r=this.onError.bind(this),o=e.query;switch(e.name){case u.Select:t=new Ve(o,n,r);break;case u.Insert:t=new tt(o,n,r);break;case u.Update:t=new Et(o,n,r);break;case u.Remove:t=new pt(o,n,r);break;case u.Count:t=new Xe(o,n,r)}t.isTransaction=!0,t.execute()},t.prototype.pushReq_=function(e){var t=this,n=function(){t.reqQueue.push(e)},r=P((function(n,r){e.onSuccess=function(e){n(e)},e.onError=function(e){t.error=e,r(e)}}));return!0===this.isTxStarted_?this.checkQueries_([e]).then((function(){n(),t.processExecutionOfQry_()})).catch((function(e){t.error=e,t.abortTx_(JSON.stringify(e))})):n(),console.log("request pushed : "+e.name+" with query value - "+JSON.stringify(e.query)),r},t.prototype.processExecutionOfQry_=function(){this.reqQueue.length>0&&!1===this.isQueryExecuting&&this.executeRequest_(this.reqQueue[0])},t.prototype.checkQueries_=function(e){return Y(e.map((function(e){return new ee(e.name,e.query).checkAndModify()})))},t.prototype.getNotExistingTable_=function(e){var t=this,n=null;return e.every((function(e){return!1!==t.isTableExist(e)||(n=e,!1)})),n},t}(fe),qt=function(){function e(e){this.columns=[],this.requireDelete=!1,this.requireCreation=!1,this.name=e.name,this.version=e.version,this.columns=e.columns,this.setPrimaryKey_()}return e.prototype.createMetaData=function(e){var t=this;return P((function(n){t.callback_=n,t.setRequireDelete_(e),t.setDbVersion_(e)}))},e.prototype.setPrimaryKey_=function(){var e=this;this.columns.every((function(t){return e.primaryKey=t.primaryKey?t.name:"",!t.primaryKey}))},e.prototype.setRequireDelete_=function(e){var t=this;B.get("JsStore_"+e+"_"+this.name+"_Version").then((function(e){null==e?t.requireCreation=!0:e<t.version&&(t.requireDelete=!0)}))},e.prototype.setDbVersion_=function(e){var t=this;U.activeDbVersion=U.activeDbVersion>this.version?U.activeDbVersion:this.version,B.set("JsStore_"+e+"_Db_Version",U.activeDbVersion),B.set("JsStore_"+e+"_"+this.name+"_Version",U.activeDbVersion).then((function(){t.version=U.activeDbVersion,t.callback_(t)}))},e}(),At=function(){function e(e){this.tables=[],this.dbName=e.name,this.tables=e.tables}return e.prototype.createMetaData=function(){var e=this;return Y(this.tables.map((function(t){return new qt(t).createMetaData(e.dbName)})))},e}(),Tt=function(e){this.name=e.name,this.autoIncrement=null!=e.autoIncrement&&e.autoIncrement,this.primaryKey=null!=e.primaryKey&&e.primaryKey,this.unique=null!=e.unique&&e.unique,this.notNull=null!=e.notNull&&e.notNull,this.dataType=null!=e.dataType?e.dataType:e.autoIncrement?"number":null,this.default=e.default,this.multiEntry=null!=e.multiEntry&&e.multiEntry,this.enableSearch=null==e.enableSearch||e.enableSearch,this.keyPath=e.keyPath},jt=function(e){for(var t in this.columns=[],this.name=e.name,this.version=null==e.version?1:e.version,e.columns){var n={name:t};for(var r in e.columns[t]){var o=e.columns[t][r];switch(r){case"primaryKey":case"autoIncrement":case"unique":case"dataType":case"enableSearch":case"keyPath":case"multiEntry":case"default":case"notNull":n[r]=o}}this.columns.push(new Tt(n))}},It=function(e){var t=this;this.tables=[],this.name=e.name,e.tables.forEach((function(e){t.tables.push(new jt(e))}))},Nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),t.prototype.execute=function(e,t,n){var r,o=0,i={},u=!0,s=e.length;if(e.every((function(t,n){return!(n+1<s&&t.from!==e[n+1].from)||(u=!1,!1)})),u){var c=this.getPrimaryKey(e[0].from);r=function(e){return e[c]}}else r=function(e){var t="";for(var n in e)t+=e[n];return t};var a=function(){if(o<e.length)new Ve(e[o++],(function(e){e.forEach((function(e){i[r(e)]=e})),a()}),n).execute();else{var u=[];for(var s in i)u.push(i[s]);t(u)}};a()},t}(fe),Lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(){return(Rt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Lt(t,e),t.prototype.execute=function(e,t,n){var r=this;this.query=e;var o,i=0,u={},s={},c=!0,a=e.queries,l=a.length;if(a.every((function(e,t){return!(t+1<l&&e.from!==a[t+1].from)||(c=!1,!1)})),c){var f=this.getPrimaryKey(a[0].from);o=function(e){return e[f]}}else o=function(e){var t="";for(var n in e)t+=e[n];return t};var h=function(){if(i<l)new Ve(a[i],(function(e){u={},e.forEach((function(e){var t=o(e);0===i?s[t]=e:null!=s[t]&&(u[t]=e)})),i>0&&(s=Rt({},u)),++i,h()}),n).execute();else{var c=[],f=void 0,p=e.skip,y=e.limit,d=!1,b=function(){c.push(u[m])},_=function(){c.length<y?b():d=!0},v=function(e){0===p?e():--p};if(f=e.skip&&e.limit?function(){v((function(){_()}))}:e.limit?_:e.skip?function(){v((function(){b()}))}:function(){b()},y){for(var m in u)if(f(m),d)break}else for(m in u)f(m);r.results=c,r.query.join={},r.processOrderBy(),r.processGroupDistinctAggr(),t(r.results)}};h()},t}(Ie),Ft=function(){function e(e){this.onQueryFinished=e,ee.autoIncrementValues={}}return e.prototype.checkConnectionAndExecuteLogic=function(e){var t=this;switch(W.log("request executing:"+e.name),e.name){case u.InitDb:case u.IsDbExist:case u.GetDbVersion:case u.GetDbList:case u.GetDbSchema:case u.Get:case u.Set:case u.ChangeLogStatus:case u.Terminate:case u.OpenDb:case u.InitKeyStore:case u.CloseDb:var n=this.checkForIdbSupport_();null==n?this.executeLogic_(e):this.returnResult_({errorDetails:n,errorOccured:!0});break;default:switch(this.dbStatus_.conStatus){case f.Connected:this.executeLogic_(e);break;case f.Closed:!0===this.isDbDeletedByBrowser_?this.initDb_(null,(function(){t.isDbDeletedByBrowser_=!1,t.checkConnectionAndExecuteLogic(e)}),e.onError):this.initDb_(this.activeDb_,(function(){t.checkConnectionAndExecuteLogic(e)}),e.onError)}}},e.prototype.changeLogStatus_=function(e,t){V.isLogEnabled=e,t()},e.prototype.returnResult_=function(e){!0===V.isRuningInWorker?self.postMessage(e):this.onQueryFinished(e)},e.prototype.executeLogic_=function(t){var n=this,o=function(e){n.returnResult_({returnedValue:e})},i=function(e){n.returnResult_({errorDetails:e,errorOccured:!0})};switch(e.isTransactionQuery=t.name===u.Transaction,t.name){case u.InitDb:!0===this.isDbDeletedByBrowser_?this.initDb_(null,(function(){n.isDbDeletedByBrowser_=!1,o()}),i):this.initDb_(t.query,o,i);break;case u.OpenDb:this.openDb_(t.query,o,i);break;case u.Select:new Ve(t.query,o,i).execute();break;case u.Insert:new tt(t.query,o,i).execute();break;case u.Update:new Et(t.query,o,i).execute();break;case u.Remove:new pt(t.query,o,i).execute();break;case u.IsDbExist:this.isDbExist_(t.query,o,i);break;case u.GetDbVersion:this.getDbVersion_(t.query).then(o).catch(i);break;case u.GetDbList:this.getDbList_().then(o).catch(i);break;case u.GetDbSchema:this.getDbSchema_(t.query).then(o).catch(i);break;case u.Clear:new pe(t.query,o,i).execute();break;case u.DropDb:this.dropDb_(o,i);break;case u.Count:new Xe(t.query,o,i).execute();break;case u.Get:this.get_(t.query).then(o).catch(i);break;case u.Set:this.set_(t.query).then(o).catch(i);break;case u.ChangeLogStatus:this.changeLogStatus_(t.query,o,i);break;case u.Transaction:new Ct(t.query,o,i).execute();break;case u.CloseDb:case u.Terminate:this.terminate_(o,i);break;case u.Union:(new Qt).execute(t.query,o,i);break;case u.InitKeyStore:this.initKeyStore_(o);break;case u.Intersect:(new Pt).execute(t.query,o,i);break;case u.ImportScripts:try{importScripts.apply(void 0,t.query),o()}catch(e){i({type:r.ImportScriptsFailed,message:e.message})}break;default:console.error("The Api:-"+t.name+" does not support.")}},e.prototype.openDb_=function(e,t,n){var o=this;null!=this.activeDb_&&this.activeDb_.name===e?this.processCreateDb(this.activeDb_).then(t).catch(n):this.getDbSchema_(e).then((function(i){null!=i?o.processCreateDb(i).then(t).catch(n):n(new W(r.DbNotExist,{dbName:e}).get())})).catch(n)},e.prototype.initKeyStore_=function(e){B.init().then(e()).catch((function(){U.dbStatus={conStatus:f.UnableToStart,lastError:r.IndexedDbNotSupported}}))},e.prototype.getDbSchema_=function(e){return U.getDbSchema(e)},e.prototype.terminate_=function(e){var t=this;B.close().then((function(){t.closeDb_(),e()}))},Object.defineProperty(e.prototype,"isDbDeletedByBrowser_",{get:function(){return U.isDbDeletedByBrowser},set:function(e){U.isDbDeletedByBrowser=e},enumerable:!1,configurable:!0}),e.prototype.getDbList_=function(){return U.getDbList()},Object.defineProperty(e.prototype,"activeDb_",{get:function(){return U.activeDb},set:function(e){U.activeDb=e},enumerable:!1,configurable:!0}),e.prototype.closeDb_=function(){U.dbStatus.conStatus===f.Connected&&(U.dbStatus.conStatus=f.ClosedByJsStore,U.dbConnection.close())},e.prototype.dropDb_=function(e,t){this.closeDb_(),new G(e,t).deleteDb()},e.prototype.processCreateDb=function(e){var t=this;return P((function(n,r){new At(e).createMetaData().then((function(o){t.activeDb_=e,new de((function(r){t.activeDb_=e,r&&B.set("JsStore_"+e.name+"_Schema",e),n(r)}),r).execute(o)}))}))},e.prototype.initDb_=function(e,t,n){var r=this;null==e?this.processCreateDb(this.activeDb_):(this.closeDb_(),this.getDbVersion_(e.name).then((function(o){r.activeDbVersion_=o||1,r.processCreateDb(new It(e)).then(t).catch(n)})).catch(n))},Object.defineProperty(e.prototype,"activeDbVersion_",{get:function(){return U.activeDbVersion},set:function(e){U.activeDbVersion=e},enumerable:!1,configurable:!0}),e.prototype.getDbVersion_=function(e){return U.getDbVersion(e)},Object.defineProperty(e.prototype,"dbStatus_",{get:function(){return U.dbStatus},enumerable:!1,configurable:!0}),e.prototype.checkForIdbSupport_=function(){if(this.dbStatus_.conStatus===f.UnableToStart){var e={type:this.dbStatus_.lastError};switch(e.type){case r.IndexedDbNotSupported:e.message="Browser does not support IndexedDB";break;default:e.message="unknown error occured"}return e}},e.prototype.isDbExist_=function(e,t){z(e)===i.String?this.getDbVersion_(e).then((function(e){t(Boolean(e))})):this.getDbVersion_(e.dbName).then((function(n){t(e.table.version<=n)}))},e.prototype.get_=function(e){return B.get(e)},e.prototype.set_=function(e){return B.set(e.key,e.value)},e.isTransactionQuery=!1,e}(),Bt=function(){void 0===self.alert&&"undefined"==typeof ServiceWorkerGlobalScope&&(V.isRuningInWorker=!0,self.onmessage=function(e){(new Ft).checkConnectionAndExecuteLogic(e.data)})},Vt=function(){U.dbStatus={conStatus:f.UnableToStart,lastError:r.IndexedDbNotSupported}};!function(){try{indexedDB||(indexedDB=self.mozIndexedDB||self.webkitIndexedDB||self.msIndexedDB),indexedDB?(IDBTransaction=IDBTransaction||self.webkitIDBTransaction||self.msIDBTransaction,self.IDBKeyRange=self.IDBKeyRange||self.webkitIDBKeyRange||self.msIDBKeyRange):Vt()}catch(e){Vt()}}(),Bt()}})},zUnb:function(e,t,n){"use strict";n.r(t),n.d(t,"connect",(function(){return _})),n.d(t,"createDbSchema",(function(){return v})),n.d(t,"createDb",(function(){return m})),n.d(t,"createTable",(function(){return g})),n.d(t,"runSql",(function(){return E})),n.d(t,"getParameterizedSqlExpression",(function(){return D})),n.d(t,"runParameterizedSql",(function(){return C})),n.d(t,"insert",(function(){return S})),n.d(t,"update",(function(){return O})),n.d(t,"remove",(function(){return w})),n.d(t,"select",(function(){return x})),n.d(t,"paging",(function(){return k}));var r,o,i,u,s,c=n("S6P5"),a=(n("vRPr"),n("jfMS")),l=n.n(a),f=n("tPlz"),h=n.n(f),p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},b=l.a;function _(){try{return r||((r=new c.Connection(new Worker(b))).setLogStatus(!1),r.addPlugin(h.a),o=r.insert.bind(r),i=r.update.bind(r),u=r.remove.bind(r),s=r.select.bind(r),r.createDb=m,r.createDbSchema=v,r.createTable=g,r.insert=S,r.update=O,r.remove=w,r.select=x,r.paging=k),Promise.resolve(r)}catch(e){return Promise.reject(e)}}function v(e,t){return{name:e,tables:t.map((function(e){return e.columns._id={primaryKey:!0,autoIncrement:!0},e}))}}function m(e){return y(this,void 0,void 0,(function(){var t;return d(this,(function(n){switch(n.label){case 0:return t=e,[4,r.initDb(t)];case 1:return!0===n.sent()?console.log("db created"):console.log("db opened"),[2,r]}}))}))}function g(e,t){return y(this,void 0,void 0,(function(){var n,o;return d(this,(function(i){switch(i.label){case 0:return[4,r.getDbVersion(e)];case 1:return n=i.sent(),[4,r.getDbSchema(e)];case 2:return o=i.sent(),t.columns._id={primaryKey:!0,autoIncrement:!0},o.tables.push(p(p({},t),{version:n+1})),[4,m(o)];case 3:return[2,i.sent()]}}))}))}function S(e,t){return y(this,void 0,void 0,(function(){var n;return d(this,(function(r){switch(r.label){case 0:return[4,o({into:e,values:t})];case 1:return(n=r.sent())>0?[2,Promise.resolve(n)]:[2,Promise.reject()]}}))}))}function O(e,t){return y(this,void 0,void 0,(function(){var n;return d(this,(function(r){switch(r.label){case 0:return[4,i(p({in:e},t))];case 1:return(n=r.sent())?[2,Promise.resolve(n)]:[2,Promise.reject()]}}))}))}function w(e,t){return y(this,void 0,void 0,(function(){var n;return d(this,(function(r){switch(r.label){case 0:return[4,u(p({from:e},t))];case 1:return(n=r.sent())?[2,Promise.resolve(n)]:[2,Promise.reject()]}}))}))}function x(e,t){return y(this,void 0,void 0,(function(){var n;return d(this,(function(r){switch(r.label){case 0:return[4,s(p({from:e},t))];case 1:return(n=r.sent()).length?[2,Promise.resolve(n)]:[2,Promise.reject()]}}))}))}function k(e,t,n,r){return void 0===t&&(t={}),void 0===n&&(n=1),void 0===r&&(r=10),y(this,void 0,void 0,(function(){var o;return d(this,(function(i){switch(i.label){case 0:return[4,x(e,p({limit:r,skip:(n-1)*r},t))];case 1:return(o=i.sent()).length?[2,Promise.resolve(o)]:[2,Promise.reject()]}}))}))}function E(e){return r.$sql.run(e)}function D(e,t){var n=new r.$sql.Query(e);return Object.entries(t).forEach((function(e){n.map("@"+e[0],e[1])})),n}function C(e,t){return E(D(e,t))}}});